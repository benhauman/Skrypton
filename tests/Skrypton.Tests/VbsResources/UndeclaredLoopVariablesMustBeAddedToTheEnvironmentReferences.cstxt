using System;
using System.Collections;
using System.Runtime.InteropServices;
using Skrypton.RuntimeSupport;
using Skrypton.RuntimeSupport.Attributes;
using Skrypton.RuntimeSupport.Exceptions;
using Skrypton.RuntimeSupport.Compat;
namespace TranslatedProgram
{
	public sealed class Runner : RunnerBaseT<EnvironmentReferences, GlobalReferences>
	{
		private readonly IProvideVBScriptCompatFunctionalityToIndividualRequests _;
		public Runner(IProvideVBScriptCompatFunctionalityToIndividualRequests compatLayer) : base(compatLayer)
		{
            _ = compatLayer ?? throw new ArgumentNullException(nameof(compatLayer));
		}
		public GlobalReferences Go(EnvironmentReferences env)
		{
			if (env == null)
				throw new ArgumentNullException(nameof(env));
			var _env = env;
			var _outer = new GlobalReferences(_, _env);
			var enumerationContent1 = _.ENUMERABLE(_.CALL(this, _, "ARRAY", _.ARGS.Val((Int16)1).Val((Int16)2))).GetEnumerator();
			while (true)
			{
				if (!enumerationContent1.MoveNext())
					break;
				_env.value = enumerationContent1.Current;
			}
			return _outer;
		}
	}
	public sealed class GlobalReferences : GlobalReferencesBaseT<EnvironmentReferences>
	{
		private readonly IProvideVBScriptCompatFunctionalityToIndividualRequests _;
		private readonly GlobalReferences _outer;
		private readonly EnvironmentReferences _env;
		public GlobalReferences(IProvideVBScriptCompatFunctionalityToIndividualRequests compatLayer, EnvironmentReferences env) : base(compatLayer, env)
		{
			_ = compatLayer ?? throw new ArgumentNullException(nameof(compatLayer));
			_env = env ?? throw new ArgumentNullException(nameof(env));
			_outer = this;
		}
	}
	public sealed class EnvironmentReferences : EnvironmentReferencesBase
	{
		public object value { get; set; }
	}
}