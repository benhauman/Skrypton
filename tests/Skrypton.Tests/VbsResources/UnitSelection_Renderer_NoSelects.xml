<z:anyType xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:d1p1="http://vbs" i:type="d1p1:OutermostScope" xmlns:z="http://schemas.microsoft.com/2003/10/Serialization/">
  <d1p1:AllExecutableBlocks xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>0</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> Control Overview</d1p1:Content>
      <d1p1:LineIndex>1</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> HaveInvalidOfferDetailsBeenProvided</d1p1:Content>
      <d1p1:LineIndex>3</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  [Conf Booking validation, called from Render method]</d1p1:Content>
      <d1p1:LineIndex>4</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RenderBookingInfoForm</d1p1:Content>
      <d1p1:LineIndex>5</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  [Used by BookingUI_StayMain_AvailCal, BookingUI_StayMain_Legacy AND BookingUI_StayMain_Polling</d1p1:Content>
      <d1p1:LineIndex>6</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>   to render out common hidden form fields for each options form - only multiple if there is VB</d1p1:Content>
      <d1p1:LineIndex>7</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>   Polling or Fuzzy Searching enabled]</d1p1:Content>
      <d1p1:LineIndex>8</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>9</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_StayMain_AvailCal</d1p1:Content>
      <d1p1:LineIndex>10</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_RenderNewReq_AvailCal</d1p1:Content>
      <d1p1:LineIndex>11</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  [AvailCal rending uses these with RenderBookingInfoForm and BookingUI_RenderButtons only,</d1p1:Content>
      <d1p1:LineIndex>12</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>   BookingUI_StayMain_AvailCal is called direct from the Render method - Note: the Avail</d1p1:Content>
      <d1p1:LineIndex>13</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>   Cal format does not require any data access, so TOv2 is never accessed]</d1p1:Content>
      <d1p1:LineIndex>14</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>15</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_StayMain</d1p1:Content>
      <d1p1:LineIndex>16</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  [Calls BookingUI_StayMain_Legacy or BookingUI_StayMain_Polling]</d1p1:Content>
      <d1p1:LineIndex>17</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>18</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_StayMain_Polling</d1p1:Content>
      <d1p1:LineIndex>19</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>20</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_StayMain_Legacy</d1p1:Content>
      <d1p1:LineIndex>21</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>22</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_StaySummary</d1p1:Content>
      <d1p1:LineIndex>23</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_StayDetails / BookingUI_StayDetails_PollingHeader / BookingUI_StayDetailsUrl</d1p1:Content>
      <d1p1:LineIndex>24</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_RenderNewStay / BookingUI_StayTtl / BookingUI_StayDiff</d1p1:Content>
      <d1p1:LineIndex>25</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_RenderNewReq</d1p1:Content>
      <d1p1:LineIndex>26</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_RenderUnit</d1p1:Content>
      <d1p1:LineIndex>27</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_RenderButtons</d1p1:Content>
      <d1p1:LineIndex>28</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_AvailClassName / BookingUI_AvailClassIcon</d1p1:Content>
      <d1p1:LineIndex>29</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_NicePrice</d1p1:Content>
      <d1p1:LineIndex>30</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_LinkedUnitDesc</d1p1:Content>
      <d1p1:LineIndex>31</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>32</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> BookingUI_TicketsSummary</d1p1:Content>
      <d1p1:LineIndex>33</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  [Tickets uses this to render content - called from BookingUI_StayMain_Legacy - doesn't need all</d1p1:Content>
      <d1p1:LineIndex>34</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>   of the above]</d1p1:Content>
      <d1p1:LineIndex>35</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>36</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> GetExtBookUrlFromProductEstate</d1p1:Content>
      <d1p1:LineIndex>37</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>38</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:OptionExplicit" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:DimStatement">
      <d1p1:Variables>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>Page</d1p1:Content>
            <d1p1:LineIndex>41</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>Request</d1p1:Content>
            <d1p1:LineIndex>41</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>Context</d1p1:Content>
            <d1p1:LineIndex>41</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>Server</d1p1:Content>
            <d1p1:LineIndex>41</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>DMS</d1p1:Content>
            <d1p1:LineIndex>41</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
      </d1p1:Variables>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:DimStatement">
      <d1p1:Variables>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>InterfaceVersion</d1p1:Content>
            <d1p1:LineIndex>43</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
      </d1p1:Variables>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
      <d1p1:Expression>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:NumericValueToken">
            <d1p1:Content>1</d1p1:Content>
            <d1p1:LineIndex>45</d1p1:LineIndex>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:Expression>
      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
      <d1p1:ValueToSet>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:NameToken">
            <d1p1:Content>InterfaceVersion</d1p1:Content>
            <d1p1:LineIndex>45</d1p1:LineIndex>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:ValueToSet>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:ConstStatement">
      <d1p1:Values>
        <d1p1:ConstStatement.ConstValueInitialisation>
          <d1p1:Name>
            <d1p1:Content>BOOKING_Local</d1p1:Content>
            <d1p1:LineIndex>47</d1p1:LineIndex>
          </d1p1:Name>
          <d1p1:Value i:type="d1p1:NumericValueToken">
            <d1p1:Content>0</d1p1:Content>
            <d1p1:LineIndex>47</d1p1:LineIndex>
          </d1p1:Value>
        </d1p1:ConstStatement.ConstValueInitialisation>
      </d1p1:Values>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:ConstStatement">
      <d1p1:Values>
        <d1p1:ConstStatement.ConstValueInitialisation>
          <d1p1:Name>
            <d1p1:Content>BOOKING_Eviivo</d1p1:Content>
            <d1p1:LineIndex>48</d1p1:LineIndex>
          </d1p1:Name>
          <d1p1:Value i:type="d1p1:NumericValueToken">
            <d1p1:Content>1</d1p1:Content>
            <d1p1:LineIndex>48</d1p1:LineIndex>
          </d1p1:Value>
        </d1p1:ConstStatement.ConstValueInitialisation>
      </d1p1:Values>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:ConstStatement">
      <d1p1:Values>
        <d1p1:ConstStatement.ConstValueInitialisation>
          <d1p1:Name>
            <d1p1:Content>BOOKING_Redirect</d1p1:Content>
            <d1p1:LineIndex>49</d1p1:LineIndex>
          </d1p1:Name>
          <d1p1:Value i:type="d1p1:NumericValueToken">
            <d1p1:Content>2</d1p1:Content>
            <d1p1:LineIndex>49</d1p1:LineIndex>
          </d1p1:Value>
        </d1p1:ConstStatement.ConstValueInitialisation>
      </d1p1:Values>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:ConstStatement">
      <d1p1:Values>
        <d1p1:ConstStatement.ConstValueInitialisation>
          <d1p1:Name>
            <d1p1:Content>BOOKING_PollingRedirect</d1p1:Content>
            <d1p1:LineIndex>50</d1p1:LineIndex>
          </d1p1:Name>
          <d1p1:Value i:type="d1p1:NumericValueToken">
            <d1p1:Content>3</d1p1:Content>
            <d1p1:LineIndex>50</d1p1:LineIndex>
          </d1p1:Value>
        </d1p1:ConstStatement.ConstValueInitialisation>
      </d1p1:Values>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>nasty globals</d1p1:Content>
      <d1p1:LineIndex>52</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:DimStatement">
      <d1p1:Variables>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>IsExternalBooking</d1p1:Content>
            <d1p1:LineIndex>53</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>strExtBookUrl</d1p1:Content>
            <d1p1:LineIndex>53</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>strProductEstateID</d1p1:Content>
            <d1p1:LineIndex>53</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>bFormRendered</d1p1:Content>
            <d1p1:LineIndex>53</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
            <d1p1:LineIndex>53</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>bRenderAsCalendar</d1p1:Content>
            <d1p1:LineIndex>53</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
      </d1p1:Variables>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:DimStatement">
      <d1p1:Variables>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
            <d1p1:LineIndex>54</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
      </d1p1:Variables>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
      <d1p1:Expression>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:NumericValueToken">
            <d1p1:Content>0</d1p1:Content>
            <d1p1:LineIndex>54</d1p1:LineIndex>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:Expression>
      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
      <d1p1:ValueToSet>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:NameToken">
            <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
            <d1p1:LineIndex>54</d1p1:LineIndex>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:ValueToSet>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
      <d1p1:Expression>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
            <d1p1:Content>False</d1p1:Content>
            <d1p1:LineIndex>55</d1p1:LineIndex>
            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:Expression>
      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
      <d1p1:ValueToSet>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:NameToken">
            <d1p1:Content>bFormRendered</d1p1:Content>
            <d1p1:LineIndex>55</d1p1:LineIndex>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:ValueToSet>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:DimStatement">
      <d1p1:Variables>
        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
          <d1p1:Dimensions i:nil="true" />
          <d1p1:Name>
            <d1p1:Content>bProdHasAvail</d1p1:Content>
            <d1p1:LineIndex>57</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:DimVariable>
      </d1p1:Variables>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
      <d1p1:Expression>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
            <d1p1:Content>False</d1p1:Content>
            <d1p1:LineIndex>57</d1p1:LineIndex>
            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:Expression>
      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
      <d1p1:ValueToSet>
        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
        <d1p1:Tokens>
          <d2p1:anyType i:type="d1p1:NameToken">
            <d1p1:Content>bProdHasAvail</d1p1:Content>
            <d1p1:LineIndex>57</d1p1:LineIndex>
          </d2p1:anyType>
        </d1p1:Tokens>
      </d1p1:ValueToSet>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>true</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>GetProdHasAvail</d1p1:Content>
        <d1p1:LineIndex>58</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters />
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bProdHasAvail</d1p1:Content>
                <d1p1:LineIndex>59</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetProdHasAvail</d1p1:Content>
                <d1p1:LineIndex>59</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>public methods</d1p1:Content>
      <d1p1:LineIndex>62</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>64</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Availability Calendar (supports local availability only!)</d1p1:Content>
      <d1p1:LineIndex>65</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> - Note: This doesn't actually perform any data access, all of the content required is passed</d1p1:Content>
      <d1p1:LineIndex>66</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>   through in POST data from the availability calendar on the previous page (Product Detail)</d1p1:Content>
      <d1p1:LineIndex>67</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>68</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>true</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayMain_AvailCal</d1p1:Content>
        <d1p1:LineIndex>69</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>69</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>69</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Expect selections as set of form values:</d1p1:Content>
          <d1p1:LineIndex>70</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  "unit_prodkey", "minoccu_prodkey", "maxcap_prodkey", "name_prodkey", "availclass_prodkey"</d1p1:Content>
          <d1p1:LineIndex>71</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content></d1p1:Content>
          <d1p1:LineIndex>72</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If linked units are referenced, the first value will be:</d1p1:Content>
          <d1p1:LineIndex>73</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  "unit_prodkey_linkprodkey"</d1p1:Content>
          <d1p1:LineIndex>74</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2011-08-09 DWR: Get populated read-only Booking Requirement data From GetSharedObject, then translate into a local copy we can edit</d1p1:Content>
          <d1p1:LineIndex>76</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> (since some methods in here try to mess about with properties on it)</d1p1:Content>
          <d1p1:LineIndex>77</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetSharedObject</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>78</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetEditableBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>79</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>79</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>79</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>79</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>79</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intBookingType</d1p1:Content>
                <d1p1:LineIndex>81</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iStayNum</d1p1:Content>
                <d1p1:LineIndex>82</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iThisReqmnt</d1p1:Content>
                <d1p1:LineIndex>82</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iUnitQty</d1p1:Content>
                <d1p1:LineIndex>83</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                <d1p1:LineIndex>83</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                <d1p1:LineIndex>83</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iUnitKey</d1p1:Content>
                <d1p1:LineIndex>84</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iLinkedUnitKey</d1p1:Content>
                <d1p1:LineIndex>84</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strUnitName</d1p1:Content>
                <d1p1:LineIndex>85</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strAvailClassId</d1p1:Content>
                <d1p1:LineIndex>85</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>Item</d1p1:Content>
                <d1p1:LineIndex>86</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strTemp</d1p1:Content>
                <d1p1:LineIndex>86</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>i</d1p1:Content>
                <d1p1:LineIndex>86</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dStart</d1p1:Content>
                <d1p1:LineIndex>88</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>88</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>88</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>VisitDate</d1p1:Content>
                <d1p1:LineIndex>88</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dStart</d1p1:Content>
                <d1p1:LineIndex>88</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>89</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>89</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>89</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>89</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>89</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>90</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>90</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>90</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Product</d1p1:Content>
                <d1p1:LineIndex>90</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>90</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Open form and prepare to wrap content in "staySelection" container</d1p1:Content>
          <d1p1:LineIndex>92</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>93</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsExternalBooking</d1p1:Content>
                    <d1p1:LineIndex>93</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>93</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                        <d1p1:LineIndex>94</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intBookingType</d1p1:Content>
                        <d1p1:LineIndex>94</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BOOKING_Local</d1p1:Content>
                      <d1p1:LineIndex>96</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>intBookingType</d1p1:Content>
                      <d1p1:LineIndex>96</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>RenderBookingInfoForm</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>intProdKey</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objRenderSettings</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>intBookingType</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>99</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>101</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>101</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>101</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="staySelection"&gt;</d1p1:Content>
              <d1p1:LineIndex>101</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Try to pull requirement info from Request</d1p1:Content>
          <d1p1:LineIndex>103</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>104</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iStayNum</d1p1:Content>
                <d1p1:LineIndex>104</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>105</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iThisReqmnt</d1p1:Content>
                <d1p1:LineIndex>105</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForEachBlock">
          <d1p1:LoopSrc>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Request</d1p1:Content>
                <d1p1:LineIndex>106</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>106</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Form</d1p1:Content>
                <d1p1:LineIndex>106</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopSrc>
          <d1p1:LoopVar>
            <d1p1:Content>Item</d1p1:Content>
            <d1p1:LineIndex>106</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content>## Loop through only units</d1p1:Content>
              <d1p1:LineIndex>107</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Left</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Item</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>5</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>unit_</d1p1:Content>
                        <d1p1:LineIndex>108</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>Right</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Item</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>Len</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Item</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>-</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>5</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strTemp</d1p1:Content>
                            <d1p1:LineIndex>110</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                <d1p1:Content>Instr</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strTemp</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>_</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>&gt;</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>0</d1p1:Content>
                                <d1p1:LineIndex>111</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:CommentStatement">
                              <d1p1:Content> Linked unit</d1p1:Content>
                              <d1p1:LineIndex>112</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>CLng</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Right</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strTemp</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Len</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strTemp</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>-</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Instr</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strTemp</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>_</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iUnitKey</d1p1:Content>
                                    <d1p1:LineIndex>113</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>CLng</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Left</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strTemp</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Instr</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strTemp</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>_</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>-</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>1</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iLinkedUnitKey</d1p1:Content>
                                    <d1p1:LineIndex>114</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                  <d1p1:Content>CLng</d1p1:Content>
                                  <d1p1:LineIndex>116</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OpenBrace">
                                  <d1p1:Content>(</d1p1:Content>
                                  <d1p1:LineIndex>116</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strTemp</d1p1:Content>
                                  <d1p1:LineIndex>116</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:CloseBrace">
                                  <d1p1:Content>)</d1p1:Content>
                                  <d1p1:LineIndex>116</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>iUnitKey</d1p1:Content>
                                  <d1p1:LineIndex>116</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NumericValueToken">
                                  <d1p1:Content>0</d1p1:Content>
                                  <d1p1:LineIndex>117</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>iLinkedUnitKey</d1p1:Content>
                                  <d1p1:LineIndex>117</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d1p1:OptionalElseClause>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>CLng</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Item</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitQty</d1p1:Content>
                            <d1p1:LineIndex>120</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>CLng</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>minoccu_</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strTemp</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                            <d1p1:LineIndex>121</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>CLng</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>maxcap_</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strTemp</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                            <d1p1:LineIndex>122</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>name_</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strTemp</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strUnitName</d1p1:Content>
                            <d1p1:LineIndex>124</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>availclass_</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strTemp</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strAvailClassId</d1p1:Content>
                            <d1p1:LineIndex>125</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iUnitQty</d1p1:Content>
                                <d1p1:LineIndex>126</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>&gt;</d1p1:Content>
                                <d1p1:LineIndex>126</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>0</d1p1:Content>
                                <d1p1:LineIndex>126</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ForBlock">
                              <d1p1:LoopFrom>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>1</d1p1:Content>
                                    <d1p1:LineIndex>127</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:LoopFrom>
                              <d1p1:LoopStep i:nil="true" />
                              <d1p1:LoopTo>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iUnitQty</d1p1:Content>
                                    <d1p1:LineIndex>127</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:LoopTo>
                              <d1p1:LoopVar>
                                <d1p1:Content>i</d1p1:Content>
                                <d1p1:LineIndex>127</d1p1:LineIndex>
                              </d1p1:LoopVar>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                  <d1p1:Expression>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iThisReqmnt</d1p1:Content>
                                        <d1p1:LineIndex>128</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OperatorToken">
                                        <d1p1:Content>+</d1p1:Content>
                                        <d1p1:LineIndex>128</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                                        <d1p1:Content>1</d1p1:Content>
                                        <d1p1:LineIndex>128</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Expression>
                                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                  <d1p1:ValueToSet>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iThisReqmnt</d1p1:Content>
                                        <d1p1:LineIndex>128</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:ValueToSet>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:Statement">
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>BookingUI_RenderNewReq_AvailCal</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>intBookingType</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>iUnitKey</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>strUnitName</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>strAvailClassId</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>iStayNum</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>iThisReqmnt</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                      <d1p1:Content>,</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>pO</d1p1:Content>
                                      <d1p1:LineIndex>129</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iLinkedUnitKey</d1p1:Content>
                                        <d1p1:LineIndex>131</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                        <d1p1:Content>&gt;</d1p1:Content>
                                        <d1p1:LineIndex>131</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                                        <d1p1:Content>0</d1p1:Content>
                                        <d1p1:LineIndex>131</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:Statement">
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>pO</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>write</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>&lt;input type="hidden" name="linked_</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>iUnitKey</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>"  value="</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>iLinkedUnitKey</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>" /&gt;</d1p1:Content>
                                          <d1p1:LineIndex>132</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause i:nil="true" />
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If successfully received requirement data, complete form - otherwise render error</d1p1:Content>
          <d1p1:LineIndex>138</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iThisReqmnt</d1p1:Content>
                    <d1p1:LineIndex>139</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>139</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>139</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>write</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="availcal" value="</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Request</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>availcal</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>140</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>write</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="_nStays" value="</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iStayNum</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>141</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>write</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="_nReqs" value="</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>142</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Close pnStayReqmntRslts div</d1p1:Content>
                  <d1p1:LineIndex>144</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>145</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>145</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>write</d1p1:Content>
                      <d1p1:LineIndex>145</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>145</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderButtons</d1p1:Content>
                      <d1p1:LineIndex>147</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iStayNum</d1p1:Content>
                      <d1p1:LineIndex>147</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>147</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>147</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>147</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>False</d1p1:Content>
                      <d1p1:LineIndex>147</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Close StayCandidateItem div</d1p1:Content>
                  <d1p1:LineIndex>149</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>150</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>150</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>write</d1p1:Content>
                      <d1p1:LineIndex>150</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>150</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>pO</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Write</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Resource</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>bookonline/unitselection/availcalendar/nounitsselectederror</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>&lt;h2&gt;Error&lt;/h2&gt;&lt;p class="error"&gt;No units selected. Please click on the back button to return to the previous page and select the units you wish to book.&lt;/p&gt;</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>152</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Close "staySelection" div and form</d1p1:Content>
          <d1p1:LineIndex>155</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>156</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>156</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>156</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>156</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>157</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>157</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>157</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/form&gt;</d1p1:Content>
              <d1p1:LineIndex>157</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_ChildPricing</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>158</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>159</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>159</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>159</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;script type="text/javascript"&gt;</d1p1:Content>
                      <d1p1:LineIndex>159</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>160</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>160</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>160</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>NewMind.ETWP.Booking.UnitSelectionChildPricingGuests.Init();</d1p1:Content>
                      <d1p1:LineIndex>160</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>po</d1p1:Content>
                      <d1p1:LineIndex>161</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>161</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>161</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/</d1p1:Content>
                      <d1p1:LineIndex>161</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>161</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>script&gt;</d1p1:Content>
                      <d1p1:LineIndex>161</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>165</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Main entry point when not using Availability Calendar</d1p1:Content>
      <d1p1:LineIndex>166</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>167</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: entry point for product UNIT/STAY selection (Booking)</d1p1:Content>
      <d1p1:LineIndex>168</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiProductKey]: integer product key</d1p1:Content>
      <d1p1:LineIndex>169</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtStartNight]: date of first night of stay</d1p1:Content>
      <d1p1:LineIndex>170</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiNights]: integer number of nights</d1p1:Content>
      <d1p1:LineIndex>171</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiFuzzyStayNumDays]: integer flexible start date days (ZERO = Precise match)</d1p1:Content>
      <d1p1:LineIndex>172</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>true</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayMain</d1p1:Content>
        <d1p1:LineIndex>173</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>173</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objData</d1p1:Content>
            <d1p1:LineIndex>173</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>most of these render functions rely on global variables, rather than trying to refactor them out for now ill create some globals</d1p1:Content>
          <d1p1:LineIndex>174</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>this needs refactoring</d1p1:Content>
          <d1p1:LineIndex>175</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2011-08-09 DWR: Expect the BookingRequirement in objRenderSettings to be read-only (since it usually comes from Page.Functions.GetSharedObject),</d1p1:Content>
          <d1p1:LineIndex>177</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> so replace it with an editable version (since some methods in here try to mess about with properties on it)</d1p1:Content>
          <d1p1:LineIndex>178</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetEditableBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>179</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>181</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>181</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                <d1p1:LineIndex>181</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                <d1p1:LineIndex>181</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>182</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>182</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>RenderAsCalendar</d1p1:Content>
                <d1p1:LineIndex>182</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                <d1p1:LineIndex>182</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>183</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objData</d1p1:Content>
                    <d1p1:LineIndex>183</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>Is</d1p1:Content>
                    <d1p1:LineIndex>183</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Nothing</d1p1:Content>
                    <d1p1:LineIndex>183</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>183</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> If couldn't retrieve product, report no availability - this will happen if the</d1p1:Content>
                  <d1p1:LineIndex>184</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> availability criteria can (no longer) be met</d1p1:Content>
                  <d1p1:LineIndex>185</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>RenderNoAvailElement</d1p1:Content>
                      <d1p1:LineIndex>186</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>186</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>187</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>190</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objRenderSettings</d1p1:Content>
                    <d1p1:LineIndex>190</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>190</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>LegacyRender</d1p1:Content>
                    <d1p1:LineIndex>190</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>190</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Acco or Ticketing w/out VB Polling Enabled: Results from single Supplier (either</d1p1:Content>
                  <d1p1:LineIndex>191</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> local OR FrontDesk for Acco, only local applies for Tickets)</d1p1:Content>
                  <d1p1:LineIndex>192</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_StayMain_Legacy</d1p1:Content>
                      <d1p1:LineIndex>193</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objData</d1p1:Content>
                      <d1p1:LineIndex>193</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>193</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>193</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> Acco w/ VB Polling Enabled: Results from multiple Suppliers</d1p1:Content>
                <d1p1:LineIndex>195</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> - Not supported when handling Conference Bookings, these are local only (but when</d1p1:Content>
                <d1p1:LineIndex>196</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content>   an OfferKey is set, IsVBPollingEnabled is put to False - see PreRender)</d1p1:Content>
                <d1p1:LineIndex>197</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingUI_StayMain_Polling</d1p1:Content>
                    <d1p1:LineIndex>198</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objData</d1p1:Content>
                    <d1p1:LineIndex>198</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>198</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objRenderSettings</d1p1:Content>
                    <d1p1:LineIndex>198</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>internal methods</d1p1:Content>
      <d1p1:LineIndex>202</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>205</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Write out form with hidden input fields used for internal or FrontDesk bookings</d1p1:Content>
      <d1p1:LineIndex>206</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> - This will open the form, but the caller must close it</d1p1:Content>
      <d1p1:LineIndex>207</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>208</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> Note: We need to pass intProdKey into here as we may not have an objProduct reference</d1p1:Content>
      <d1p1:LineIndex>209</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> (eg. if called by BookingUI_StayMain_AvailCal)</d1p1:Content>
      <d1p1:LineIndex>210</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>RenderBookingInfoForm</d1p1:Content>
        <d1p1:LineIndex>211</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>212</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intProdKey</d1p1:Content>
            <d1p1:LineIndex>213</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>214</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intBookingType</d1p1:Content>
            <d1p1:LineIndex>215</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierId</d1p1:Content>
            <d1p1:LineIndex>216</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierName</d1p1:Content>
            <d1p1:LineIndex>217</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierEviivoName</d1p1:Content>
            <d1p1:LineIndex>218</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
            <d1p1:LineIndex>219</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierLogo</d1p1:Content>
            <d1p1:LineIndex>220</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intEviivoSearchIndustryClassification</d1p1:Content>
            <d1p1:LineIndex>221</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> intBookingType can be one of:</d1p1:Content>
          <d1p1:LineIndex>223</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  BOOKING_Local =&gt; Proceed to "Checkout" stage next</d1p1:Content>
          <d1p1:LineIndex>224</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  BOOKING_Eviivo =&gt; Proceed to "Checkout" stage next, but handling a FrontDesk</d1p1:Content>
          <d1p1:LineIndex>225</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  BOOKING_Redirect =&gt; Will redirect to complete booking on separate (probably NewMind) site</d1p1:Content>
          <d1p1:LineIndex>226</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  BOOKING_PollingRedirect =&gt; Will proceed to "PollingExit" stage next</d1p1:Content>
          <d1p1:LineIndex>227</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> strSupplierDeepLinkQuality should be null unless intBookingType is BOOKING_PollingRedirect,</d1p1:Content>
          <d1p1:LineIndex>228</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> in which case it should be a string (possibly null if we didn't have this information available</d1p1:Content>
          <d1p1:LineIndex>229</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> in the DMS about the Supplier)</d1p1:Content>
          <d1p1:LineIndex>230</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strPostUrl</d1p1:Content>
                <d1p1:LineIndex>231</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strFormClass</d1p1:Content>
                <d1p1:LineIndex>231</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strNextStage</d1p1:Content>
                <d1p1:LineIndex>231</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Legacy rendering uses different form class for bookings that leave the site (we render them</d1p1:Content>
          <d1p1:LineIndex>233</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> all the same when VB Polling is enabled, though)</d1p1:Content>
          <d1p1:LineIndex>234</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>235</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>235</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>235</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                    <d1p1:LineIndex>235</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>235</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>FrmUnitOptionsExt</d1p1:Content>
                        <d1p1:LineIndex>236</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strFormClass</d1p1:Content>
                        <d1p1:LineIndex>236</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>FrmUnitOptions</d1p1:Content>
                      <d1p1:LineIndex>238</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strFormClass</d1p1:Content>
                      <d1p1:LineIndex>238</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> What booking stage is next?</d1p1:Content>
          <d1p1:LineIndex>241</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - If not external, go to checkout regardless of VB Polling setting.</d1p1:Content>
          <d1p1:LineIndex>242</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - If IS external, branch off differently (VB Polling goes to a separate switcher stage, non-</d1p1:Content>
          <d1p1:LineIndex>243</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   VB-Polling will redirect to the other site).</d1p1:Content>
          <d1p1:LineIndex>244</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> While we're here, retrieve POST url (secure for checkout, standard otherwise)</d1p1:Content>
          <d1p1:LineIndex>245</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_Local</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_Eviivo</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>246</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>checkout</d1p1:Content>
                        <d1p1:LineIndex>247</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strNextStage</d1p1:Content>
                        <d1p1:LineIndex>247</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetPostUrl</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>True</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>/</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strNextStage</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl</d1p1:Content>
                        <d1p1:LineIndex>248</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>249</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>249</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>249</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                    <d1p1:LineIndex>249</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>249</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content>strNextStage = "redirect"</d1p1:Content>
                  <d1p1:LineIndex>250</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>checkout</d1p1:Content>
                        <d1p1:LineIndex>251</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strNextStage</d1p1:Content>
                        <d1p1:LineIndex>251</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content>This should stay as "checkout" until 1.4 is updated to recognise "redirect" stage</d1p1:Content>
                  <d1p1:LineIndex>251</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>PageInfo</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetUrlFromPageID</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>EXTBOOKPROMPT</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl</d1p1:Content>
                        <d1p1:LineIndex>252</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>IsNull</d1p1:Content>
                            <d1p1:LineIndex>253</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>253</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strPostUrl</d1p1:Content>
                            <d1p1:LineIndex>253</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>253</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>254</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>254</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>PrintTraceWarning</d1p1:Content>
                              <d1p1:LineIndex>254</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>RenderBookingInfoForm: Unable to locate page EXTBOOKPROMPT, default to current page - is this correct behaviour??</d1p1:Content>
                              <d1p1:LineIndex>254</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Page</d1p1:Content>
                                <d1p1:LineIndex>255</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>255</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>URL</d1p1:Content>
                                <d1p1:LineIndex>255</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>255</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Real</d1p1:Content>
                                <d1p1:LineIndex>255</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strPostUrl</d1p1:Content>
                                <d1p1:LineIndex>255</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>257</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>257</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>257</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_PollingRedirect</d1p1:Content>
                    <d1p1:LineIndex>257</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>257</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2014-06-19 DWR: We have historically used the SupplierEviivoName for the URL segment, although it used to be labelled strSupplierName since</d1p1:Content>
                  <d1p1:LineIndex>258</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> the values were getting set incorrectly. SupplierEviivoName seems like the most appropriate option since it will be a text-friendly string</d1p1:Content>
                  <d1p1:LineIndex>259</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> value and so not have dots or spaces or whatever (and so be good for use in a URL).</d1p1:Content>
                  <d1p1:LineIndex>260</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>pollingexit</d1p1:Content>
                        <d1p1:LineIndex>261</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strNextStage</d1p1:Content>
                        <d1p1:LineIndex>261</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetPostUrl</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>False</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>/pollingexit/</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl</d1p1:Content>
                        <d1p1:LineIndex>262</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Err</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Raise</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>vbObjectError</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>ETWP.BookingUnitSelection</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>RenderBookingInfoForm: Invalid intBookingType value (</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>264</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;form action="</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strPostUrl</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>267</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objRenderSettings</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>FlexibleRange</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>268</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Can't have ids when VB Polling enabled as we might be rendering out multiple of these forms.</d1p1:Content>
                  <d1p1:LineIndex>269</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2008-11-10 DWR: This is similarly the case for fuzzy searching. I don't we have any working</d1p1:Content>
                  <d1p1:LineIndex>270</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Enterprise fuzzy-searching sites, so don't need to worry about breaking styling by removing</d1p1:Content>
                  <d1p1:LineIndex>271</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> this id in this case.</d1p1:Content>
                  <d1p1:LineIndex>272</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>273</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>273</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>273</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>id="FrmUnitOptions" </d1p1:Content>
                      <d1p1:LineIndex>273</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>#MJ's Reasoning -	In order for us to jump to unit selection in a tab it must have a name, however only the first form should have this</d1p1:Content>
          <d1p1:LineIndex>276</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>277</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bFormRendered</d1p1:Content>
                    <d1p1:LineIndex>277</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>278</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>278</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>278</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>name="FrmUnitOptions" </d1p1:Content>
                      <d1p1:LineIndex>278</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>True</d1p1:Content>
                        <d1p1:LineIndex>279</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bFormRendered</d1p1:Content>
                        <d1p1:LineIndex>279</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>class="</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strFormClass</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" method="post"&gt;</d1p1:Content>
              <d1p1:LineIndex>281</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Open container around common form values</d1p1:Content>
          <d1p1:LineIndex>283</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>284</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>284</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>284</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div&gt;</d1p1:Content>
              <d1p1:LineIndex>284</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="stage" value="</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strNextStage</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>286</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Need to override market source if viewing site via widget</d1p1:Content>
          <d1p1:LineIndex>288</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>289</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>289</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>WidgetView</d1p1:Content>
                    <d1p1:LineIndex>289</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>290</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intBookingType</d1p1:Content>
                            <d1p1:LineIndex>290</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>290</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                            <d1p1:LineIndex>290</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>290</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> External bookings visit a preliminary redirect page first, which we want to be decluttered when in a widget</d1p1:Content>
                          <d1p1:LineIndex>291</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;input type="hidden" name="widget_marketsource" value="</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>WidgetMarketSource</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>" /&gt;</d1p1:Content>
                              <d1p1:LineIndex>292</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;input type="hidden" name="msource" value="</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>WidgetMarketSource</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>" /&gt;</d1p1:Content>
                            <d1p1:LineIndex>294</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content>this hidden field is to tell the checkout that weve come from a widget, and not a failed checkout validation</d1p1:Content>
                  <d1p1:LineIndex>296</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>297</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>297</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>297</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="widget" value="1" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>297</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> None of this applies to VB Polling, even if it IS an external booking - we go to an</d1p1:Content>
          <d1p1:LineIndex>300</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> interim stage before leaving the site</d1p1:Content>
          <d1p1:LineIndex>301</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>302</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>302</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>302</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                    <d1p1:LineIndex>302</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>302</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> NB: In "Conference Booking" mode (where OfferKey &lt;&gt; 0), we need to set the "channel" and "msource"</d1p1:Content>
                  <d1p1:LineIndex>303</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content>     values to different values (for msource, if there is no "ConfBookingMarketSourceID" set, it will</d1p1:Content>
                  <d1p1:LineIndex>304</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content>     fall back to using the site's main "MarketSourceID" source)</d1p1:Content>
                  <d1p1:LineIndex>305</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>306</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>306</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>306</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="checkoutstage" value="1" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>306</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingRequirement</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Offer</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>307</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;input type="hidden" name="channel" value="</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>objRenderSettings</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Channel</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>" /&gt;</d1p1:Content>
                              <d1p1:LineIndex>308</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;input type="hidden" name="channel" value="</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>ConfBookingChannel</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>" /&gt;</d1p1:Content>
                            <d1p1:LineIndex>310</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                            <d1p1:Content>Not</d1p1:Content>
                            <d1p1:LineIndex>312</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>312</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>312</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>WidgetView</d1p1:Content>
                            <d1p1:LineIndex>312</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content>Neeed to set market source override if redirecting to external site unless set above due to widgetview</d1p1:Content>
                          <d1p1:LineIndex>313</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:IfBlock">
                          <d1p1:ConditionalClauses>
                            <d1p1:IfBlock.IfBlockConditionSegment>
                              <d1p1:Condition>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objRenderSettings</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>BookingRequirement</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Offer</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                    <d1p1:Content>=</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>0</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                    <d1p1:Content>Or</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Page</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Site</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Params</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>ConfBookingMarketSourceID</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                    <d1p1:Content>=</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content></d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>314</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Condition>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:Statement">
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>pO</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>Write</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>&lt;input type="hidden" name="msource" value="</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:OperatorToken">
                                      <d1p1:Content>&amp;</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>Page</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>Site</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>Params</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:OpenBrace">
                                      <d1p1:Content>(</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>MarketSourceID</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CloseBrace">
                                      <d1p1:Content>)</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:OperatorToken">
                                      <d1p1:Content>&amp;</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>" /&gt;</d1p1:Content>
                                      <d1p1:LineIndex>315</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d1p1:IfBlock.IfBlockConditionSegment>
                          </d1p1:ConditionalClauses>
                          <d1p1:OptionalElseClause>
                            <d1p1:Statements>
                              <d2p1:anyType i:type="d1p1:Statement">
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>pO</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Write</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>&lt;input type="hidden" name="msource" value="</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Page</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Site</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Params</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>ConfBookingMarketSourceID</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>" /&gt;</d1p1:Content>
                                    <d1p1:LineIndex>317</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d2p1:anyType>
                            </d1p1:Statements>
                          </d1p1:OptionalElseClause>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="bookchannel" value="</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Site</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Params</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Booking_ChannelID</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>320</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="reposturl" value="</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strExtBookUrl</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>321</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2009-09-21 DWR: New field to pass in so that the receiving site recognises booking as having</d1p1:Content>
                  <d1p1:LineIndex>322</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> come from another site (so it can update appropriate Provider Stats)</d1p1:Content>
                  <d1p1:LineIndex>323</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>324</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>324</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>324</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="ForcedExternalBooking" value="1" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>324</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="product" value="</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>intProdKey</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>327</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="isostartdate" value="</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Functions</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Dates</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>ISODate</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objRenderSettings</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingRequirement</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>VisitDate</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>328</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="nights" value="</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objRenderSettings</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingRequirement</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Nights</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>329</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> We need all this when using VB Polling, even it it is an external booking, as we aren't</d1p1:Content>
          <d1p1:LineIndex>331</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> going to leave the site yet (there's an interim stage)</d1p1:Content>
          <d1p1:LineIndex>332</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>333</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>333</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>333</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>333</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                    <d1p1:LineIndex>333</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>333</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> NB: "package" parameter removed - it's now passed as "offer", and only when</d1p1:Content>
                  <d1p1:LineIndex>334</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> customer is going for a "Conference Booking" discount product.</d1p1:Content>
                  <d1p1:LineIndex>335</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2008-11-07 DWR: This used to referer to a "strRewriteUrl" value that was never defined.</d1p1:Content>
                  <d1p1:LineIndex>336</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> So we'll pass in blank. Pretty sure it's not used anyway.</d1p1:Content>
                  <d1p1:LineIndex>337</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>338</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>338</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>338</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="preUrl" value="" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>338</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2008-11-07 DWR: If we've got non-precise results from a fuzzy search, we'll render this</d1p1:Content>
                  <d1p1:LineIndex>339</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> form out and use the actual StartDate / NumNights combination that the fuzzy results</d1p1:Content>
                  <d1p1:LineIndex>340</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> offered. So we just pass these to the checkout stage, and set "fuzzy" to zero.</d1p1:Content>
                  <d1p1:LineIndex>341</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>342</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>342</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>342</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="fuzzy" value="0" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>342</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="lng" value="</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Language</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>LanguageCultureKey</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>343</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> NB: OfferKey is required for products in the "Conference Booking" functionality as</d1p1:Content>
                  <d1p1:LineIndex>345</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> it lets the checkout object know that we should be looking for the product on the</d1p1:Content>
                  <d1p1:LineIndex>346</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> "Conference Booking Channel" instead of the standard "website" channel. If this</d1p1:Content>
                  <d1p1:LineIndex>347</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> ever needed to work with the ExternalBooking, we would need to pass out the</d1p1:Content>
                  <d1p1:LineIndex>348</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> conference channel in the IsExternalBooking section above, but since this is</d1p1:Content>
                  <d1p1:LineIndex>349</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> only being supported by the internal Newmind booking, it's not an issue.</d1p1:Content>
                  <d1p1:LineIndex>350</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="offer" value="</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingRequirement</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Offer</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>351</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Pass in the current convert-to-currency value (this will have been held in the session</d1p1:Content>
                  <d1p1:LineIndex>353</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> up to this point, but we may be about to leave the site when this form is posted, so</d1p1:Content>
                  <d1p1:LineIndex>354</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> will need to send the value as a hidden input instead of relying on session)</d1p1:Content>
                  <d1p1:LineIndex>355</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="CurrencyConvertTo" value="</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Functions</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Money</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>GetCurrencyCodeOverride</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Site</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>LCCurrencyKey</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>356</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If we're dealing with a VB Polling External Supplier, write out the Supplier id, name and</d1p1:Content>
          <d1p1:LineIndex>359</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> deep-link-quality as well (this is the number of rooms that the supplier can handle in</d1p1:Content>
          <d1p1:LineIndex>360</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> deep-linking situations)</d1p1:Content>
          <d1p1:LineIndex>361</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>362</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>362</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>362</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BOOKING_PollingRedirect</d1p1:Content>
                    <d1p1:LineIndex>362</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>362</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="SupplierId" value="</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierId</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>363</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="SupplierName" value="</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierName</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>364</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="SupplierLogo" value="</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierLogo</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>365</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="SupplierEviivoName" value="</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>366</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>368</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>368</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>368</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="EviivoSearchIndustryClassification" value="</d1p1:Content>
                      <d1p1:LineIndex>368</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>IsNumeric</d1p1:Content>
                            <d1p1:LineIndex>369</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>369</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intEviivoSearchIndustryClassification</d1p1:Content>
                            <d1p1:LineIndex>369</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>369</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>370</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>370</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>370</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>intEviivoSearchIndustryClassification</d1p1:Content>
                              <d1p1:LineIndex>370</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>372</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>372</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>372</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>372</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>374</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>374</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>374</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>374</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>IsNull</d1p1:Content>
                            <d1p1:LineIndex>376</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>376</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                            <d1p1:LineIndex>376</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>376</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content></d1p1:Content>
                                <d1p1:LineIndex>377</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                                <d1p1:LineIndex>377</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                              <d1p1:Content>Trim</d1p1:Content>
                              <d1p1:LineIndex>379</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>379</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                              <d1p1:LineIndex>379</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>379</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                              <d1p1:LineIndex>379</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                            <d1p1:Content>Not</d1p1:Content>
                            <d1p1:LineIndex>381</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>IsNumeric</d1p1:Content>
                            <d1p1:LineIndex>381</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>381</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                            <d1p1:LineIndex>381</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>381</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>-1</d1p1:Content>
                                <d1p1:LineIndex>382</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                                <d1p1:LineIndex>382</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="SupplierDeepLinkQuality" value="</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierDeepLinkQuality</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>384</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Append in the "Nominal Units" from Request collection or objUnitReqDictFromBookUrl (ie. "roomReq_1", "roomReq_2", etc..)</d1p1:Content>
          <d1p1:LineIndex>387</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>#MJ TODO need to call the new function</d1p1:Content>
          <d1p1:LineIndex>388</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>GenerateRequirementFormData</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objRenderSettings</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingRequirement</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>389</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Close common form value container</d1p1:Content>
          <d1p1:LineIndex>390</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>391</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>391</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>391</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>391</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>generates a string of room requirement details in a format suitable for use in a form i.e hidden inputs ;)</d1p1:Content>
      <d1p1:LineIndex>395</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>GenerateRequirementFormData</d1p1:Content>
        <d1p1:LineIndex>396</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAccoSearchRequirement</d1p1:Content>
            <d1p1:LineIndex>396</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>get our key value data dictionary</d1p1:Content>
          <d1p1:LineIndex>397</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dictKeyValues</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Booking</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GenerateRequirementKeyValueData</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAccoSearchRequirement</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dictKeyValues</d1p1:Content>
                <d1p1:LineIndex>398</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>create an array to hold our formatted data in which is the same size of the dictionary</d1p1:Content>
          <d1p1:LineIndex>399</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>aryFormattedData</d1p1:Content>
                <d1p1:LineIndex>400</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ReDimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable>
              <d1p1:Dimensions>
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>dictKeyValues</d1p1:Content>
                      <d1p1:LineIndex>401</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>401</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Count</d1p1:Content>
                      <d1p1:LineIndex>401</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>-</d1p1:Content>
                      <d1p1:LineIndex>401</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NumericValueToken">
                      <d1p1:Content>1</d1p1:Content>
                      <d1p1:LineIndex>401</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
              </d1p1:Dimensions>
              <d1p1:Name>
                <d1p1:Content>aryFormattedData</d1p1:Content>
                <d1p1:LineIndex>401</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
          <d1p1:Preserve>false</d1p1:Preserve>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>spin through our output array and add the formatted items in the format {key}={value}</d1p1:Content>
          <d1p1:LineIndex>402</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>i</d1p1:Content>
                <d1p1:LineIndex>403</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>403</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>i</d1p1:Content>
                <d1p1:LineIndex>403</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>key</d1p1:Content>
                <d1p1:LineIndex>404</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForEachBlock">
          <d1p1:LoopSrc>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dictKeyValues</d1p1:Content>
                <d1p1:LineIndex>405</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>405</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Keys</d1p1:Content>
                <d1p1:LineIndex>405</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopSrc>
          <d1p1:LoopVar>
            <d1p1:Content>key</d1p1:Content>
            <d1p1:LineIndex>405</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content>#MJ's Reasoning -	we don't want to render our roomrequirement's here as they may not be valid</d1p1:Content>
              <d1p1:LineIndex>406</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content>					instead when we write out a room requirement say what room it is and for how many</d1p1:Content>
              <d1p1:LineIndex>407</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> NP: MJ is saying add hidden form values based on the requirements linked to the UnitStayDetails by the AvailCom</d1p1:Content>
              <d1p1:LineIndex>408</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> NOT to base it on the BookingRequestDictionary. These form values will then be posted</d1p1:Content>
              <d1p1:LineIndex>409</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> and update the BookingRequirement object for when it is used in the Booking Checkout</d1p1:Content>
              <d1p1:LineIndex>410</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Left</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>LCase</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>key</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>8</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>roomreq_</d1p1:Content>
                        <d1p1:LineIndex>411</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;input type="hidden" name="</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>key</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>" value="</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>dictKeyValues</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Item</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>key</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>" /&gt;</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>vbCRLF</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>aryFormattedData</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>i</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>412</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>i</d1p1:Content>
                    <d1p1:LineIndex>414</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>+</d1p1:Content>
                    <d1p1:LineIndex>414</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>414</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>i</d1p1:Content>
                    <d1p1:LineIndex>414</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>return our array as a string using an &amp; as the joining character</d1p1:Content>
          <d1p1:LineIndex>416</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Join</d1p1:Content>
                <d1p1:LineIndex>417</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>417</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aryFormattedData</d1p1:Content>
                <d1p1:LineIndex>417</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>417</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GenerateRequirementFormData</d1p1:Content>
                <d1p1:LineIndex>417</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>GetPostUrl</d1p1:Content>
        <d1p1:LineIndex>420</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bSecure</d1p1:Content>
            <d1p1:LineIndex>420</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strPostUrl</d1p1:Content>
                <d1p1:LineIndex>421</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strUrl</d1p1:Content>
                <d1p1:LineIndex>421</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>423</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bSecure</d1p1:Content>
                    <d1p1:LineIndex>423</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>423</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>424</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>424</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Site</d1p1:Content>
                        <d1p1:LineIndex>424</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>424</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>SecureHostName</d1p1:Content>
                        <d1p1:LineIndex>424</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl</d1p1:Content>
                        <d1p1:LineIndex>424</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>URL</d1p1:Content>
                      <d1p1:LineIndex>426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>FullHostName</d1p1:Content>
                      <d1p1:LineIndex>426</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strPostUrl</d1p1:Content>
                      <d1p1:LineIndex>426</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DoBlock">
          <d1p1:ConditionIfAny>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Right</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPostUrl</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                <d1p1:Content>=</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>/</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>428</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ConditionIfAny>
          <d1p1:IsDoWhileCondition>true</d1p1:IsDoWhileCondition>
          <d1p1:IsPreCondition>true</d1p1:IsPreCondition>
          <d1p1:LineIndexOfStartOfConstruct>428</d1p1:LineIndexOfStartOfConstruct>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Left</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Len</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>-</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl</d1p1:Content>
                    <d1p1:LineIndex>429</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
          </d1p1:Statements>
          <d1p1:SupportsExit>true</d1p1:SupportsExit>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>PageInfo</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetUrlFromPageID</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>BOOKONLINE</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strUrl</d1p1:Content>
                <d1p1:LineIndex>432</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>433</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>433</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strUrl</d1p1:Content>
                    <d1p1:LineIndex>433</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>433</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>434</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>434</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                      <d1p1:LineIndex>434</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>GetPostUrl: Unable to locate page BOOKONLINE, default to current page - is this correct behaviour??</d1p1:Content>
                      <d1p1:LineIndex>434</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>435</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>435</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>URL</d1p1:Content>
                        <d1p1:LineIndex>435</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>435</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Real</d1p1:Content>
                        <d1p1:LineIndex>435</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strURL</d1p1:Content>
                        <d1p1:LineIndex>435</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Left</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strUrl</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>/</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>438</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>/</d1p1:Content>
                        <d1p1:LineIndex>439</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>439</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strUrl</d1p1:Content>
                        <d1p1:LineIndex>439</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strUrl</d1p1:Content>
                        <d1p1:LineIndex>439</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPostUrl</d1p1:Content>
                <d1p1:LineIndex>442</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>442</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strUrl</d1p1:Content>
                <d1p1:LineIndex>442</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPostUrl</d1p1:Content>
                <d1p1:LineIndex>442</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>UCase</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Left</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>7</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>HTTP://</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>UCase</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Left</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>8</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>HTTPS://</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>443</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>http://</d1p1:Content>
                        <d1p1:LineIndex>444</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>444</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl</d1p1:Content>
                        <d1p1:LineIndex>444</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl</d1p1:Content>
                        <d1p1:LineIndex>444</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPostUrl</d1p1:Content>
                <d1p1:LineIndex>447</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetPostUrl</d1p1:Content>
                <d1p1:LineIndex>447</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: render new requirement UI from avail calendar</d1p1:Content>
      <d1p1:LineIndex>452</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [ireqSz]: ADO unit recordset from availability object</d1p1:Content>
      <d1p1:LineIndex>453</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiStayNum]: integer stay index</d1p1:Content>
      <d1p1:LineIndex>454</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiThisReqmnt]: integer requirement number (from recordset)</d1p1:Content>
      <d1p1:LineIndex>455</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderNewReq_AvailCal</d1p1:Content>
        <d1p1:LineIndex>456</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intBookingType</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iUnitKey</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strUnitName</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>asAvailClassId</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiStayNum</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiThisReqmnt</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>456</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> on first ever call [aiThisReqmnt]=1, on subsequent calls we must close previous [pnStayReqmnt] and [pnStayReqmntRslts] DIVs</d1p1:Content>
          <d1p1:LineIndex>457</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iGuest</d1p1:Content>
                <d1p1:LineIndex>458</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>aiThisReqmnt</d1p1:Content>
                    <d1p1:LineIndex>460</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>460</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>460</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>461</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>461</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>461</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>461</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>464</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>464</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>464</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnStayReqmnt"&gt;</d1p1:Content>
              <d1p1:LineIndex>464</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>464</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>464</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>465</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>465</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>465</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnStayReqmntTtl"&gt;</d1p1:Content>
              <d1p1:LineIndex>465</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>465</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>465</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div Class="pnStayReqmntRoom"&gt;Room </d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiThisReqmnt</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> - </d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strUnitName</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>asAvailClassId</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> &lt;br/&gt;&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>466</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>468</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>469</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                        <d1p1:LineIndex>469</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>472</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>472</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>472</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div Class="pnStayReqmntGuests"&gt;</d1p1:Content>
              <d1p1:LineIndex>472</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>472</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>472</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                    <d1p1:LineIndex>473</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>473</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                    <d1p1:LineIndex>473</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>For </d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> guests &lt;input type="hidden" name="roomReq_</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" value="</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>"/&gt;</d1p1:Content>
                      <d1p1:LineIndex>474</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:DimStatement">
                <d1p1:Variables>
                  <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                    <d1p1:Dimensions i:nil="true" />
                    <d1p1:Name>
                      <d1p1:Content>strGuestsFor</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d1p1:Name>
                  </d1p1:DimVariable>
                </d1p1:Variables>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/guestrequirement/for</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>for</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strGuestsFor</d1p1:Content>
                      <d1p1:LineIndex>476</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content>alas child pricing is different</d1p1:Content>
                <d1p1:LineIndex>477</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:IfBlock">
                <d1p1:ConditionalClauses>
                  <d1p1:IfBlock.IfBlockConditionSegment>
                    <d1p1:Condition>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Page</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Site</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Params</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>Booking_ChildPricing</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>478</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Condition>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>strAdultsTitle</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/guestrequirement/adults/selecttitle</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>Please specify the number of adults in this room.</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strAdultsTitle</d1p1:Content>
                              <d1p1:LineIndex>480</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>strAdults</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/guestrequirement/adults/adult(s)</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>adult(s)</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strAdults</d1p1:Content>
                              <d1p1:LineIndex>481</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strGuestsFor</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> &lt;select class="adults" name="roomReq_</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>aiThisReqmnt</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>_adults" title="</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strAdultsTitle</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>"&gt; </d1p1:Content>
                            <d1p1:LineIndex>483</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ForBlock">
                        <d1p1:LoopFrom>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                              <d1p1:LineIndex>484</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopFrom>
                        <d1p1:LoopStep i:nil="true" />
                        <d1p1:LoopTo>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                              <d1p1:LineIndex>484</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopTo>
                        <d1p1:LoopVar>
                          <d1p1:Content>iGuest</d1p1:Content>
                          <d1p1:LineIndex>484</d1p1:LineIndex>
                        </d1p1:LoopVar>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Write</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;option value="</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iGuest</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>"&gt;</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iGuest</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;/option&gt; </d1p1:Content>
                                <d1p1:LineIndex>485</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>487</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>487</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>487</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;/select&gt; </d1p1:Content>
                            <d1p1:LineIndex>487</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>487</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strAdults</d1p1:Content>
                            <d1p1:LineIndex>487</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>strChildrenTitle</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/guestrequirement/children/selecttitle</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>Please specify the number of children in this room.</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strChildrenTitle</d1p1:Content>
                              <d1p1:LineIndex>489</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>strChildren</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/guestrequirement/children/children</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>children</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strChildren</d1p1:Content>
                              <d1p1:LineIndex>490</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>strGuestsAnd</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>and</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>and</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>strGuestsAnd</d1p1:Content>
                              <d1p1:LineIndex>491</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> </d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strGuestsAnd</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> &lt;select class="children" name="roomReq_</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>aiThisReqmnt</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>_children" title="</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strChildrenTitle</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>"&gt; </d1p1:Content>
                            <d1p1:LineIndex>492</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:ForBlock">
                        <d1p1:LoopFrom>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>0</d1p1:Content>
                              <d1p1:LineIndex>494</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopFrom>
                        <d1p1:LoopStep i:nil="true" />
                        <d1p1:LoopTo>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                              <d1p1:LineIndex>494</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>-</d1p1:Content>
                              <d1p1:LineIndex>494</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>1</d1p1:Content>
                              <d1p1:LineIndex>494</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopTo>
                        <d1p1:LoopVar>
                          <d1p1:Content>iGuest</d1p1:Content>
                          <d1p1:LineIndex>494</d1p1:LineIndex>
                        </d1p1:LoopVar>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Write</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;option value="</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iGuest</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>"&gt;</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iGuest</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;/option&gt; </d1p1:Content>
                                <d1p1:LineIndex>495</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>497</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>497</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>497</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;/select&gt; </d1p1:Content>
                            <d1p1:LineIndex>497</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>497</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strChildren</d1p1:Content>
                            <d1p1:LineIndex>497</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>iCount</d1p1:Content>
                              <d1p1:LineIndex>499</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>500</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>500</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>WriteLine</d1p1:Content>
                            <d1p1:LineIndex>500</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;span class="label childrenageslabel"&gt;Child Ages&lt;/span&gt;</d1p1:Content>
                            <d1p1:LineIndex>500</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>501</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>501</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>WriteLine</d1p1:Content>
                            <d1p1:LineIndex>501</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;span class="field childrenagesfield"&gt;</d1p1:Content>
                            <d1p1:LineIndex>501</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:DimStatement">
                        <d1p1:Variables>
                          <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                            <d1p1:Dimensions i:nil="true" />
                            <d1p1:Name>
                              <d1p1:Content>ageValue</d1p1:Content>
                              <d1p1:LineIndex>503</d1p1:LineIndex>
                            </d1p1:Name>
                          </d1p1:DimVariable>
                        </d1p1:Variables>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ForBlock">
                        <d1p1:LoopFrom>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>0</d1p1:Content>
                              <d1p1:LineIndex>504</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopFrom>
                        <d1p1:LoopStep i:nil="true" />
                        <d1p1:LoopTo>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>504</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                              <d1p1:LineIndex>504</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>-</d1p1:Content>
                              <d1p1:LineIndex>504</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>1</d1p1:Content>
                              <d1p1:LineIndex>504</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>504</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopTo>
                        <d1p1:LoopVar>
                          <d1p1:Content>iCount</d1p1:Content>
                          <d1p1:LineIndex>504</d1p1:LineIndex>
                        </d1p1:LoopVar>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>505</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>505</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>WriteLine</d1p1:Content>
                                <d1p1:LineIndex>505</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;span class="childageWrapper"&gt;</d1p1:Content>
                                <d1p1:LineIndex>505</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>WriteLine</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                <d1p1:Content>vbTab</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                                <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;span class="label childagelabel"&gt;Child Age </d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iCount</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>+</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>1</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                                <d1p1:LineIndex>506</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>507</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>507</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>WriteLine</d1p1:Content>
                                <d1p1:LineIndex>507</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                <d1p1:Content>vbTab</d1p1:Content>
                                <d1p1:LineIndex>507</d1p1:LineIndex>
                                <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>507</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;span class="field childagefield"&gt;</d1p1:Content>
                                <d1p1:LineIndex>507</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Write</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;select class="" name="roomReq_</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>aiThisReqmnt</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>_children_childage</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iCount</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>"&gt;</d1p1:Content>
                                <d1p1:LineIndex>508</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ForBlock">
                            <d1p1:LoopFrom>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NumericValueToken">
                                  <d1p1:Content>0</d1p1:Content>
                                  <d1p1:LineIndex>509</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:LoopFrom>
                            <d1p1:LoopStep i:nil="true" />
                            <d1p1:LoopTo>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NumericValueToken">
                                  <d1p1:Content>18</d1p1:Content>
                                  <d1p1:LineIndex>509</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:LoopTo>
                            <d1p1:LoopVar>
                              <d1p1:Content>iGuest</d1p1:Content>
                              <d1p1:LineIndex>509</d1p1:LineIndex>
                            </d1p1:LoopVar>
                            <d1p1:Statements>
                              <d2p1:anyType i:type="d1p1:Statement">
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>pO</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Write</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>&lt;option value="</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iGuest</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>"&gt;</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iGuest</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>&lt;/option&gt; </d1p1:Content>
                                    <d1p1:LineIndex>510</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d2p1:anyType>
                            </d1p1:Statements>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>512</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>512</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Write</d1p1:Content>
                                <d1p1:LineIndex>512</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;/select&gt; </d1p1:Content>
                                <d1p1:LineIndex>512</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>513</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>513</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>WriteLine</d1p1:Content>
                                <d1p1:LineIndex>513</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                <d1p1:Content>vbTab</d1p1:Content>
                                <d1p1:LineIndex>513</d1p1:LineIndex>
                                <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>513</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                                <d1p1:LineIndex>513</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>pO</d1p1:Content>
                                <d1p1:LineIndex>514</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>514</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>WriteLine</d1p1:Content>
                                <d1p1:LineIndex>514</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                                <d1p1:LineIndex>514</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>516</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>516</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>WriteLine</d1p1:Content>
                            <d1p1:LineIndex>516</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                            <d1p1:LineIndex>516</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:IfBlock.IfBlockConditionSegment>
                </d1p1:ConditionalClauses>
                <d1p1:OptionalElseClause>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:DimStatement">
                      <d1p1:Variables>
                        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                          <d1p1:Dimensions i:nil="true" />
                          <d1p1:Name>
                            <d1p1:Content>strGuestsTitle</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d1p1:Name>
                        </d1p1:DimVariable>
                      </d1p1:Variables>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Resource</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>bookonline/unitselection/guestrequirement/selecttitle</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>Please specify the number of guests in this room.</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strGuestsTitle</d1p1:Content>
                            <d1p1:LineIndex>518</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:DimStatement">
                      <d1p1:Variables>
                        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                          <d1p1:Dimensions i:nil="true" />
                          <d1p1:Name>
                            <d1p1:Content>strGuests</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d1p1:Name>
                        </d1p1:DimVariable>
                      </d1p1:Variables>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Resource</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>bookonline/unitselection/guestrequirement/guest(s)</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>guest(s)</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strGuests</d1p1:Content>
                            <d1p1:LineIndex>519</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strGuestsFor</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content> &lt;select name="roomReq_</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>aiThisReqmnt</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>" title="</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strGuestsTitle</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>"&gt; </d1p1:Content>
                          <d1p1:LineIndex>521</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ForBlock">
                      <d1p1:LoopFrom>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitMinOccupancy</d1p1:Content>
                            <d1p1:LineIndex>522</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:LoopFrom>
                      <d1p1:LoopStep i:nil="true" />
                      <d1p1:LoopTo>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitMaxCapacity</d1p1:Content>
                            <d1p1:LineIndex>522</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:LoopTo>
                      <d1p1:LoopVar>
                        <d1p1:Content>iGuest</d1p1:Content>
                        <d1p1:LineIndex>522</d1p1:LineIndex>
                      </d1p1:LoopVar>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;option value="</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iGuest</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>"&gt;</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iGuest</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;/option&gt; </d1p1:Content>
                              <d1p1:LineIndex>523</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>525</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>525</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>525</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/select&gt; </d1p1:Content>
                          <d1p1:LineIndex>525</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>525</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strGuests</d1p1:Content>
                          <d1p1:LineIndex>525</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:OptionalElseClause>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>528</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>528</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>528</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>528</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>528</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>528</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intBookingType</d1p1:Content>
                    <d1p1:LineIndex>530</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>530</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>ticketing</d1p1:Content>
                    <d1p1:LineIndex>530</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="unit_</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iUnitKey</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>"  value="</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>531</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>pO</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Write</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>&lt;input type="hidden" name="unit_</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>aiStayNum</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>_</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>aiThisReqmnt</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>"  value="</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iUnitKey</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>" /&gt;</d1p1:Content>
                    <d1p1:LineIndex>533</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: Draw availability month calendar</d1p1:Content>
      <d1p1:LineIndex>539</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [sbCalendars]:  ASP [nmStringBuilder] object instance output string</d1p1:Content>
      <d1p1:LineIndex>540</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [dCalStartDflt]: date default calendar start date</d1p1:Content>
      <d1p1:LineIndex>541</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: string month available stays details JSON data</d1p1:Content>
      <d1p1:LineIndex>542</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderAvailCal</d1p1:Content>
        <d1p1:LineIndex>543</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>sbCalendars</d1p1:Content>
            <d1p1:LineIndex>543</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objDictAvaiStays</d1p1:Content>
            <d1p1:LineIndex>543</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bStarted</d1p1:Content>
            <d1p1:LineIndex>543</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strClassMonth</d1p1:Content>
                <d1p1:LineIndex>545</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>MonthWrapper</d1p1:Content>
                <d1p1:LineIndex>545</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strClassMonth</d1p1:Content>
                <d1p1:LineIndex>545</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>546</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bStarted</d1p1:Content>
                    <d1p1:LineIndex>546</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>sbCalendars</d1p1:Content>
                      <d1p1:LineIndex>547</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>547</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>AppendLine</d1p1:Content>
                      <d1p1:LineIndex>547</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>547</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="CalendarsWrapper"&gt;</d1p1:Content>
                      <d1p1:LineIndex>547</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>547</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>sbCalendars</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>AppendLine</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="instruction"&gt;</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/availcalendar/instruction</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Please select an available stay from the calendars below. Clicking on a highlighted start day for a stay will show the stay details such as the units available, price, etc.</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>548</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strClassMonth</d1p1:Content>
                        <d1p1:LineIndex>549</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>549</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content> currentmonth</d1p1:Content>
                        <d1p1:LineIndex>549</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strClassMonth</d1p1:Content>
                        <d1p1:LineIndex>549</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strClassMonth</d1p1:Content>
                      <d1p1:LineIndex>551</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>551</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> nextmonth</d1p1:Content>
                      <d1p1:LineIndex>551</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strClassMonth</d1p1:Content>
                      <d1p1:LineIndex>551</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dStart1</d1p1:Content>
                <d1p1:LineIndex>554</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>aryAvailStaysKeys</d1p1:Content>
                <d1p1:LineIndex>554</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objDictAvaiStays</d1p1:Content>
                    <d1p1:LineIndex>555</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>555</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>555</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>555</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>555</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objDictAvaiStays</d1p1:Content>
                        <d1p1:LineIndex>556</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>556</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Keys</d1p1:Content>
                        <d1p1:LineIndex>556</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aryAvailStaysKeys</d1p1:Content>
                        <d1p1:LineIndex>556</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Replace</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aryAvailStaysKeys</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>sd_</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content></d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dStart1</d1p1:Content>
                        <d1p1:LineIndex>557</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:EraseStatement">
                  <d1p1:KeywordLineIndex>558</d1p1:KeywordLineIndex>
                  <d1p1:Targets>
                    <d1p1:EraseStatement.TargetDetails>
                      <d1p1:ArgumentsIfAny i:nil="true" />
                      <d1p1:Target>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>aryAvailStaysKeys</d1p1:Content>
                            <d1p1:LineIndex>558</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Target>
                      <d1p1:WrappedInBraces>false</d1p1:WrappedInBraces>
                    </d1p1:EraseStatement.TargetDetails>
                  </d1p1:Targets>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                      <d1p1:Content>Date</d1p1:Content>
                      <d1p1:LineIndex>560</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>560</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>560</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>dStart1</d1p1:Content>
                      <d1p1:LineIndex>560</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_RenderCalendarMonthWithAvailability</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>dStart1</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strClassMonth</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objDictAvaiStays</d1p1:Content>
              <d1p1:LineIndex>563</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> using a global count so we can track how many calendars have been added to the stringbuilder for the prev/next buttons</d1p1:Content>
          <d1p1:LineIndex>565</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> doing this now because of the recursive nature of this function</d1p1:Content>
          <d1p1:LineIndex>566</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
                <d1p1:LineIndex>567</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>+</d1p1:Content>
                <d1p1:LineIndex>567</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>567</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
                <d1p1:LineIndex>567</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>Check if we have stays left and render then as another calendar</d1p1:Content>
          <d1p1:LineIndex>569</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objDictAvaiStays</d1p1:Content>
                    <d1p1:LineIndex>570</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>570</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>570</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>570</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>570</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderAvailCal</d1p1:Content>
                      <d1p1:LineIndex>571</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>sbCalendars</d1p1:Content>
                      <d1p1:LineIndex>571</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>571</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objDictAvaiStays</d1p1:Content>
                      <d1p1:LineIndex>571</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>571</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>True</d1p1:Content>
                      <d1p1:LineIndex>571</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content>not sure if this should be dStart1 - was dStart</d1p1:Content>
                <d1p1:LineIndex>573</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingUI_RenderAvailCalLinks</d1p1:Content>
                    <d1p1:LineIndex>574</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dStart1</d1p1:Content>
                    <d1p1:LineIndex>574</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>574</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sbCalendars</d1p1:Content>
                    <d1p1:LineIndex>574</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingUI_RenderAvailCalKey</d1p1:Content>
                    <d1p1:LineIndex>575</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sbCalendars</d1p1:Content>
                    <d1p1:LineIndex>575</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sbCalendars</d1p1:Content>
                    <d1p1:LineIndex>576</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>576</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>AppendLine</d1p1:Content>
                    <d1p1:LineIndex>576</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>576</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                    <d1p1:LineIndex>576</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>576</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BlankLine" />
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderCalendarMonth</d1p1:Content>
        <d1p1:LineIndex>582</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>sbCalendars</d1p1:Content>
            <d1p1:LineIndex>582</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>dFirstDayOfMonth</d1p1:Content>
            <d1p1:LineIndex>582</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strWrapperClass</d1p1:Content>
            <d1p1:LineIndex>582</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_RenderCalendarMonthWithAvailability</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>dFirstDayOfMonth</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strWrapperClass</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Nothing</d1p1:Content>
              <d1p1:LineIndex>583</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderCalendarMonthWithAvailability</d1p1:Content>
        <d1p1:LineIndex>586</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>sbCalendars</d1p1:Content>
            <d1p1:LineIndex>586</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>dFirstDayOfMonth</d1p1:Content>
            <d1p1:LineIndex>586</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strWrapperClass</d1p1:Content>
            <d1p1:LineIndex>586</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objDictAvailStays</d1p1:Content>
            <d1p1:LineIndex>586</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iWeekStartDay</d1p1:Content>
                <d1p1:LineIndex>588</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>588</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekStartDay</d1p1:Content>
                <d1p1:LineIndex>588</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:InlineCommentStatement">
          <d1p1:Content>Monday</d1p1:Content>
          <d1p1:LineIndex>588</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iWeekDayCalStart</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekStartDay</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>+</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>Mod</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>7</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekDayCalStart</d1p1:Content>
                <d1p1:LineIndex>589</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iWeekDayCalEnd</d1p1:Content>
                <d1p1:LineIndex>590</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekStartDay</d1p1:Content>
                <d1p1:LineIndex>590</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>Mod</d1p1:Content>
                <d1p1:LineIndex>590</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>7</d1p1:Content>
                <d1p1:LineIndex>590</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekDayCalEnd</d1p1:Content>
                <d1p1:LineIndex>590</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dCalStart</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>fn_GetFirstDateOfMonth</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dFirstDayOfMonth</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStart</d1p1:Content>
                <d1p1:LineIndex>592</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dCalEnd</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>fn_GetLastDateOfMonth</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dFirstDayOfMonth</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalEnd</d1p1:Content>
                <d1p1:LineIndex>593</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strThisMonthYear</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetMonthNameAbbr</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Month</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStart</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content> </d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Year</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStart</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strThisMonthYear</d1p1:Content>
                <d1p1:LineIndex>594</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strTableSummary</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/availcalendar/availabilitycalendarfor</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>Availability calendar for</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content> </d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strThisMonthYear</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strTableSummary</d1p1:Content>
                <d1p1:LineIndex>595</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div id="Cal_</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Functions</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Dates</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>ISODate</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>dCalStart</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" class="</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strWrapperClass</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>"&gt;</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>597</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;table id="Tbl_</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Functions</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Dates</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>ISODate</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>dCalStart</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" class="availabilityCalendar" summary="</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strTableSummary</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" &gt;</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>598</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>599</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>599</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>599</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>599</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;thead&gt;</d1p1:Content>
              <d1p1:LineIndex>599</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>599</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>600</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>600</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>600</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>600</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;tr&gt;</d1p1:Content>
              <d1p1:LineIndex>600</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>600</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;th colspan="8"&gt;</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strThisMonthYear</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/th&gt;</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>601</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>602</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>602</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>602</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>602</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
              <d1p1:LineIndex>602</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>602</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strHeaderCellClass</d1p1:Content>
                <d1p1:LineIndex>604</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content></d1p1:Content>
                <d1p1:LineIndex>604</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strHeaderCellClass</d1p1:Content>
                <d1p1:LineIndex>604</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>i</d1p1:Content>
                <d1p1:LineIndex>605</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekStartDay</d1p1:Content>
                <d1p1:LineIndex>605</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iWeekStartDay</d1p1:Content>
                <d1p1:LineIndex>605</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>+</d1p1:Content>
                <d1p1:LineIndex>605</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>6</d1p1:Content>
                <d1p1:LineIndex>605</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>i</d1p1:Content>
            <d1p1:LineIndex>605</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>i</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>Mod</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>7</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>6</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>or</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>i</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>Mod</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>7</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>606</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> class="we"</d1p1:Content>
                            <d1p1:LineIndex>607</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strHeaderCellClass</d1p1:Content>
                            <d1p1:LineIndex>607</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:Statement">
              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
              <d1p1:Tokens>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>sbCalendars</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>AppendLine</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OpenBrace">
                  <d1p1:Content>(</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:StringToken">
                  <d1p1:Content>&lt;th</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>strHeaderCellClass</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:StringToken">
                  <d1p1:Content>&gt;</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>Page</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>Functions</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>Dates</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>GetDayNameAbbr</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OpenBrace">
                  <d1p1:Content>(</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                  <d1p1:Content>Weekday</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OpenBrace">
                  <d1p1:Content>(</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OpenBrace">
                  <d1p1:Content>(</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>i</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>+</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NumericValueToken">
                  <d1p1:Content>1</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CloseBrace">
                  <d1p1:Content>)</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>Mod</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NumericValueToken">
                  <d1p1:Content>7</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CloseBrace">
                  <d1p1:Content>)</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CloseBrace">
                  <d1p1:Content>)</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:StringToken">
                  <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CloseBrace">
                  <d1p1:Content>)</d1p1:Content>
                  <d1p1:LineIndex>609</d1p1:LineIndex>
                </d2p1:anyType>
              </d1p1:Tokens>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>612</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>612</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>612</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>612</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
              <d1p1:LineIndex>612</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>612</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>613</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>613</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>613</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>613</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/thead&gt;</d1p1:Content>
              <d1p1:LineIndex>613</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>613</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>614</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>614</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>614</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>614</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;tbody&gt;</d1p1:Content>
              <d1p1:LineIndex>614</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>614</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iCellCount</d1p1:Content>
                <d1p1:LineIndex>616</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>616</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iCellCount</d1p1:Content>
                <d1p1:LineIndex>616</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bFirstCell</d1p1:Content>
                <d1p1:LineIndex>617</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>True</d1p1:Content>
                <d1p1:LineIndex>617</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bFirstCell</d1p1:Content>
                <d1p1:LineIndex>617</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bLastCell</d1p1:Content>
                <d1p1:LineIndex>618</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>618</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bLastCell</d1p1:Content>
                <d1p1:LineIndex>618</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dDate</d1p1:Content>
                <d1p1:LineIndex>620</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStart</d1p1:Content>
                <d1p1:LineIndex>620</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dDate</d1p1:Content>
                <d1p1:LineIndex>620</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bStartNewStay</d1p1:Content>
                <d1p1:LineIndex>622</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bStayIndicative</d1p1:Content>
                <d1p1:LineIndex>622</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strStayNumber</d1p1:Content>
                <d1p1:LineIndex>623</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iDay</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Day</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStart</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Day</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalEnd</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>625</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>iDay</d1p1:Content>
            <d1p1:LineIndex>625</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>False</d1p1:Content>
                    <d1p1:LineIndex>626</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bStartNewStay</d1p1:Content>
                    <d1p1:LineIndex>626</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bFirstCell</d1p1:Content>
                        <d1p1:LineIndex>628</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:DimStatement">
                      <d1p1:Variables>
                        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                          <d1p1:Dimensions i:nil="true" />
                          <d1p1:Name>
                            <d1p1:Content>iPrePadding</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d1p1:Name>
                        </d1p1:DimVariable>
                      </d1p1:Variables>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>DateDiff</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>d</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Functions</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Dates</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>fn_GetFirstDateOfWeek</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Functions</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Dates</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>fn_GetFirstDateOfMonth</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>dCalStart</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iWeekDayCalStart</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>dCalStart</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iPrePadding</d1p1:Content>
                            <d1p1:LineIndex>629</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iPrePadding</d1p1:Content>
                                <d1p1:LineIndex>630</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>&gt;</d1p1:Content>
                                <d1p1:LineIndex>630</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>0</d1p1:Content>
                                <d1p1:LineIndex>630</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:DimStatement">
                              <d1p1:Variables>
                                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                                  <d1p1:Dimensions i:nil="true" />
                                  <d1p1:Name>
                                    <d1p1:Content>j</d1p1:Content>
                                    <d1p1:LineIndex>631</d1p1:LineIndex>
                                  </d1p1:Name>
                                </d1p1:DimVariable>
                              </d1p1:Variables>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ForBlock">
                              <d1p1:LoopFrom>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>1</d1p1:Content>
                                    <d1p1:LineIndex>631</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:LoopFrom>
                              <d1p1:LoopStep i:nil="true" />
                              <d1p1:LoopTo>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iPrePadding</d1p1:Content>
                                    <d1p1:LineIndex>631</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:LoopTo>
                              <d1p1:LoopVar>
                                <d1p1:Content>j</d1p1:Content>
                                <d1p1:LineIndex>631</d1p1:LineIndex>
                              </d1p1:LoopVar>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:Statement">
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>sbCalendars</d1p1:Content>
                                      <d1p1:LineIndex>632</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>632</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>AppendLine</d1p1:Content>
                                      <d1p1:LineIndex>632</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:OpenBrace">
                                      <d1p1:Content>(</d1p1:Content>
                                      <d1p1:LineIndex>632</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>&lt;td&gt;&lt;/td&gt;</d1p1:Content>
                                      <d1p1:LineIndex>632</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CloseBrace">
                                      <d1p1:Content>)</d1p1:Content>
                                      <d1p1:LineIndex>632</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                  <d1p1:Expression>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iCellCount</d1p1:Content>
                                        <d1p1:LineIndex>633</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OperatorToken">
                                        <d1p1:Content>+</d1p1:Content>
                                        <d1p1:LineIndex>633</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                                        <d1p1:Content>1</d1p1:Content>
                                        <d1p1:LineIndex>633</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Expression>
                                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                  <d1p1:ValueToSet>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iCellCount</d1p1:Content>
                                        <d1p1:LineIndex>633</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:ValueToSet>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>False</d1p1:Content>
                            <d1p1:LineIndex>636</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bFirstCell</d1p1:Content>
                            <d1p1:LineIndex>636</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:DimStatement">
              <d1p1:Variables>
                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                  <d1p1:Dimensions i:nil="true" />
                  <d1p1:Name>
                    <d1p1:Content>strDisplayText</d1p1:Content>
                    <d1p1:LineIndex>639</d1p1:LineIndex>
                  </d1p1:Name>
                </d1p1:DimVariable>
              </d1p1:Variables>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>639</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>639</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iDay</d1p1:Content>
                    <d1p1:LineIndex>639</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strDisplayText</d1p1:Content>
                    <d1p1:LineIndex>639</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:DimStatement">
              <d1p1:Variables>
                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                  <d1p1:Dimensions i:nil="true" />
                  <d1p1:Name>
                    <d1p1:Content>strDayCellClass</d1p1:Content>
                    <d1p1:LineIndex>640</d1p1:LineIndex>
                  </d1p1:Name>
                </d1p1:DimVariable>
              </d1p1:Variables>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>n</d1p1:Content>
                    <d1p1:LineIndex>640</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strDayCellClass</d1p1:Content>
                    <d1p1:LineIndex>640</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>642</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objDictAvailStays</d1p1:Content>
                        <d1p1:LineIndex>642</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>Is</d1p1:Content>
                        <d1p1:LineIndex>642</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>Nothing</d1p1:Content>
                        <d1p1:LineIndex>642</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objDictAvailStays</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Exists</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>sd_</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>dDate</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>643</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                    <d1p1:Content>True</d1p1:Content>
                                    <d1p1:LineIndex>644</d1p1:LineIndex>
                                    <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>bStartNewStay</d1p1:Content>
                                    <d1p1:LineIndex>644</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CommentStatement">
                              <d1p1:Content>we expect value in the format [stayNo]_[indicative]</d1p1:Content>
                              <d1p1:LineIndex>645</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:DimStatement">
                              <d1p1:Variables>
                                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                                  <d1p1:Dimensions i:nil="true" />
                                  <d1p1:Name>
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d1p1:Name>
                                </d1p1:DimVariable>
                              </d1p1:Variables>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Split</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objDictAvailStays</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>sd_</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>dDate</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>_</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>646</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>647</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>647</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>0</d1p1:Content>
                                    <d1p1:LineIndex>647</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>647</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strStayNumber</d1p1:Content>
                                    <d1p1:LineIndex>647</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>CBool</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>1</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>bStayIndicative</d1p1:Content>
                                    <d1p1:LineIndex>648</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:Statement">
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>objDictAvailStays</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                  <d1p1:Content>.</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>Remove</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OpenBrace">
                                  <d1p1:Content>(</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:StringToken">
                                  <d1p1:Content>sd_</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OperatorToken">
                                  <d1p1:Content>&amp;</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>dDate</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:CloseBrace">
                                  <d1p1:Content>)</d1p1:Content>
                                  <d1p1:LineIndex>649</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:EraseStatement">
                              <d1p1:KeywordLineIndex>650</d1p1:KeywordLineIndex>
                              <d1p1:Targets>
                                <d1p1:EraseStatement.TargetDetails>
                                  <d1p1:ArgumentsIfAny i:nil="true" />
                                  <d1p1:Target>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>aryStay</d1p1:Content>
                                        <d1p1:LineIndex>650</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Target>
                                  <d1p1:WrappedInBraces>false</d1p1:WrappedInBraces>
                                </d1p1:EraseStatement.TargetDetails>
                              </d1p1:Targets>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dDate</d1p1:Content>
                        <d1p1:LineIndex>654</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&lt;</d1p1:Content>
                        <d1p1:LineIndex>654</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Date</d1p1:Content>
                        <d1p1:LineIndex>654</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>654</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>654</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:InlineCommentStatement">
                      <d1p1:Content>date is in the past</d1p1:Content>
                      <d1p1:LineIndex>654</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>p</d1p1:Content>
                            <d1p1:LineIndex>656</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strDayCellClass</d1p1:Content>
                            <d1p1:LineIndex>656</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bStartNewStay</d1p1:Content>
                        <d1p1:LineIndex>658</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                <d1p1:Content>Not</d1p1:Content>
                                <d1p1:LineIndex>660</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objDictAvailStays</d1p1:Content>
                                <d1p1:LineIndex>660</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>Is</d1p1:Content>
                                <d1p1:LineIndex>660</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                <d1p1:Content>Nothing</d1p1:Content>
                                <d1p1:LineIndex>660</d1p1:LineIndex>
                                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:DimStatement">
                              <d1p1:Variables>
                                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                                  <d1p1:Dimensions i:nil="true" />
                                  <d1p1:Name>
                                    <d1p1:Content>strAvailType</d1p1:Content>
                                    <d1p1:LineIndex>661</d1p1:LineIndex>
                                  </d1p1:Name>
                                </d1p1:DimVariable>
                              </d1p1:Variables>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content></d1p1:Content>
                                    <d1p1:LineIndex>661</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strAvailType</d1p1:Content>
                                    <d1p1:LineIndex>661</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:DimStatement">
                              <d1p1:Variables>
                                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                                  <d1p1:Dimensions i:nil="true" />
                                  <d1p1:Name>
                                    <d1p1:Content>strIndicativeIcon</d1p1:Content>
                                    <d1p1:LineIndex>662</d1p1:LineIndex>
                                  </d1p1:Name>
                                </d1p1:DimVariable>
                              </d1p1:Variables>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content></d1p1:Content>
                                    <d1p1:LineIndex>662</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strIndicativeIcon</d1p1:Content>
                                    <d1p1:LineIndex>662</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:BlankLine" />
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>bStayIndicative</d1p1:Content>
                                        <d1p1:LineIndex>664</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>i</d1p1:Content>
                                            <d1p1:LineIndex>665</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strDayCellClass</d1p1:Content>
                                            <d1p1:LineIndex>665</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>Page</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                            <d1p1:Content>.</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>Resource</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OpenBrace">
                                            <d1p1:Content>(</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>bookonline/unitselection/unconfirmedavailability</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                            <d1p1:Content>,</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>Unconfirmed Availability</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:CloseBrace">
                                            <d1p1:Content>)</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strAvailType</d1p1:Content>
                                            <d1p1:LineIndex>666</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>&lt;img src="</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OperatorToken">
                                            <d1p1:Content>&amp;</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>Page</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                            <d1p1:Content>.</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>ImageResource</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OpenBrace">
                                            <d1p1:Content>(</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>bookonline/icons/indicative</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                            <d1p1:Content>,</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>/images/icon_indicative.gif</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:CloseBrace">
                                            <d1p1:Content>)</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OperatorToken">
                                            <d1p1:Content>&amp;</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>" alt="</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OperatorToken">
                                            <d1p1:Content>&amp;</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strAvailType</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OperatorToken">
                                            <d1p1:Content>&amp;</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>" class="icon"/&gt;</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strIndicativeIcon</d1p1:Content>
                                            <d1p1:LineIndex>667</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause>
                                <d1p1:Statements>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>a</d1p1:Content>
                                          <d1p1:LineIndex>669</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strDayCellClass</d1p1:Content>
                                          <d1p1:LineIndex>669</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Page</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Resource</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>bookonline/unitselection/confirmedavailability</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>Confirmed Availability</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strAvailType</d1p1:Content>
                                          <d1p1:LineIndex>670</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>&lt;img src="</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Page</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>ImageResource</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>bookonline/icons/allocated</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>/images/icon_allocated.gif</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>" alt="</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strAvailType</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>" class="icon"/&gt;</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strIndicativeIcon</d1p1:Content>
                                          <d1p1:LineIndex>671</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                </d1p1:Statements>
                              </d1p1:OptionalElseClause>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:BlankLine" />
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>&lt;a href="#stay_</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strStayNumber</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>" class="calavailstay" id="stay_</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strStayNumber</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>"&gt;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Day</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>dDate</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>&lt;/a&gt;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strIndicativeIcon</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strDisplayText</d1p1:Content>
                                    <d1p1:LineIndex>674</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:BlankLine" />
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Weekday</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dDate</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>or</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Weekday</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dDate</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>7</d1p1:Content>
                        <d1p1:LineIndex>680</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strDayCellClass</d1p1:Content>
                            <d1p1:LineIndex>681</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>681</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> we</d1p1:Content>
                            <d1p1:LineIndex>681</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strDayCellClass</d1p1:Content>
                            <d1p1:LineIndex>681</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:Statement">
              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
              <d1p1:Tokens>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>sbCalendars</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>AppendLine</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OpenBrace">
                  <d1p1:Content>(</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:StringToken">
                  <d1p1:Content>&lt;td class="</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>strDayCellClass</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:StringToken">
                  <d1p1:Content>"&gt;&lt;div&gt;</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>strDisplayText</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OperatorToken">
                  <d1p1:Content>&amp;</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:StringToken">
                  <d1p1:Content>&lt;/div&gt;&lt;/td&gt;</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CloseBrace">
                  <d1p1:Content>)</d1p1:Content>
                  <d1p1:LineIndex>684</d1p1:LineIndex>
                </d2p1:anyType>
              </d1p1:Tokens>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iCellCount</d1p1:Content>
                    <d1p1:LineIndex>686</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>+</d1p1:Content>
                    <d1p1:LineIndex>686</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>686</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iCellCount</d1p1:Content>
                    <d1p1:LineIndex>686</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dDate</d1p1:Content>
                        <d1p1:LineIndex>688</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>688</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dCalEnd</d1p1:Content>
                        <d1p1:LineIndex>688</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>689</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bLastCell</d1p1:Content>
                            <d1p1:LineIndex>689</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> This is for when the last day of the month is not the last day of the week and empty cells are put in place to fill the calendar days</d1p1:Content>
              <d1p1:LineIndex>692</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bLastCell</d1p1:Content>
                        <d1p1:LineIndex>693</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:DimStatement">
                      <d1p1:Variables>
                        <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                          <d1p1:Dimensions i:nil="true" />
                          <d1p1:Name>
                            <d1p1:Content>iPostPadding</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d1p1:Name>
                        </d1p1:DimVariable>
                      </d1p1:Variables>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>DateDiff</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>d</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>dCalEnd</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Functions</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Dates</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>fn_GetLastDateOfWeek</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>dCalEnd</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iWeekDayCalEnd</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iPostPadding</d1p1:Content>
                            <d1p1:LineIndex>694</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iPostPadding</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>&gt;</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>0</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                <d1p1:Content>And</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iPostPadding</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>&lt;</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>7</d1p1:Content>
                                <d1p1:LineIndex>695</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:DimStatement">
                              <d1p1:Variables>
                                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                                  <d1p1:Dimensions i:nil="true" />
                                  <d1p1:Name>
                                    <d1p1:Content>k</d1p1:Content>
                                    <d1p1:LineIndex>696</d1p1:LineIndex>
                                  </d1p1:Name>
                                </d1p1:DimVariable>
                              </d1p1:Variables>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ForBlock">
                              <d1p1:LoopFrom>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>1</d1p1:Content>
                                    <d1p1:LineIndex>696</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:LoopFrom>
                              <d1p1:LoopStep i:nil="true" />
                              <d1p1:LoopTo>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>iPostPadding</d1p1:Content>
                                    <d1p1:LineIndex>696</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:LoopTo>
                              <d1p1:LoopVar>
                                <d1p1:Content>k</d1p1:Content>
                                <d1p1:LineIndex>696</d1p1:LineIndex>
                              </d1p1:LoopVar>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:Statement">
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>sbCalendars</d1p1:Content>
                                      <d1p1:LineIndex>697</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>697</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>AppendLine</d1p1:Content>
                                      <d1p1:LineIndex>697</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:OpenBrace">
                                      <d1p1:Content>(</d1p1:Content>
                                      <d1p1:LineIndex>697</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>&lt;td&gt;&lt;/td&gt;</d1p1:Content>
                                      <d1p1:LineIndex>697</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CloseBrace">
                                      <d1p1:Content>)</d1p1:Content>
                                      <d1p1:LineIndex>697</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                  <d1p1:Expression>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iCellCount</d1p1:Content>
                                        <d1p1:LineIndex>698</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OperatorToken">
                                        <d1p1:Content>+</d1p1:Content>
                                        <d1p1:LineIndex>698</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                                        <d1p1:Content>1</d1p1:Content>
                                        <d1p1:LineIndex>698</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Expression>
                                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                  <d1p1:ValueToSet>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>iCellCount</d1p1:Content>
                                        <d1p1:LineIndex>698</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:ValueToSet>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>False</d1p1:Content>
                            <d1p1:LineIndex>701</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bLastCell</d1p1:Content>
                            <d1p1:LineIndex>701</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>702</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bFirstCell</d1p1:Content>
                            <d1p1:LineIndex>702</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iCellCount</d1p1:Content>
                        <d1p1:LineIndex>705</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>Mod</d1p1:Content>
                        <d1p1:LineIndex>705</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>7</d1p1:Content>
                        <d1p1:LineIndex>705</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>705</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>705</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>sbCalendars</d1p1:Content>
                          <d1p1:LineIndex>706</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>706</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>AppendLine</d1p1:Content>
                          <d1p1:LineIndex>706</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>706</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
                          <d1p1:LineIndex>706</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>706</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>DateAdd</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>d</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dDate</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dDate</d1p1:Content>
                    <d1p1:LineIndex>709</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>712</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>712</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>712</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>712</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/tbody&gt;</d1p1:Content>
              <d1p1:LineIndex>712</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>712</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>713</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>713</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>713</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>713</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/table&gt;</d1p1:Content>
              <d1p1:LineIndex>713</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>713</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sbCalendars</d1p1:Content>
              <d1p1:LineIndex>714</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>714</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>714</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>714</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>714</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>714</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderAvailCalKey</d1p1:Content>
        <d1p1:LineIndex>718</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>sb</d1p1:Content>
            <d1p1:LineIndex>718</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strCalKey</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/availcalendar/calkey</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content></d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strCalKey</d1p1:Content>
                <d1p1:LineIndex>719</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Trim</d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strCalKey</d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>720</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>sb</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>AppendLine</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="CalKey"&gt;</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strCalKey</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>721</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderAvailCalLinks</d1p1:Content>
        <d1p1:LineIndex>725</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>dStart</d1p1:Content>
            <d1p1:LineIndex>725</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>sb</d1p1:Content>
            <d1p1:LineIndex>725</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dCalStartPrev</d1p1:Content>
                <d1p1:LineIndex>727</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strTitlePrev</d1p1:Content>
                <d1p1:LineIndex>727</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dCalStartNext</d1p1:Content>
                <d1p1:LineIndex>727</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strTitleNext</d1p1:Content>
                <d1p1:LineIndex>727</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> dStart is the start date for the last month shown in the rendered calendars</d1p1:Content>
          <d1p1:LineIndex>729</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> and we therefore only need to go forward by 1 month</d1p1:Content>
          <d1p1:LineIndex>730</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> even if no calendars are shown for the current month we can still potentially</d1p1:Content>
          <d1p1:LineIndex>731</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> move to a future month where there is availability.</d1p1:Content>
          <d1p1:LineIndex>732</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iPositiveMonthAdjustment</d1p1:Content>
                <d1p1:LineIndex>733</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>733</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iPositiveMonthAdjustment</d1p1:Content>
                <d1p1:LineIndex>733</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> The previous month link has to go back by however many months are already showing, i.e. Jul &amp; Aug are shown</d1p1:Content>
          <d1p1:LineIndex>734</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> dStart = 01/08/2011 (Aug) and we need to display Jun &amp; Jul so we need to jump back 2 months to June.</d1p1:Content>
          <d1p1:LineIndex>735</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iNegativeMonthAdjustment</d1p1:Content>
                <d1p1:LineIndex>736</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>736</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>736</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
                <d1p1:LineIndex>736</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>736</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNegativeMonthAdjustment</d1p1:Content>
                <d1p1:LineIndex>736</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
                    <d1p1:LineIndex>738</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>738</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>738</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> If we have no rendered calendars we still need the link to go back by 1 month</d1p1:Content>
                  <d1p1:LineIndex>739</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>-</d1p1:Content>
                        <d1p1:LineIndex>740</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>740</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iNegativeMonthAdjustment</d1p1:Content>
                        <d1p1:LineIndex>740</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>fn_GetFirstDateOfMonth</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>DateAdd</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>m</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNegativeMonthAdjustment</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dStart</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStartPrev</d1p1:Content>
                <d1p1:LineIndex>743</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/availcalendar/previousmonth</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>&amp;lt;&amp;lt; Previous Month</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strTitlePrev</d1p1:Content>
                <d1p1:LineIndex>744</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>fn_GetFirstDateOfMonth</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>DateAdd</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>m</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iPositiveMonthAdjustment</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dStart</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dCalStartNext</d1p1:Content>
                <d1p1:LineIndex>746</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/availcalendar/nextmonth</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>Next Month &amp;gt;&amp;gt;</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strTitleNext</d1p1:Content>
                <d1p1:LineIndex>747</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sb</d1p1:Content>
              <d1p1:LineIndex>749</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>749</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>749</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="CalNavLinks"&gt;</d1p1:Content>
              <d1p1:LineIndex>749</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sb</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_RenderAvailCalLink</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>dCalStartPrev</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strTitlePrev</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>prev</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>750</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sb</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_RenderAvailCalLink</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>dCalStartNext</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strTitleNext</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>next</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>751</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sb</d1p1:Content>
              <d1p1:LineIndex>752</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>752</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>AppendLine</d1p1:Content>
              <d1p1:LineIndex>752</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>752</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderAvailCalLink</d1p1:Content>
        <d1p1:LineIndex>756</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>dCalStartDate</d1p1:Content>
            <d1p1:LineIndex>756</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strTitle</d1p1:Content>
            <d1p1:LineIndex>756</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strClass</d1p1:Content>
            <d1p1:LineIndex>756</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>itm</d1p1:Content>
                <d1p1:LineIndex>758</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sValue</d1p1:Content>
                <d1p1:LineIndex>758</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strLink</d1p1:Content>
                <d1p1:LineIndex>758</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bFound</d1p1:Content>
                <d1p1:LineIndex>758</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>760</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bFound</d1p1:Content>
                <d1p1:LineIndex>760</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ForEachBlock">
          <d1p1:LoopSrc>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Request</d1p1:Content>
                <d1p1:LineIndex>762</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>762</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>QueryString</d1p1:Content>
                <d1p1:LineIndex>762</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopSrc>
          <d1p1:LoopVar>
            <d1p1:Content>itm</d1p1:Content>
            <d1p1:LineIndex>762</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>itm</d1p1:Content>
                        <d1p1:LineIndex>763</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>763</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>isostartdate</d1p1:Content>
                        <d1p1:LineIndex>763</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content>reset date</d1p1:Content>
                      <d1p1:LineIndex>764</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Functions</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Dates</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>ISODate</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>dCalStartDate</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>sValue</d1p1:Content>
                            <d1p1:LineIndex>765</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>766</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bFound</d1p1:Content>
                            <d1p1:LineIndex>766</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause>
                <d1p1:Statements>
                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                    <d1p1:Expression>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Request</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>QueryString</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>itm</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Expression>
                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                    <d1p1:ValueToSet>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>sValue</d1p1:Content>
                          <d1p1:LineIndex>768</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:ValueToSet>
                  </d2p1:anyType>
                </d1p1:Statements>
              </d1p1:OptionalElseClause>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strLink</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>&amp;amp;</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>itm</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Server</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>UrlEncode</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sValue</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strLink</d1p1:Content>
                    <d1p1:LineIndex>770</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>773</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bFound</d1p1:Content>
                    <d1p1:LineIndex>773</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strLink</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>&amp;amp;isostartdate=</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Server</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>UrlEncode</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Functions</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Dates</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>ISODate</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>dCalStartDate</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strLink</d1p1:Content>
                        <d1p1:LineIndex>773</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Trim</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strLink</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>775</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Replace</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strLink</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>&amp;amp;</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>?</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strLink</d1p1:Content>
                        <d1p1:LineIndex>775</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>DateDiff</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>m</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Date</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dCalStartDate</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>777</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>&lt;a href="</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strLink</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>" class="</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strClass</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>" title="</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strTitle</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>" rel="nofollow"&gt;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strTitle</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>&lt;/a&gt;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>vbCrLf</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_RenderAvailCalLink</d1p1:Content>
                        <d1p1:LineIndex>778</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content></d1p1:Content>
                      <d1p1:LineIndex>780</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderAvailCalLink</d1p1:Content>
                      <d1p1:LineIndex>780</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>788</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Main entry point when VB Polling is enabled</d1p1:Content>
      <d1p1:LineIndex>789</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> - Applies to acco products only</d1p1:Content>
      <d1p1:LineIndex>790</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> - Not supported when handling Conference Bookings (these are local only)</d1p1:Content>
      <d1p1:LineIndex>791</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>792</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayMain_Polling</d1p1:Content>
        <d1p1:LineIndex>793</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objData</d1p1:Content>
            <d1p1:LineIndex>793</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>793</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>795</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>795</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>795</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>OutputWriter</d1p1:Content>
                <d1p1:LineIndex>795</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>795</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dStartNight</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>VisitDate</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dStartNight</d1p1:Content>
                <d1p1:LineIndex>796</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>797</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> This is new, VB Polling approach (only supports accommodation, but handles results from</d1p1:Content>
          <d1p1:LineIndex>799</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> multiple providers)</d1p1:Content>
          <d1p1:LineIndex>800</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>801</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objData</d1p1:Content>
                <d1p1:LineIndex>801</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>801</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Availability</d1p1:Content>
                <d1p1:LineIndex>801</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>801</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>802</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objData</d1p1:Content>
                <d1p1:LineIndex>802</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>802</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Product_Key</d1p1:Content>
                <d1p1:LineIndex>802</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>802</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bIsTeleBooking</d1p1:Content>
                <d1p1:LineIndex>803</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objData</d1p1:Content>
                <d1p1:LineIndex>803</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>803</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IsOnTeleBookingChannel</d1p1:Content>
                <d1p1:LineIndex>803</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bIsTeleBooking</d1p1:Content>
                <d1p1:LineIndex>803</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>805</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bNoResults</d1p1:Content>
                <d1p1:LineIndex>806</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bRenderedSummary</d1p1:Content>
                <d1p1:LineIndex>807</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndex</d1p1:Content>
                <d1p1:LineIndex>808</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexSupplier</d1p1:Content>
                <d1p1:LineIndex>808</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                <d1p1:LineIndex>809</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objFuzzyStay</d1p1:Content>
                <d1p1:LineIndex>809</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bPreciseMatch</d1p1:Content>
                <d1p1:LineIndex>809</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bStayHasLocalAvail</d1p1:Content>
                <d1p1:LineIndex>809</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objSuppliersForStay</d1p1:Content>
                <d1p1:LineIndex>810</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objSupplier</d1p1:Content>
                <d1p1:LineIndex>810</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objDictAvaiStays</d1p1:Content>
                <d1p1:LineIndex>812</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strAvailStayKey</d1p1:Content>
                <d1p1:LineIndex>812</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>aryStay</d1p1:Content>
                <d1p1:LineIndex>812</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sStayNo</d1p1:Content>
                <d1p1:LineIndex>812</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bStayIndicative</d1p1:Content>
                <d1p1:LineIndex>812</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Server</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>CreateObject</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>Scripting.Dictionary</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objDictAvaiStays</d1p1:Content>
                <d1p1:LineIndex>813</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Quick situation assertion</d1p1:Content>
          <d1p1:LineIndex>815</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objRenderSettings</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingType</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>accommodation</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>816</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>Err</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Raise</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbObjectError</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>ETWP.BookingUnitSelection</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>BookingUI_StayMain_Polling: BookingType not supported ("</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingType</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>")</d1p1:Content>
                      <d1p1:LineIndex>817</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objRenderSettings</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Offer</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>819</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>Err</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Raise</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbObjectError</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>ETWP.BookingUnitSelection</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>BookingUI_StayMain_Polling: Not supported with Conference Bookings (OfferKey = </d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingRequirement</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Offer</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>820</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Grab hold of the data for the stay(s) - ensure we've got some availability</d1p1:Content>
          <d1p1:LineIndex>823</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetUniqueFuzzyCombinations</d1p1:Content>
                <d1p1:LineIndex>824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>824</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                <d1p1:LineIndex>824</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>825</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>826</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>826</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                      <d1p1:LineIndex>826</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>objAvail.GetUniqueFuzzyCombinations reported zero stay options</d1p1:Content>
                      <d1p1:LineIndex>826</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>True</d1p1:Content>
                        <d1p1:LineIndex>827</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bNoResults</d1p1:Content>
                        <d1p1:LineIndex>827</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> Double-check that all stay options report availability - there shouldn't be any stay</d1p1:Content>
                <d1p1:LineIndex>829</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> data returned that doesn't have avail data</d1p1:Content>
                <d1p1:LineIndex>830</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BlankLine" />
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>False</d1p1:Content>
                      <d1p1:LineIndex>832</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>bNoResults</d1p1:Content>
                      <d1p1:LineIndex>832</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ForBlock">
                <d1p1:LoopFrom>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NumericValueToken">
                      <d1p1:Content>0</d1p1:Content>
                      <d1p1:LineIndex>833</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:LoopFrom>
                <d1p1:LoopStep i:nil="true" />
                <d1p1:LoopTo>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                      <d1p1:LineIndex>833</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>833</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Count</d1p1:Content>
                      <d1p1:LineIndex>833</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>-</d1p1:Content>
                      <d1p1:LineIndex>833</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NumericValueToken">
                      <d1p1:Content>1</d1p1:Content>
                      <d1p1:LineIndex>833</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:LoopTo>
                <d1p1:LoopVar>
                  <d1p1:Content>intIndex</d1p1:Content>
                  <d1p1:LineIndex>833</d1p1:LineIndex>
                </d1p1:LoopVar>
                <d1p1:Statements>
                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                    <d1p1:Expression>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>GetItem</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>intIndex</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Expression>
                    <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                    <d1p1:ValueToSet>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                          <d1p1:LineIndex>834</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:ValueToSet>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                    <d1p1:Expression>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objAvail</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>GetSupplierUnitDataForStay</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>StartDate</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Nights</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Expression>
                    <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                    <d1p1:ValueToSet>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objSuppliersForStay</d1p1:Content>
                          <d1p1:LineIndex>835</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:ValueToSet>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:IfBlock">
                    <d1p1:ConditionalClauses>
                      <d1p1:IfBlock.IfBlockConditionSegment>
                        <d1p1:Condition>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>objSuppliersForStay</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Count</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                              <d1p1:Content>=</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>0</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>836</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Condition>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Page</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>PrintTraceWarning</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>Stay (</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objFuzzyStay</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>StartDate</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>, </d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objFuzzyStay</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Nights</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>) reported zero suppliers</d1p1:Content>
                                <d1p1:LineIndex>837</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                  <d1p1:Content>True</d1p1:Content>
                                  <d1p1:LineIndex>838</d1p1:LineIndex>
                                  <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>bNoResults</d1p1:Content>
                                  <d1p1:LineIndex>838</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d1p1:IfBlock.IfBlockConditionSegment>
                    </d1p1:ConditionalClauses>
                    <d1p1:OptionalElseClause>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ForBlock">
                          <d1p1:LoopFrom>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>0</d1p1:Content>
                                <d1p1:LineIndex>840</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:LoopFrom>
                          <d1p1:LoopStep i:nil="true" />
                          <d1p1:LoopTo>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objSuppliersForStay</d1p1:Content>
                                <d1p1:LineIndex>840</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>840</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Count</d1p1:Content>
                                <d1p1:LineIndex>840</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>-</d1p1:Content>
                                <d1p1:LineIndex>840</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>1</d1p1:Content>
                                <d1p1:LineIndex>840</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:LoopTo>
                          <d1p1:LoopVar>
                            <d1p1:Content>intIndexSupplier</d1p1:Content>
                            <d1p1:LineIndex>840</d1p1:LineIndex>
                          </d1p1:LoopVar>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSuppliersForStay</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>GetItem</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>intIndexSupplier</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSupplier</d1p1:Content>
                                    <d1p1:LineIndex>841</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>objSupplier</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                        <d1p1:Content>.</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>Units</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                        <d1p1:Content>.</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>Count</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                        <d1p1:Content>=</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                                        <d1p1:Content>0</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>842</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:Statement">
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Page</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>PrintTraceWarning</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>Supplier </d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>objSupplier</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Name</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content> for Stay (</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>StartDate</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>, </d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Nights</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>) reported zero units</d1p1:Content>
                                          <d1p1:LineIndex>843</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                            <d1p1:Content>True</d1p1:Content>
                                            <d1p1:LineIndex>844</d1p1:LineIndex>
                                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>bNoResults</d1p1:Content>
                                            <d1p1:LineIndex>844</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause i:nil="true" />
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:OptionalElseClause>
                  </d2p1:anyType>
                </d1p1:Statements>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If not, render error and get out</d1p1:Content>
          <d1p1:LineIndex>851</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>852</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bNoResults</d1p1:Content>
                    <d1p1:LineIndex>852</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>852</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Render message, set ProdHasAvail To False (only</d1p1:Content>
                  <d1p1:LineIndex>853</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> used by BookingKeys control, I think) and close recordsets</d1p1:Content>
                  <d1p1:LineIndex>854</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>RenderNoAvailElement</d1p1:Content>
                      <d1p1:LineIndex>855</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>855</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>False</d1p1:Content>
                        <d1p1:LineIndex>856</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bProdHasAvail</d1p1:Content>
                        <d1p1:LineIndex>856</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:InlineCommentStatement">
                  <d1p1:Content> This is exposed through the WSC's public property "ProdHasAvail"</d1p1:Content>
                  <d1p1:LineIndex>856</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>857</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>True</d1p1:Content>
                <d1p1:LineIndex>860</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bProdHasAvail</d1p1:Content>
                <d1p1:LineIndex>860</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:InlineCommentStatement">
          <d1p1:Content> This is exposed through the WSC's public property "ProdHasAvail"</d1p1:Content>
          <d1p1:LineIndex>860</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Loop through different stay options</d1p1:Content>
          <d1p1:LineIndex>862</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Store data for all stays for calendar</d1p1:Content>
          <d1p1:LineIndex>863</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                    <d1p1:LineIndex>864</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:ForBlock">
                  <d1p1:LoopFrom>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>866</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopFrom>
                  <d1p1:LoopStep i:nil="true" />
                  <d1p1:LoopTo>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                        <d1p1:LineIndex>866</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>866</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Count</d1p1:Content>
                        <d1p1:LineIndex>866</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>-</d1p1:Content>
                        <d1p1:LineIndex>866</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>866</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopTo>
                  <d1p1:LoopVar>
                    <d1p1:Content>intIndex</d1p1:Content>
                    <d1p1:LineIndex>866</d1p1:LineIndex>
                  </d1p1:LoopVar>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>GetItem</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intIndex</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                            <d1p1:LineIndex>867</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>sd_</d1p1:Content>
                            <d1p1:LineIndex>869</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>869</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                            <d1p1:LineIndex>869</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>869</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>StartDate</d1p1:Content>
                            <d1p1:LineIndex>869</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strAvailStayKey</d1p1:Content>
                            <d1p1:LineIndex>869</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objDictAvaiStays</d1p1:Content>
                                <d1p1:LineIndex>870</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>870</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Exists</d1p1:Content>
                                <d1p1:LineIndex>870</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>870</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strAvailStayKey</d1p1:Content>
                                <d1p1:LineIndex>870</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>870</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:BlankLine" />
                            <d2p1:anyType i:type="d1p1:CommentStatement">
                              <d1p1:Content> We expect value in the format [stayNo]_[indicative]</d1p1:Content>
                              <d1p1:LineIndex>872</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>Split</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objDictAvaiStays</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strAvailStayKey</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>_</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>873</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>874</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>874</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>0</d1p1:Content>
                                    <d1p1:LineIndex>874</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>874</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>sStayNo</d1p1:Content>
                                    <d1p1:LineIndex>874</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>sStayNo</d1p1:Content>
                                    <d1p1:LineIndex>875</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>875</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>-</d1p1:Content>
                                    <d1p1:LineIndex>875</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>875</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>intIndex</d1p1:Content>
                                    <d1p1:LineIndex>875</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>sStayNo</d1p1:Content>
                                    <d1p1:LineIndex>875</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:BlankLine" />
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                    <d1p1:Content>CBool</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>aryStay</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                                    <d1p1:Content>1</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>bStayIndicative</d1p1:Content>
                                    <d1p1:LineIndex>877</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                        <d1p1:Content>Not</d1p1:Content>
                                        <d1p1:LineIndex>878</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>bStayIndicative</d1p1:Content>
                                        <d1p1:LineIndex>878</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                        <d1p1:Content>And</d1p1:Content>
                                        <d1p1:LineIndex>878</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>objFuzzyStay</d1p1:Content>
                                        <d1p1:LineIndex>878</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                        <d1p1:Content>.</d1p1:Content>
                                        <d1p1:LineIndex>878</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>Indicative</d1p1:Content>
                                        <d1p1:LineIndex>878</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                                            <d1p1:LineIndex>879</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                            <d1p1:Content>.</d1p1:Content>
                                            <d1p1:LineIndex>879</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>Indicative</d1p1:Content>
                                            <d1p1:LineIndex>879</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>bStayIndicative</d1p1:Content>
                                            <d1p1:LineIndex>879</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause i:nil="true" />
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>sStayNo</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>_</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>bStayIndicative</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objDictAvaiStays</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                    <d1p1:Content>(</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strAvailStayKey</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                    <d1p1:Content>)</d1p1:Content>
                                    <d1p1:LineIndex>881</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:EraseStatement">
                              <d1p1:KeywordLineIndex>882</d1p1:KeywordLineIndex>
                              <d1p1:Targets>
                                <d1p1:EraseStatement.TargetDetails>
                                  <d1p1:ArgumentsIfAny i:nil="true" />
                                  <d1p1:Target>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>aryStay</d1p1:Content>
                                        <d1p1:LineIndex>882</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Target>
                                  <d1p1:WrappedInBraces>false</d1p1:WrappedInBraces>
                                </d1p1:EraseStatement.TargetDetails>
                              </d1p1:Targets>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objDictAvaiStays</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Add</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>sd_</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objFuzzyStay</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>StartDate</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>intIndex</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>+</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>1</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>_</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objFuzzyStay</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Indicative</d1p1:Content>
                                <d1p1:LineIndex>884</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d1p1:OptionalElseClause>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                  </d1p1:Statements>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bRenderedInitialStay</d1p1:Content>
                <d1p1:LineIndex>891</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>891</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bRenderedInitialStay</d1p1:Content>
                <d1p1:LineIndex>891</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - For unit selections: If we have a perfect match stay, don't bother with the fuzzy options</d1p1:Content>
          <d1p1:LineIndex>892</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>893</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                <d1p1:LineIndex>893</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>893</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>893</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>893</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>893</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>893</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> 2010-11-03 TB: Stay numbers are 1-based so add 1 to zero-based index</d1p1:Content>
              <d1p1:LineIndex>894</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:DimStatement">
              <d1p1:Variables>
                <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                  <d1p1:Dimensions i:nil="true" />
                  <d1p1:Name>
                    <d1p1:Content>iStayNum</d1p1:Content>
                    <d1p1:LineIndex>895</d1p1:LineIndex>
                  </d1p1:Name>
                </d1p1:DimVariable>
              </d1p1:Variables>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndex</d1p1:Content>
                    <d1p1:LineIndex>895</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>+</d1p1:Content>
                    <d1p1:LineIndex>895</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>895</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iStayNum</d1p1:Content>
                    <d1p1:LineIndex>895</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>GetItem</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndex</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Set</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStay</d1p1:Content>
                    <d1p1:LineIndex>897</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> 2010-01-29 DWR: Need to use DateValue here since dStartNight might be a string</d1p1:Content>
              <d1p1:LineIndex>899</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> which will cause the comparison to fail when they represent the same date</d1p1:Content>
              <d1p1:LineIndex>900</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>DateValue</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStay</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>StartDate</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>DateValue</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dStartNight</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStay</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Nights</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iNights</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bPreciseMatch</d1p1:Content>
                    <d1p1:LineIndex>901</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> 2010-01-29 DWR: In cases where we have a precise match and we're not rendering a calendar</d1p1:Content>
              <d1p1:LineIndex>903</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> then we want to just display that stay and get out! If we DON'T have a precise match and</d1p1:Content>
              <d1p1:LineIndex>904</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> we're not using the calendar approach then we want to render all options and have client</d1p1:Content>
              <d1p1:LineIndex>905</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> side script juggle them. If we ARE rendering the calendar then we want to display ALL</d1p1:Content>
              <d1p1:LineIndex>906</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> stays - regardless of whether we have a precise match - because the calendar relies</d1p1:Content>
              <d1p1:LineIndex>907</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> on the data being in the markup for it to swap around.</d1p1:Content>
              <d1p1:LineIndex>908</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Or</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bPreciseMatch</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>909</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;div class="PollingFuzzySetWrapper" id="stay_</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iStayNum</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>"&gt;</d1p1:Content>
                          <d1p1:LineIndex>910</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> we only render the first stay when initially loading the unitselection</d1p1:Content>
              <d1p1:LineIndex>913</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> we get the rest via a partial render request and the data is returned as JSON</d1p1:Content>
              <d1p1:LineIndex>914</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> ready for manipulation and insertion by javascript</d1p1:Content>
              <d1p1:LineIndex>915</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> this is done to avoid large amounts of HTML being rendered and then hidden</d1p1:Content>
              <d1p1:LineIndex>916</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>917</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>917</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bRenderedInitialStay</d1p1:Content>
                        <d1p1:LineIndex>917</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>917</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>RenderStay</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objAvail</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iStayNum</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objRenderSettings</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>bIsTeleBooking</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objData</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>bookingweb</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objData</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>EviivoId</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objData</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Units</d1p1:Content>
                          <d1p1:LineIndex>918</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>921</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                        <d1p1:LineIndex>921</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>921</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>922</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bRenderedInitialStay</d1p1:Content>
                            <d1p1:LineIndex>922</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> Close the wrapper for the current stay date/length result set</d1p1:Content>
              <d1p1:LineIndex>925</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> 2010-01-29: See earlier comment about this..</d1p1:Content>
              <d1p1:LineIndex>926</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Or</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bPreciseMatch</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>927</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>928</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>928</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>928</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                          <d1p1:LineIndex>928</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> If these options were a perfect match, drop out</d1p1:Content>
              <d1p1:LineIndex>931</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> 2010-01-29 DWR: Unless we're rendering the calendar! In this case client-side javascript</d1p1:Content>
              <d1p1:LineIndex>932</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> will look after showing one fuzzy stay at a time, but it needs all data present.</d1p1:Content>
              <d1p1:LineIndex>933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bPreciseMatch</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>And</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>934</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ExitStatement">
                      <d1p1:LineIndex>935</d1p1:LineIndex>
                      <d1p1:StatementType>For</d1p1:StatementType>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                    <d1p1:LineIndex>940</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:DimStatement">
                  <d1p1:Variables>
                    <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                      <d1p1:Dimensions i:nil="true" />
                      <d1p1:Name>
                        <d1p1:Content>ReqDictTemp</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d1p1:Name>
                    </d1p1:DimVariable>
                  </d1p1:Variables>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Functions</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetNewObject</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>RequestDict</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>ReqDictTemp</d1p1:Content>
                        <d1p1:LineIndex>942</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>943</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>943</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ForceAdd</d1p1:Content>
                      <d1p1:LineIndex>943</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>AsyncAction</d1p1:Content>
                      <d1p1:LineIndex>943</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>943</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>unitselection</d1p1:Content>
                      <d1p1:LineIndex>943</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ForceAdd</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>PartialRenderControlList</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Context</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PageControlKey</d1p1:Content>
                      <d1p1:LineIndex>944</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>945</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>945</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ForceAdd</d1p1:Content>
                      <d1p1:LineIndex>945</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Silent</d1p1:Content>
                      <d1p1:LineIndex>945</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>945</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>1</d1p1:Content>
                      <d1p1:LineIndex>945</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>946</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>946</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Remove</d1p1:Content>
                      <d1p1:LineIndex>946</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Debug</d1p1:Content>
                      <d1p1:LineIndex>946</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>947</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>947</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Remove</d1p1:Content>
                      <d1p1:LineIndex>947</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>PartialRenderType</d1p1:Content>
                      <d1p1:LineIndex>947</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>948</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>948</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Remove</d1p1:Content>
                      <d1p1:LineIndex>948</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Trace</d1p1:Content>
                      <d1p1:LineIndex>948</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>950</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>950</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTrace</d1p1:Content>
                      <d1p1:LineIndex>950</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>BookingUI_StayMain_Polling: Render available stays as calendars - start</d1p1:Content>
                      <d1p1:LineIndex>950</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderAvailCal</d1p1:Content>
                      <d1p1:LineIndex>951</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>951</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>951</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objDictAvaiStays</d1p1:Content>
                      <d1p1:LineIndex>951</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>951</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>False</d1p1:Content>
                      <d1p1:LineIndex>951</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>952</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>952</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTrace</d1p1:Content>
                      <d1p1:LineIndex>952</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>BookingUI_StayMain_Polling: Render available stays as calendars - end</d1p1:Content>
                      <d1p1:LineIndex>952</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>953</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>953</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>953</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;script type="text/javascript"&gt;</d1p1:Content>
                      <d1p1:LineIndex>953</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>NewMind.ETWP.ControlData[</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Context</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PageControlKey</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>] = { </d1p1:Content>
                      <d1p1:LineIndex>954</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>955</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>955</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>955</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>UnitSelPartialRenderLink: '</d1p1:Content>
                      <d1p1:LineIndex>955</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Functions</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>GetNewObject</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>clsJSON</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>EscapeJSON</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>?</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ReqDictTemp</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Querystring</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>956</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>957</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>957</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>957</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>'</d1p1:Content>
                      <d1p1:LineIndex>957</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>958</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>958</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>958</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> };</d1p1:Content>
                      <d1p1:LineIndex>958</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>959</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>959</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>959</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>NewMind.ETWP.Booking.InitUnitSel();</d1p1:Content>
                      <d1p1:LineIndex>959</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>960</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>960</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>960</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/</d1p1:Content>
                      <d1p1:LineIndex>960</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>960</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>script&gt;</d1p1:Content>
                      <d1p1:LineIndex>960</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Kick off the show / hide script for fuzzy result sets now that we've rendered out all</d1p1:Content>
          <d1p1:LineIndex>964</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> the content rather than waiting for page load - hopefully we can remove some of the</d1p1:Content>
          <d1p1:LineIndex>965</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> flicker that occurs otherwise</d1p1:Content>
          <d1p1:LineIndex>966</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>967</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>967</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>967</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;script type="text/javascript"&gt;NewMind.ETWP.Booking.InitPollingUnitSel();&lt;/</d1p1:Content>
              <d1p1:LineIndex>967</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>967</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>script&gt;</d1p1:Content>
              <d1p1:LineIndex>967</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>true</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>RenderNotRequiredDateWarning</d1p1:Content>
        <d1p1:LineIndex>971</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>971</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;p class="fuzzyWarning"&gt;</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/unitselection/notrequireddates</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>Sorry, we don't have any availability for the dates you requested. These are the nearest available dates for your room and duration requirements.</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/p&gt;</d1p1:Content>
              <d1p1:LineIndex>972</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>true</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>RenderStay</d1p1:Content>
        <d1p1:LineIndex>975</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objFuzzyStay</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvail</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bIsTeleBooking</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strEviivoIdIfAny</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAllUnits</d1p1:Content>
            <d1p1:LineIndex>975</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2011-08-09 DWR: Expect the BookingRequirement in objRenderSettings to be read-only (since it usually comes from Page.Functions.GetSharedObject),</d1p1:Content>
          <d1p1:LineIndex>977</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> so replace it with an editable version (since some methods in here try to mess about with properties on it)</d1p1:Content>
          <d1p1:LineIndex>978</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetEditableBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>979</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objSuppliersForStay</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetSupplierUnitDataForStay</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStay</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>StartDate</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStay</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objSuppliersForStay</d1p1:Content>
                <d1p1:LineIndex>981</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>983</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>983</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>983</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ProductKey</d1p1:Content>
                <d1p1:LineIndex>983</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>983</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>dStartNight</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>VisitDate</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dStartNight</d1p1:Content>
                <d1p1:LineIndex>984</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>985</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>986</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>986</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>986</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>OutputWriter</d1p1:Content>
                <d1p1:LineIndex>986</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>986</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>just need to set these here as we may be coming in direct from partial render request</d1p1:Content>
          <d1p1:LineIndex>988</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>989</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>989</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>RenderAsCalendar</d1p1:Content>
                <d1p1:LineIndex>989</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                <d1p1:LineIndex>989</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>990</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>990</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                <d1p1:LineIndex>990</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                <d1p1:LineIndex>990</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Loop through each supplier and render their units</d1p1:Content>
          <d1p1:LineIndex>992</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Suppliers will be ordered NewMind, FrontDesk, Other</d1p1:Content>
          <d1p1:LineIndex>993</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - If "Booking_ForceExternal" is enabled, FrontDesk is treated as "Other"</d1p1:Content>
          <d1p1:LineIndex>994</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - There is a limit on the number of "Other" entries to be rendered (if ForceExternal</d1p1:Content>
          <d1p1:LineIndex>995</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   is enabled, then FrontDesk counts towards this limit)</d1p1:Content>
          <d1p1:LineIndex>996</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - If ForceExternal is not enabled, FrontDesk will only be rendered if there is no</d1p1:Content>
          <d1p1:LineIndex>997</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   local availability</d1p1:Content>
          <d1p1:LineIndex>998</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bStayHasLocalAvail</d1p1:Content>
                <d1p1:LineIndex>999</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>999</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bStayHasLocalAvail</d1p1:Content>
                <d1p1:LineIndex>999</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intExtSuppliersShown</d1p1:Content>
                <d1p1:LineIndex>1000</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1000</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intExtSuppliersShown</d1p1:Content>
                <d1p1:LineIndex>1000</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bRenderedStaySummary</d1p1:Content>
                <d1p1:LineIndex>1001</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>1001</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bRenderedStaySummary</d1p1:Content>
                <d1p1:LineIndex>1001</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexSupplier</d1p1:Content>
                <d1p1:LineIndex>1002</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objSupplier</d1p1:Content>
                <d1p1:LineIndex>1003</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bSkipSupplier</d1p1:Content>
                <d1p1:LineIndex>1005</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strBookingStaySummary</d1p1:Content>
                <d1p1:LineIndex>1006</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bExternalSupplier</d1p1:Content>
                <d1p1:LineIndex>1007</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strSupplierId</d1p1:Content>
                <d1p1:LineIndex>1008</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strSupplierName</d1p1:Content>
                <d1p1:LineIndex>1008</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strSupplierQuality</d1p1:Content>
                <d1p1:LineIndex>1008</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strSupplierLogo</d1p1:Content>
                <d1p1:LineIndex>1008</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                <d1p1:LineIndex>1008</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intBookingType</d1p1:Content>
                <d1p1:LineIndex>1009</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bPreciseMatch</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>DateValue</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStay</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>StartDate</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                <d1p1:Content>=</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>DateValue</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>dStartNight</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                <d1p1:Content>And</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStay</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                <d1p1:Content>=</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNights</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bPreciseMatch</d1p1:Content>
                <d1p1:LineIndex>1011</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1013</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objSuppliersForStay</d1p1:Content>
                <d1p1:LineIndex>1013</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1013</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>1013</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1013</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1013</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndexSupplier</d1p1:Content>
            <d1p1:LineIndex>1013</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> Get basic supplier data - count FrontDesk as "Other" if ForceExternal enabled</d1p1:Content>
              <d1p1:LineIndex>1015</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objSuppliersForStay</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>GetItem</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexSupplier</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Set</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objSupplier</d1p1:Content>
                    <d1p1:LineIndex>1016</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1017</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objSupplier</d1p1:Content>
                        <d1p1:LineIndex>1017</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1017</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>IsLocal</d1p1:Content>
                        <d1p1:LineIndex>1017</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1017</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>1018</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bStayHasLocalAvail</d1p1:Content>
                            <d1p1:LineIndex>1018</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objSupplier</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsExternal</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objSupplier</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsRemote</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_ForceExternal</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bExternalSupplier</d1p1:Content>
                    <d1p1:LineIndex>1020</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> Don't render FrontDesk if got local avail for this stay and not enabled ForceExternal</d1p1:Content>
              <d1p1:LineIndex>1022</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bStayHasLocalAvail</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objSupplier</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsRemote</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_ForceExternal</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bSkipSupplier</d1p1:Content>
                    <d1p1:LineIndex>1023</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>1024</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1024</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bSkipSupplier</d1p1:Content>
                        <d1p1:LineIndex>1024</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1024</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Don't bother rendering stay summary title if we've got a perfect match, as we</d1p1:Content>
                      <d1p1:LineIndex>1026</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> won't be showing any fuzzy content if there's a spot-on option</d1p1:Content>
                      <d1p1:LineIndex>1027</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                <d1p1:Content>Not</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>bPreciseMatch</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                <d1p1:Content>And</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                <d1p1:Content>Not</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>bRenderedStaySummary</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1028</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                        <d1p1:Content>Not</d1p1:Content>
                                        <d1p1:LineIndex>1029</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                                        <d1p1:LineIndex>1029</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:Statement">
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>BookingUI_StaySummary</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>dStartNight</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>iNights</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>StartDate</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Nights</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>pO</d1p1:Content>
                                          <d1p1:LineIndex>1030</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause i:nil="true" />
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                    <d1p1:Content>True</d1p1:Content>
                                    <d1p1:LineIndex>1032</d1p1:LineIndex>
                                    <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>bRenderedStaySummary</d1p1:Content>
                                    <d1p1:LineIndex>1032</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> If this is an external supplier, we need the deep-link quality to pass to get</d1p1:Content>
                      <d1p1:LineIndex>1035</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> included in the hidden booking-info form fields</d1p1:Content>
                      <d1p1:LineIndex>1036</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> PW 2010-07-28 I have added a new field called strSupplierEviivoName</d1p1:Content>
                      <d1p1:LineIndex>1038</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> This is to pass through the original name field from Eviivo through to the polling exit page.</d1p1:Content>
                      <d1p1:LineIndex>1039</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Previously, we did some manipulation on this value to ensure it had a nice display name.</d1p1:Content>
                      <d1p1:LineIndex>1040</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> However, this had broken Eviivo's own external link - we have in the past asked Eviivo to provide a</d1p1:Content>
                      <d1p1:LineIndex>1041</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> nice display name field but until they do so we are going to have to do our own and pass both values through as hidden</d1p1:Content>
                      <d1p1:LineIndex>1042</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> form fields</d1p1:Content>
                      <d1p1:LineIndex>1043</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1044</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>bExternalSupplier</d1p1:Content>
                                <d1p1:LineIndex>1044</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1044</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSupplier</d1p1:Content>
                                    <d1p1:LineIndex>1045</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>1045</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>ID</d1p1:Content>
                                    <d1p1:LineIndex>1045</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierId</d1p1:Content>
                                    <d1p1:LineIndex>1045</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSupplier</d1p1:Content>
                                    <d1p1:LineIndex>1046</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>1046</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>DisplayName</d1p1:Content>
                                    <d1p1:LineIndex>1046</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierName</d1p1:Content>
                                    <d1p1:LineIndex>1046</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSupplier</d1p1:Content>
                                    <d1p1:LineIndex>1047</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>1047</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Quality</d1p1:Content>
                                    <d1p1:LineIndex>1047</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierQuality</d1p1:Content>
                                    <d1p1:LineIndex>1047</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSupplier</d1p1:Content>
                                    <d1p1:LineIndex>1048</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>1048</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Name</d1p1:Content>
                                    <d1p1:LineIndex>1048</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                                    <d1p1:LineIndex>1048</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                  <d1p1:Content>Null</d1p1:Content>
                                  <d1p1:LineIndex>1050</d1p1:LineIndex>
                                  <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strSupplierId</d1p1:Content>
                                  <d1p1:LineIndex>1050</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                  <d1p1:Content>Null</d1p1:Content>
                                  <d1p1:LineIndex>1051</d1p1:LineIndex>
                                  <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strSupplierName</d1p1:Content>
                                  <d1p1:LineIndex>1051</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                  <d1p1:Content>Null</d1p1:Content>
                                  <d1p1:LineIndex>1052</d1p1:LineIndex>
                                  <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strSupplierQuality</d1p1:Content>
                                  <d1p1:LineIndex>1052</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                                  <d1p1:Content>Null</d1p1:Content>
                                  <d1p1:LineIndex>1053</d1p1:LineIndex>
                                  <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                                  <d1p1:LineIndex>1053</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d1p1:OptionalElseClause>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Render the actual options (wrap in the standard form tag)</d1p1:Content>
                      <d1p1:LineIndex>1056</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1057</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objSupplier</d1p1:Content>
                                <d1p1:LineIndex>1057</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1057</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>IsLocal</d1p1:Content>
                                <d1p1:LineIndex>1057</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1057</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                        <d1p1:Content>IsEmpty</d1p1:Content>
                                        <d1p1:LineIndex>1058</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>1058</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>IsExternalBooking</d1p1:Content>
                                        <d1p1:LineIndex>1058</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>1058</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:Statement">
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>InitExternalBookingSettings</d1p1:Content>
                                          <d1p1:LineIndex>1059</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>1059</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>1059</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause i:nil="true" />
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>1061</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>IsExternalBooking</d1p1:Content>
                                        <d1p1:LineIndex>1061</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>1061</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                                            <d1p1:LineIndex>1062</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>intBookingType</d1p1:Content>
                                            <d1p1:LineIndex>1062</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>DMS</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                            <d1p1:Content>.</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>GetProductEstateID</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OpenBrace">
                                            <d1p1:Content>(</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>intProdKey</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:CloseBrace">
                                            <d1p1:Content>)</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strProductEstateID</d1p1:Content>
                                            <d1p1:LineIndex>1063</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>GetExtBookUrlFromProductEstate</d1p1:Content>
                                            <d1p1:LineIndex>1064</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:OpenBrace">
                                            <d1p1:Content>(</d1p1:Content>
                                            <d1p1:LineIndex>1064</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strProductEstateID</d1p1:Content>
                                            <d1p1:LineIndex>1064</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:CloseBrace">
                                            <d1p1:Content>)</d1p1:Content>
                                            <d1p1:LineIndex>1064</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strExtBookUrl</d1p1:Content>
                                            <d1p1:LineIndex>1064</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause>
                                <d1p1:Statements>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>BOOKING_Local</d1p1:Content>
                                          <d1p1:LineIndex>1066</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>intBookingType</d1p1:Content>
                                          <d1p1:LineIndex>1066</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                </d1p1:Statements>
                              </d1p1:OptionalElseClause>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1068</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objSupplier</d1p1:Content>
                                <d1p1:LineIndex>1068</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1068</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>IsExternal</d1p1:Content>
                                <d1p1:LineIndex>1068</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1068</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:CommentStatement">
                              <d1p1:Content> 2011-07-20 DWR: We don't need to call InitExternalBookingSettings if dealing with an VB Polling product as</d1p1:Content>
                              <d1p1:LineIndex>1069</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CommentStatement">
                              <d1p1:Content> the next page should always be the Polling Exit (no point redirecting to another site which will then - if</d1p1:Content>
                              <d1p1:LineIndex>1070</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CommentStatement">
                              <d1p1:Content> it's an NM site - have to display another redirect page to book the product)</d1p1:Content>
                              <d1p1:LineIndex>1071</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>BOOKING_PollingRedirect</d1p1:Content>
                                    <d1p1:LineIndex>1072</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>intBookingType</d1p1:Content>
                                    <d1p1:LineIndex>1072</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:IfBlock">
                            <d1p1:ConditionalClauses>
                              <d1p1:IfBlock.IfBlockConditionSegment>
                                <d1p1:Condition>
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                      <d1p1:Content>IsEmpty</d1p1:Content>
                                      <d1p1:LineIndex>1074</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:OpenBrace">
                                      <d1p1:Content>(</d1p1:Content>
                                      <d1p1:LineIndex>1074</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>IsExternalBooking</d1p1:Content>
                                      <d1p1:LineIndex>1074</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CloseBrace">
                                      <d1p1:Content>)</d1p1:Content>
                                      <d1p1:LineIndex>1074</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d1p1:Condition>
                                <d1p1:Statements>
                                  <d2p1:anyType i:type="d1p1:Statement">
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>InitExternalBookingSettings</d1p1:Content>
                                        <d1p1:LineIndex>1075</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>1075</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>1075</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d2p1:anyType>
                                </d1p1:Statements>
                              </d1p1:IfBlock.IfBlockConditionSegment>
                            </d1p1:ConditionalClauses>
                            <d1p1:OptionalElseClause i:nil="true" />
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:IfBlock">
                            <d1p1:ConditionalClauses>
                              <d1p1:IfBlock.IfBlockConditionSegment>
                                <d1p1:Condition>
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:OpenBrace">
                                      <d1p1:Content>(</d1p1:Content>
                                      <d1p1:LineIndex>1077</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>IsExternalBooking</d1p1:Content>
                                      <d1p1:LineIndex>1077</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CloseBrace">
                                      <d1p1:Content>)</d1p1:Content>
                                      <d1p1:LineIndex>1077</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d1p1:Condition>
                                <d1p1:Statements>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                                          <d1p1:LineIndex>1078</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>intBookingType</d1p1:Content>
                                          <d1p1:LineIndex>1078</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>DMS</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>GetProductEstateID</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>intProdKey</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strProductEstateID</d1p1:Content>
                                          <d1p1:LineIndex>1079</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>GetExtBookUrlFromProductEstate</d1p1:Content>
                                          <d1p1:LineIndex>1080</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>1080</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strProductEstateID</d1p1:Content>
                                          <d1p1:LineIndex>1080</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>1080</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strExtBookUrl</d1p1:Content>
                                          <d1p1:LineIndex>1080</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                </d1p1:Statements>
                              </d1p1:IfBlock.IfBlockConditionSegment>
                            </d1p1:ConditionalClauses>
                            <d1p1:OptionalElseClause>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                  <d1p1:Expression>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>BOOKING_Eviivo</d1p1:Content>
                                        <d1p1:LineIndex>1082</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Expression>
                                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                  <d1p1:ValueToSet>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>intBookingType</d1p1:Content>
                                        <d1p1:LineIndex>1082</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:ValueToSet>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d1p1:OptionalElseClause>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d1p1:OptionalElseClause>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Local and FrontDesk both use current site name w/out logo</d1p1:Content>
                      <d1p1:LineIndex>1086</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> External Suppliers should have their own logo passed in</d1p1:Content>
                      <d1p1:LineIndex>1087</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> PW - 	moved this out of BookingUI_StayDetails_PollingHeader</d1p1:Content>
                      <d1p1:LineIndex>1088</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content>		we can now pass it to the hidden form fields</d1p1:Content>
                      <d1p1:LineIndex>1089</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content>		for use on the polling exit page</d1p1:Content>
                      <d1p1:LineIndex>1090</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1091</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objSupplier</d1p1:Content>
                                <d1p1:LineIndex>1091</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1091</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>IsExternal</d1p1:Content>
                                <d1p1:LineIndex>1091</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1091</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>objSupplier</d1p1:Content>
                                    <d1p1:LineIndex>1092</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                    <d1p1:Content>.</d1p1:Content>
                                    <d1p1:LineIndex>1092</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>Logo</d1p1:Content>
                                    <d1p1:LineIndex>1092</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierLogo</d1p1:Content>
                                    <d1p1:LineIndex>1092</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:IfBlock">
                              <d1p1:ConditionalClauses>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                        <d1p1:Content>Trim</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:StringToken">
                                        <d1p1:Content></d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:OperatorToken">
                                        <d1p1:Content>&amp;</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>strSupplierName</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                        <d1p1:Content>=</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:StringToken">
                                        <d1p1:Content></d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>1093</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                      <d1p1:Expression>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:StringToken">
                                            <d1p1:Content>Unnamed Supplier</d1p1:Content>
                                            <d1p1:LineIndex>1094</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:Expression>
                                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                      <d1p1:ValueToSet>
                                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                        <d1p1:Tokens>
                                          <d2p1:anyType i:type="d1p1:NameToken">
                                            <d1p1:Content>strSupplierName</d1p1:Content>
                                            <d1p1:LineIndex>1094</d1p1:LineIndex>
                                          </d2p1:anyType>
                                        </d1p1:Tokens>
                                      </d1p1:ValueToSet>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                                <d1p1:IfBlock.IfBlockConditionSegment>
                                  <d1p1:Condition>
                                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                    <d1p1:Tokens>
                                      <d2p1:anyType i:type="d1p1:OpenBrace">
                                        <d1p1:Content>(</d1p1:Content>
                                        <d1p1:LineIndex>1095</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:NameToken">
                                        <d1p1:Content>strSupplierLogo</d1p1:Content>
                                        <d1p1:LineIndex>1095</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                        <d1p1:Content>=</d1p1:Content>
                                        <d1p1:LineIndex>1095</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:StringToken">
                                        <d1p1:Content></d1p1:Content>
                                        <d1p1:LineIndex>1095</d1p1:LineIndex>
                                      </d2p1:anyType>
                                      <d2p1:anyType i:type="d1p1:CloseBrace">
                                        <d1p1:Content>)</d1p1:Content>
                                        <d1p1:LineIndex>1095</d1p1:LineIndex>
                                      </d2p1:anyType>
                                    </d1p1:Tokens>
                                  </d1p1:Condition>
                                  <d1p1:Statements>
                                    <d2p1:anyType i:type="d1p1:CommentStatement">
                                      <d1p1:Content> 2014-07-01 DWR: It's common for Eviivo to not return logo data for the Polling Providers so for most cases we take the Supplier Name (the</d1p1:Content>
                                      <d1p1:LineIndex>1096</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CommentStatement">
                                      <d1p1:Content> Eviivo version, rather than the "friendly" version that we maintain) and request the logo from ntop using it. For cases where Eviivo</d1p1:Content>
                                      <d1p1:LineIndex>1097</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CommentStatement">
                                      <d1p1:Content> results are treated as Polling results (see FogBugz 10386), we need a special case (the friendly name will always be "Eviivo" in</d1p1:Content>
                                      <d1p1:LineIndex>1098</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CommentStatement">
                                      <d1p1:Content> this case).</d1p1:Content>
                                      <d1p1:LineIndex>1099</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:IfBlock">
                                      <d1p1:ConditionalClauses>
                                        <d1p1:IfBlock.IfBlockConditionSegment>
                                          <d1p1:Condition>
                                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                            <d1p1:Tokens>
                                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                                <d1p1:Content>(</d1p1:Content>
                                                <d1p1:LineIndex>1100</d1p1:LineIndex>
                                              </d2p1:anyType>
                                              <d2p1:anyType i:type="d1p1:NameToken">
                                                <d1p1:Content>strSupplierName</d1p1:Content>
                                                <d1p1:LineIndex>1100</d1p1:LineIndex>
                                              </d2p1:anyType>
                                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                                <d1p1:Content>=</d1p1:Content>
                                                <d1p1:LineIndex>1100</d1p1:LineIndex>
                                              </d2p1:anyType>
                                              <d2p1:anyType i:type="d1p1:StringToken">
                                                <d1p1:Content>Eviivo</d1p1:Content>
                                                <d1p1:LineIndex>1100</d1p1:LineIndex>
                                              </d2p1:anyType>
                                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                                <d1p1:Content>)</d1p1:Content>
                                                <d1p1:LineIndex>1100</d1p1:LineIndex>
                                              </d2p1:anyType>
                                            </d1p1:Tokens>
                                          </d1p1:Condition>
                                          <d1p1:Statements>
                                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                              <d1p1:Expression>
                                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                                <d1p1:Tokens>
                                                  <d2p1:anyType i:type="d1p1:NameToken">
                                                    <d1p1:Content>Page</d1p1:Content>
                                                    <d1p1:LineIndex>1101</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                                    <d1p1:Content>.</d1p1:Content>
                                                    <d1p1:LineIndex>1101</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:NameToken">
                                                    <d1p1:Content>ImageResource</d1p1:Content>
                                                    <d1p1:LineIndex>1101</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:OpenBrace">
                                                    <d1p1:Content>(</d1p1:Content>
                                                    <d1p1:LineIndex>1101</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:StringToken">
                                                    <d1p1:Content>bookonline/unitselection/polling/eviivo</d1p1:Content>
                                                    <d1p1:LineIndex>1102</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                                    <d1p1:Content>,</d1p1:Content>
                                                    <d1p1:LineIndex>1102</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:StringToken">
                                                    <d1p1:Content>/engine/shared_gfx/eviiopollingresult.jpg</d1p1:Content>
                                                    <d1p1:LineIndex>1103</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                  <d2p1:anyType i:type="d1p1:CloseBrace">
                                                    <d1p1:Content>)</d1p1:Content>
                                                    <d1p1:LineIndex>1104</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                </d1p1:Tokens>
                                              </d1p1:Expression>
                                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                              <d1p1:ValueToSet>
                                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                                <d1p1:Tokens>
                                                  <d2p1:anyType i:type="d1p1:NameToken">
                                                    <d1p1:Content>strSupplierLogo</d1p1:Content>
                                                    <d1p1:LineIndex>1101</d1p1:LineIndex>
                                                  </d2p1:anyType>
                                                </d1p1:Tokens>
                                              </d1p1:ValueToSet>
                                            </d2p1:anyType>
                                          </d1p1:Statements>
                                        </d1p1:IfBlock.IfBlockConditionSegment>
                                      </d1p1:ConditionalClauses>
                                      <d1p1:OptionalElseClause>
                                        <d1p1:Statements>
                                          <d2p1:anyType i:type="d1p1:CommentStatement">
                                            <d1p1:Content> 2008-12-09 DWR: Supplier Logo isn't actually going to be received from the Eviivo Component, we mash Supplier Name into this url</d1p1:Content>
                                            <d1p1:LineIndex>1106</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:CommentStatement">
                                            <d1p1:Content> 2010-03-04 DWR: Eviivo moved the logo location..</d1p1:Content>
                                            <d1p1:LineIndex>1107</d1p1:LineIndex>
                                          </d2p1:anyType>
                                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                            <d1p1:Expression>
                                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                              <d1p1:Tokens>
                                                <d2p1:anyType i:type="d1p1:StringToken">
                                                  <d1p1:Content>http://www.ntopsearch.com/media/images/Suppliers/</d1p1:Content>
                                                  <d1p1:LineIndex>1108</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:OperatorToken">
                                                  <d1p1:Content>&amp;</d1p1:Content>
                                                  <d1p1:LineIndex>1108</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:NameToken">
                                                  <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                                                  <d1p1:LineIndex>1108</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:OperatorToken">
                                                  <d1p1:Content>&amp;</d1p1:Content>
                                                  <d1p1:LineIndex>1108</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:StringToken">
                                                  <d1p1:Content>.gif</d1p1:Content>
                                                  <d1p1:LineIndex>1108</d1p1:LineIndex>
                                                </d2p1:anyType>
                                              </d1p1:Tokens>
                                            </d1p1:Expression>
                                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                            <d1p1:ValueToSet>
                                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                              <d1p1:Tokens>
                                                <d2p1:anyType i:type="d1p1:NameToken">
                                                  <d1p1:Content>strSupplierLogo</d1p1:Content>
                                                  <d1p1:LineIndex>1108</d1p1:LineIndex>
                                                </d2p1:anyType>
                                              </d1p1:Tokens>
                                            </d1p1:ValueToSet>
                                          </d2p1:anyType>
                                        </d1p1:Statements>
                                      </d1p1:OptionalElseClause>
                                    </d2p1:anyType>
                                  </d1p1:Statements>
                                </d1p1:IfBlock.IfBlockConditionSegment>
                              </d1p1:ConditionalClauses>
                              <d1p1:OptionalElseClause i:nil="true" />
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> 2009-02-12 DWR: Changed the way in which supplier name and logo are determined for Local / FrontDesk</d1p1:Content>
                            <d1p1:LineIndex>1112</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> suppliers (ie. the non-external entries) - before it had no logo and displayed the site name, now</d1p1:Content>
                            <d1p1:LineIndex>1113</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> these are the defaults, but content can be pulled from languages xml. This content can be specified</d1p1:Content>
                            <d1p1:LineIndex>1114</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> to vary per estate if desired (intended to be used when VB Polling is combined with Force External</d1p1:Content>
                            <d1p1:LineIndex>1115</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> Bookings)</d1p1:Content>
                            <d1p1:LineIndex>1116</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> - Supplier Name</d1p1:Content>
                            <d1p1:LineIndex>1117</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:StringToken">
                                  <d1p1:Content></d1p1:Content>
                                  <d1p1:LineIndex>1118</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strSupplierName</d1p1:Content>
                                  <d1p1:LineIndex>1118</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:IfBlock">
                            <d1p1:ConditionalClauses>
                              <d1p1:IfBlock.IfBlockConditionSegment>
                                <d1p1:Condition>
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>IsExternalBooking</d1p1:Content>
                                      <d1p1:LineIndex>1119</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d1p1:Condition>
                                <d1p1:Statements>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Page</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Resource</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>bookonline/unitselection/polling/localsupplier/estate_</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strProductEstateID</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OperatorToken">
                                          <d1p1:Content>&amp;</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>/name</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content></d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strSupplierName</d1p1:Content>
                                          <d1p1:LineIndex>1120</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                </d1p1:Statements>
                              </d1p1:IfBlock.IfBlockConditionSegment>
                            </d1p1:ConditionalClauses>
                            <d1p1:OptionalElseClause i:nil="true" />
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:IfBlock">
                            <d1p1:ConditionalClauses>
                              <d1p1:IfBlock.IfBlockConditionSegment>
                                <d1p1:Condition>
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:OpenBrace">
                                      <d1p1:Content>(</d1p1:Content>
                                      <d1p1:LineIndex>1122</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>strSupplierName</d1p1:Content>
                                      <d1p1:LineIndex>1122</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                      <d1p1:Content>=</d1p1:Content>
                                      <d1p1:LineIndex>1122</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content></d1p1:Content>
                                      <d1p1:LineIndex>1122</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:CloseBrace">
                                      <d1p1:Content>)</d1p1:Content>
                                      <d1p1:LineIndex>1122</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d1p1:Condition>
                                <d1p1:Statements>
                                  <d2p1:anyType i:type="d1p1:CommentStatement">
                                    <d1p1:Content>#MJ -	the resource manage is the same for both main sites and channel sites</d1p1:Content>
                                    <d1p1:LineIndex>1123</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CommentStatement">
                                    <d1p1:Content>		therefore we can never use Page.Site.Name as an alternative value as this would be cached wrongly by the ResourceManager</d1p1:Content>
                                    <d1p1:LineIndex>1124</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:CommentStatement">
                                    <d1p1:Content>		so try to pull one from there, if not fall back to the site name</d1p1:Content>
                                    <d1p1:LineIndex>1125</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                    <d1p1:Expression>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Page</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                          <d1p1:Content>.</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>Resource</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:OpenBrace">
                                          <d1p1:Content>(</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content>bookonline/unitselection/polling/localsupplier/name</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                          <d1p1:Content>,</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:StringToken">
                                          <d1p1:Content></d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                        <d2p1:anyType i:type="d1p1:CloseBrace">
                                          <d1p1:Content>)</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:Expression>
                                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                    <d1p1:ValueToSet>
                                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                      <d1p1:Tokens>
                                        <d2p1:anyType i:type="d1p1:NameToken">
                                          <d1p1:Content>strSupplierName</d1p1:Content>
                                          <d1p1:LineIndex>1126</d1p1:LineIndex>
                                        </d2p1:anyType>
                                      </d1p1:Tokens>
                                    </d1p1:ValueToSet>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:IfBlock">
                                    <d1p1:ConditionalClauses>
                                      <d1p1:IfBlock.IfBlockConditionSegment>
                                        <d1p1:Condition>
                                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                          <d1p1:Tokens>
                                            <d2p1:anyType i:type="d1p1:NameToken">
                                              <d1p1:Content>strSupplierName</d1p1:Content>
                                              <d1p1:LineIndex>1127</d1p1:LineIndex>
                                            </d2p1:anyType>
                                            <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                              <d1p1:Content>=</d1p1:Content>
                                              <d1p1:LineIndex>1127</d1p1:LineIndex>
                                            </d2p1:anyType>
                                            <d2p1:anyType i:type="d1p1:StringToken">
                                              <d1p1:Content></d1p1:Content>
                                              <d1p1:LineIndex>1127</d1p1:LineIndex>
                                            </d2p1:anyType>
                                          </d1p1:Tokens>
                                        </d1p1:Condition>
                                        <d1p1:Statements>
                                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                                            <d1p1:Expression>
                                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                              <d1p1:Tokens>
                                                <d2p1:anyType i:type="d1p1:NameToken">
                                                  <d1p1:Content>Page</d1p1:Content>
                                                  <d1p1:LineIndex>1128</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                                  <d1p1:Content>.</d1p1:Content>
                                                  <d1p1:LineIndex>1128</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:NameToken">
                                                  <d1p1:Content>Site</d1p1:Content>
                                                  <d1p1:LineIndex>1128</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                                  <d1p1:Content>.</d1p1:Content>
                                                  <d1p1:LineIndex>1128</d1p1:LineIndex>
                                                </d2p1:anyType>
                                                <d2p1:anyType i:type="d1p1:NameToken">
                                                  <d1p1:Content>Name</d1p1:Content>
                                                  <d1p1:LineIndex>1128</d1p1:LineIndex>
                                                </d2p1:anyType>
                                              </d1p1:Tokens>
                                            </d1p1:Expression>
                                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                                            <d1p1:ValueToSet>
                                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                              <d1p1:Tokens>
                                                <d2p1:anyType i:type="d1p1:NameToken">
                                                  <d1p1:Content>strSupplierName</d1p1:Content>
                                                  <d1p1:LineIndex>1128</d1p1:LineIndex>
                                                </d2p1:anyType>
                                              </d1p1:Tokens>
                                            </d1p1:ValueToSet>
                                          </d2p1:anyType>
                                        </d1p1:Statements>
                                      </d1p1:IfBlock.IfBlockConditionSegment>
                                    </d1p1:ConditionalClauses>
                                    <d1p1:OptionalElseClause i:nil="true" />
                                  </d2p1:anyType>
                                </d1p1:Statements>
                              </d1p1:IfBlock.IfBlockConditionSegment>
                            </d1p1:ConditionalClauses>
                            <d1p1:OptionalElseClause i:nil="true" />
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CommentStatement">
                            <d1p1:Content> - Supplier Logo</d1p1:Content>
                            <d1p1:LineIndex>1131</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>GetSupplierLogo</d1p1:Content>
                                  <d1p1:LineIndex>1132</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OpenBrace">
                                  <d1p1:Content>(</d1p1:Content>
                                  <d1p1:LineIndex>1132</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strProductEstateID</d1p1:Content>
                                  <d1p1:LineIndex>1132</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:CloseBrace">
                                  <d1p1:Content>)</d1p1:Content>
                                  <d1p1:LineIndex>1132</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strSupplierLogo</d1p1:Content>
                                  <d1p1:LineIndex>1132</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:BlankLine" />
                        </d1p1:Statements>
                      </d1p1:OptionalElseClause>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> 2013-02-05 TB: objRenderSettings is used by RenderBookingInfoForm to populate some hidden stay information</d1p1:Content>
                      <d1p1:LineIndex>1136</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> For fuzzy stays, both nights and startdate may differ from the original requirements.</d1p1:Content>
                      <d1p1:LineIndex>1137</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> For FogBugz case 7594 I added the second line below which wasn't present.</d1p1:Content>
                      <d1p1:LineIndex>1138</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>StartDate</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingRequirement</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>VisitDate</d1p1:Content>
                            <d1p1:LineIndex>1139</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Nights</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingRequirement</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Nights</d1p1:Content>
                            <d1p1:LineIndex>1140</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> 2014-03-12 DWR: We need to pass the Search Industry Classification into the form rendering code for VB Polling Products so that the</d1p1:Content>
                      <d1p1:LineIndex>1142</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Polling Exist can generate the deep link correctly. An Eviivo Configset can be set up with zero, meaning support either 1 OR 9. The</d1p1:Content>
                      <d1p1:LineIndex>1143</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Avail Component will perform searches for both in that case but only allow any Products to return results for one. Since we won't</d1p1:Content>
                      <d1p1:LineIndex>1144</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> get an objSupplier reference with zero units (since that would mean it's not got availability and we're only looking at available</d1p1:Content>
                      <d1p1:LineIndex>1145</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> options here) we can just grab the IndustryClassification values from the first Unit since it is guaranteed to be consistent</d1p1:Content>
                      <d1p1:LineIndex>1146</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> across all Units for this booking option. The IndustryClassification value will be zero for non-Eviivo data but that won't</d1p1:Content>
                      <d1p1:LineIndex>1147</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> matter since it's only ever consider in the Polling Exit which is for Eviivo results only.</d1p1:Content>
                      <d1p1:LineIndex>1148</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>RenderBookingInfoForm</d1p1:Content>
                          <d1p1:LineIndex>1149</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>1150</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1150</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>intProdKey</d1p1:Content>
                          <d1p1:LineIndex>1151</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1151</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objRenderSettings</d1p1:Content>
                          <d1p1:LineIndex>1152</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1152</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>intBookingType</d1p1:Content>
                          <d1p1:LineIndex>1153</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1153</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierId</d1p1:Content>
                          <d1p1:LineIndex>1154</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1154</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierName</d1p1:Content>
                          <d1p1:LineIndex>1155</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1155</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierEviivoName</d1p1:Content>
                          <d1p1:LineIndex>1156</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1156</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierQuality</d1p1:Content>
                          <d1p1:LineIndex>1157</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1157</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierLogo</d1p1:Content>
                          <d1p1:LineIndex>1158</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1158</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objSupplier</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Units</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>GetItem</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>0</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>IndustryClassification</d1p1:Content>
                          <d1p1:LineIndex>1159</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingUI_StayDetails_PollingHeader</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objSupplier</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierLogo</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strSupplierName</d1p1:Content>
                          <d1p1:LineIndex>1161</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> 2009-09-14 DWR: Forcing iStayNum to "1" every time - since we are clearly only having</d1p1:Content>
                      <d1p1:LineIndex>1164</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> one stay per form (since we open the form above - in RenderBookingInfoForm - and we</d1p1:Content>
                      <d1p1:LineIndex>1165</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> close it below) we'll always be passing only a single stay to the next stage. This</d1p1:Content>
                      <d1p1:LineIndex>1166</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> makes things easier - the multiple-stays-per-form idea was ridiculous.</d1p1:Content>
                      <d1p1:LineIndex>1167</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> 2010-10-21 TB: Changing back to use unique stay index. Multiple stays per form will</d1p1:Content>
                      <d1p1:LineIndex>1168</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> happen for fuzzy results and calendar view. html ids use the stay key, as does the JS</d1p1:Content>
                      <d1p1:LineIndex>1169</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> when choosing to show/hide the book now button.</d1p1:Content>
                      <d1p1:LineIndex>1170</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingUI_StayDetails</d1p1:Content>
                          <d1p1:LineIndex>1171</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objSupplier</d1p1:Content>
                          <d1p1:LineIndex>1172</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1172</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>intIndex</d1p1:Content>
                          <d1p1:LineIndex>1173</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1173</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>dStartNight</d1p1:Content>
                          <d1p1:LineIndex>1174</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1174</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iNights</d1p1:Content>
                          <d1p1:LineIndex>1175</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1175</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>bIsTeleBooking</d1p1:Content>
                          <d1p1:LineIndex>1176</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1176</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
                          <d1p1:LineIndex>1177</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1177</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strEviivoIdIfAny</d1p1:Content>
                          <d1p1:LineIndex>1178</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1178</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objRenderSettings</d1p1:Content>
                          <d1p1:LineIndex>1179</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1179</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>ProductKey</d1p1:Content>
                          <d1p1:LineIndex>1179</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1179</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objRenderSettings</d1p1:Content>
                          <d1p1:LineIndex>1180</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1180</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Channel</d1p1:Content>
                          <d1p1:LineIndex>1180</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1180</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                          <d1p1:LineIndex>1181</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1181</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Indicative</d1p1:Content>
                          <d1p1:LineIndex>1181</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1181</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                          <d1p1:Content>Not</d1p1:Content>
                          <d1p1:LineIndex>1182</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objFuzzyStay</d1p1:Content>
                          <d1p1:LineIndex>1182</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1182</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>HasInvalidIndicative</d1p1:Content>
                          <d1p1:LineIndex>1182</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1182</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objAllUnits</d1p1:Content>
                          <d1p1:LineIndex>1183</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1183</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                          <d1p1:Content>Nothing</d1p1:Content>
                          <d1p1:LineIndex>1184</d1p1:LineIndex>
                          <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1184</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>1185</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1185</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                          <d1p1:Content>false</d1p1:Content>
                          <d1p1:LineIndex>1186</d1p1:LineIndex>
                          <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:InlineCommentStatement">
                      <d1p1:Content>we can't render the maximum available units for polling</d1p1:Content>
                      <d1p1:LineIndex>1186</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>1188</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1188</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>1188</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/form&gt;</d1p1:Content>
                          <d1p1:LineIndex>1188</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>RenderNoAvailElement</d1p1:Content>
        <d1p1:LineIndex>1196</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>1196</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>1198</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>1198</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1198</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>OutputWriter</d1p1:Content>
                <d1p1:LineIndex>1198</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>1198</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1199</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1199</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1199</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnNoAvail"&gt;</d1p1:Content>
              <d1p1:LineIndex>1199</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/unitselection/noavailability</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;p&gt;No availability for this product for the specified date. This may occur if the accommodation is booked prior to your arrival at this page.&lt;/p&gt;</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>1200</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1201</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1201</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1201</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1201</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objRenderSettings</d1p1:Content>
                    <d1p1:LineIndex>1203</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1203</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>RenderAsCalendar</d1p1:Content>
                    <d1p1:LineIndex>1203</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:DimStatement">
                  <d1p1:Variables>
                    <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                      <d1p1:Dimensions i:nil="true" />
                      <d1p1:Name>
                        <d1p1:Content>strClassMonth</d1p1:Content>
                        <d1p1:LineIndex>1205</d1p1:LineIndex>
                      </d1p1:Name>
                    </d1p1:DimVariable>
                  </d1p1:Variables>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>MonthWrapper</d1p1:Content>
                        <d1p1:LineIndex>1205</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strClassMonth</d1p1:Content>
                        <d1p1:LineIndex>1205</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1207</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1207</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1207</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="CalendarsWrapper"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1207</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content></d1p1:Content>
                  <d1p1:LineIndex>1208</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderCalendarMonth</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingRequirement</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>VisitDate</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strClassMonth</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> currentmonth</d1p1:Content>
                      <d1p1:LineIndex>1209</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content>					' last day + 1 to get the first day of the next month for the calendar</d1p1:Content>
                  <d1p1:LineIndex>1210</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderCalendarMonth</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Functions</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Dates</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>fn_GetLastDateOfMonth</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingRequirement</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>VisitDate</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>+</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NumericValueToken">
                      <d1p1:Content>1</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strClassMonth</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> nextmonth</d1p1:Content>
                      <d1p1:LineIndex>1211</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> global count used to track how many calendars have been added to the output for the prev/next buttons</d1p1:Content>
                  <d1p1:LineIndex>1213</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>2</d1p1:Content>
                        <d1p1:LineIndex>1214</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>g_iNumberOfCalendarsRendered</d1p1:Content>
                        <d1p1:LineIndex>1214</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderAvailCalLinks</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingRequirement</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>VisitDate</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1216</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderAvailCalKey</d1p1:Content>
                      <d1p1:LineIndex>1217</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1217</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1218</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1218</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1218</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>1218</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1220</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1220</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1220</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;script type="text/javascript"&gt;NewMind.ETWP.Booking.UpdateCalLinks();&lt;/</d1p1:Content>
                      <d1p1:LineIndex>1220</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1220</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>script&gt;</d1p1:Content>
                      <d1p1:LineIndex>1220</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>1225</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Main entry point when VB Polling is disabled (or handling tickets, not acco products)</d1p1:Content>
      <d1p1:LineIndex>1226</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>1227</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayMain_Legacy</d1p1:Content>
        <d1p1:LineIndex>1228</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objData</d1p1:Content>
            <d1p1:LineIndex>1228</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objRenderSettings</d1p1:Content>
            <d1p1:LineIndex>1228</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> This is the non-VB-Polling approach (supports EITHER FrontDesk OR local availability for accommodation)</d1p1:Content>
          <d1p1:LineIndex>1229</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>reset the output variable to our OutputWriter</d1p1:Content>
          <d1p1:LineIndex>1230</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>1231</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objRenderSettings</d1p1:Content>
                <d1p1:LineIndex>1231</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1231</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>OutputWriter</d1p1:Content>
                <d1p1:LineIndex>1231</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>pO</d1p1:Content>
                <d1p1:LineIndex>1231</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intBookingType</d1p1:Content>
                <d1p1:LineIndex>1233</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bNoResults</d1p1:Content>
                <d1p1:LineIndex>1234</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                <d1p1:LineIndex>1235</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objFuzzyStay</d1p1:Content>
                <d1p1:LineIndex>1235</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objSuppliersForStay</d1p1:Content>
                <d1p1:LineIndex>1236</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>1237</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                <d1p1:LineIndex>1238</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>1240</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objData</d1p1:Content>
                <d1p1:LineIndex>1240</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1240</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Availability</d1p1:Content>
                <d1p1:LineIndex>1240</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>1240</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>1241</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objData</d1p1:Content>
                <d1p1:LineIndex>1241</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1241</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Product_Key</d1p1:Content>
                <d1p1:LineIndex>1241</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intProdKey</d1p1:Content>
                <d1p1:LineIndex>1241</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bIsTeleBooking</d1p1:Content>
                <d1p1:LineIndex>1243</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objData</d1p1:Content>
                <d1p1:LineIndex>1243</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1243</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IsOnTeleBookingChannel</d1p1:Content>
                <d1p1:LineIndex>1243</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bIsTeleBooking</d1p1:Content>
                <d1p1:LineIndex>1243</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Grab hold of the data (in this method, there should only ever be zero or one fuzzy</d1p1:Content>
          <d1p1:LineIndex>1245</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> stay options, as the BookingUI_StayMain_Legacy method handle fuzzy availability)</d1p1:Content>
          <d1p1:LineIndex>1246</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvail</d1p1:Content>
                <d1p1:LineIndex>1247</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1247</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetUniqueFuzzyCombinations</d1p1:Content>
                <d1p1:LineIndex>1247</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1247</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1247</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                <d1p1:LineIndex>1247</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1248</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1249</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1249</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                      <d1p1:LineIndex>1249</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>objAvail.GetUniqueFuzzyCombinations reported zero stay options</d1p1:Content>
                      <d1p1:LineIndex>1249</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>True</d1p1:Content>
                        <d1p1:LineIndex>1250</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bNoResults</d1p1:Content>
                        <d1p1:LineIndex>1250</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> Any suppliers returned here will be sorted with Local / NewMind first, then FrontDesk</d1p1:Content>
                <d1p1:LineIndex>1252</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> second (if we have both) - if there are multiple, it should always be the first one</d1p1:Content>
                <d1p1:LineIndex>1253</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CommentStatement">
                <d1p1:Content> that we want</d1p1:Content>
                <d1p1:LineIndex>1254</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objFuzzyStayOptions</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>GetItem</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NumericValueToken">
                      <d1p1:Content>0</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objFuzzyStay</d1p1:Content>
                      <d1p1:LineIndex>1255</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>PrintTrace</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>BookingUI_StayMain_Legacy: Get data for stay - </d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStay</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>StartDate</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>, </d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objFuzzyStay</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Nights</d1p1:Content>
                    <d1p1:LineIndex>1256</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objAvail</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>GetSupplierUnitDataForStay</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objFuzzyStay</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>StartDate</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objFuzzyStay</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Nights</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objSuppliersForStay</d1p1:Content>
                      <d1p1:LineIndex>1257</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:IfBlock">
                <d1p1:ConditionalClauses>
                  <d1p1:IfBlock.IfBlockConditionSegment>
                    <d1p1:Condition>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objSuppliersForStay</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Count</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                          <d1p1:Content>=</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>0</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1258</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Condition>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>1259</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1259</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>PrintTraceWarning</d1p1:Content>
                            <d1p1:LineIndex>1259</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>objAvail.GetSupplierUnitDataForStay reported zero suppliers</d1p1:Content>
                            <d1p1:LineIndex>1259</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                              <d1p1:Content>True</d1p1:Content>
                              <d1p1:LineIndex>1260</d1p1:LineIndex>
                              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>bNoResults</d1p1:Content>
                              <d1p1:LineIndex>1260</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:IfBlock.IfBlockConditionSegment>
                </d1p1:ConditionalClauses>
                <d1p1:OptionalElseClause>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objSuppliersForStay</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>GetItem</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objAvailEntry</d1p1:Content>
                            <d1p1:LineIndex>1262</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>False</d1p1:Content>
                            <d1p1:LineIndex>1263</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bNoResults</d1p1:Content>
                            <d1p1:LineIndex>1263</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:OptionalElseClause>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Open form and prepare to wrap content in "staySelection" container</d1p1:Content>
          <d1p1:LineIndex>1267</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsExternalBooking</d1p1:Content>
                    <d1p1:LineIndex>1268</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1268</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BOOKING_Redirect</d1p1:Content>
                        <d1p1:LineIndex>1269</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intBookingType</d1p1:Content>
                        <d1p1:LineIndex>1269</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BOOKING_Local</d1p1:Content>
                      <d1p1:LineIndex>1271</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>intBookingType</d1p1:Content>
                      <d1p1:LineIndex>1271</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>RenderBookingInfoForm</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>intProdKey</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objRenderSettings</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>intBookingType</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>Null</d1p1:Content>
              <d1p1:LineIndex>1274</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1276</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1276</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1276</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="staySelection"&gt;</d1p1:Content>
              <d1p1:LineIndex>1276</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Render info (or display warning if no availability)</d1p1:Content>
          <d1p1:LineIndex>1278</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bNoResults</d1p1:Content>
                    <d1p1:LineIndex>1279</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>RenderNoAvailElement</d1p1:Content>
                      <d1p1:LineIndex>1280</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objRenderSettings</d1p1:Content>
                      <d1p1:LineIndex>1280</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>False</d1p1:Content>
                        <d1p1:LineIndex>1281</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bProdHasAvail</d1p1:Content>
                        <d1p1:LineIndex>1281</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:InlineCommentStatement">
                  <d1p1:Content> This is exposed through the WSC's public property "ProdHasAvail"</d1p1:Content>
                  <d1p1:LineIndex>1281</d1p1:LineIndex>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>True</d1p1:Content>
                      <d1p1:LineIndex>1283</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>bProdHasAvail</d1p1:Content>
                      <d1p1:LineIndex>1283</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:InlineCommentStatement">
                <d1p1:Content> This is exposed through the WSC's public property "ProdHasAvail"</d1p1:Content>
                <d1p1:LineIndex>1283</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:IfBlock">
                <d1p1:ConditionalClauses>
                  <d1p1:IfBlock.IfBlockConditionSegment>
                    <d1p1:Condition>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objRenderSettings</d1p1:Content>
                          <d1p1:LineIndex>1284</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1284</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingType</d1p1:Content>
                          <d1p1:LineIndex>1284</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                          <d1p1:Content>=</d1p1:Content>
                          <d1p1:LineIndex>1284</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>accommodation</d1p1:Content>
                          <d1p1:LineIndex>1284</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Condition>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> Retrieve any unit selections that have been passed in through the querystring</d1p1:Content>
                        <d1p1:LineIndex>1286</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> - eg. when VisitBritain hooks in to complete a booking</d1p1:Content>
                        <d1p1:LineIndex>1287</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> There will be an entry in lsUnitSelections for each requirement.</d1p1:Content>
                        <d1p1:LineIndex>1288</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> Note that ReqNo in the avail data is one-based while the lsUnitSelections indices</d1p1:Content>
                        <d1p1:LineIndex>1289</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> are zero-based, so the UnitKey for ReqNo 1 = lsUnitSelections(0). If there was no</d1p1:Content>
                        <d1p1:LineIndex>1290</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> selection made for a ReqNo, the lsUnitSelections value will be zero.</d1p1:Content>
                        <d1p1:LineIndex>1291</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> NB: This value might be Nothing if no selections are passed in on querystring.</d1p1:Content>
                        <d1p1:LineIndex>1292</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                        <d1p1:Expression>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>BookingUI_UnitSel_GetOptionsRemoteSelected</d1p1:Content>
                              <d1p1:LineIndex>1293</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1293</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>objAvailEntry</d1p1:Content>
                              <d1p1:LineIndex>1293</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1293</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:Expression>
                        <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                        <d1p1:ValueToSet>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                              <d1p1:LineIndex>1293</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:ValueToSet>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> Render the unit selection options (pass "1" as iStayNum parameter - we'll only</d1p1:Content>
                        <d1p1:LineIndex>1295</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> be rendering a single stay option here, since fuzzy isn't supported in this</d1p1:Content>
                        <d1p1:LineIndex>1296</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CommentStatement">
                        <d1p1:Content> configuration..)</d1p1:Content>
                        <d1p1:LineIndex>1297</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingUI_StayDetails</d1p1:Content>
                            <d1p1:LineIndex>1298</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objAvailEntry</d1p1:Content>
                            <d1p1:LineIndex>1299</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1299</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>1</d1p1:Content>
                            <d1p1:LineIndex>1300</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1300</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>1301</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1301</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingRequirement</d1p1:Content>
                            <d1p1:LineIndex>1301</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1301</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>VisitDate</d1p1:Content>
                            <d1p1:LineIndex>1301</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1301</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>1302</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1302</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingRequirement</d1p1:Content>
                            <d1p1:LineIndex>1302</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1302</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Nights</d1p1:Content>
                            <d1p1:LineIndex>1302</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1302</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bIsTeleBooking</d1p1:Content>
                            <d1p1:LineIndex>1303</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1303</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objData</d1p1:Content>
                            <d1p1:LineIndex>1304</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1304</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bookingweb</d1p1:Content>
                            <d1p1:LineIndex>1304</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1304</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objData</d1p1:Content>
                            <d1p1:LineIndex>1305</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1305</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>EviivoId</d1p1:Content>
                            <d1p1:LineIndex>1305</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1305</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intProdKey</d1p1:Content>
                            <d1p1:LineIndex>1306</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1306</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>1307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Channel</d1p1:Content>
                            <d1p1:LineIndex>1307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1307</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                            <d1p1:LineIndex>1308</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1308</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Indicative</d1p1:Content>
                            <d1p1:LineIndex>1308</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1308</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                            <d1p1:Content>Not</d1p1:Content>
                            <d1p1:LineIndex>1309</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objFuzzyStay</d1p1:Content>
                            <d1p1:LineIndex>1309</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1309</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>HasInvalidIndicative</d1p1:Content>
                            <d1p1:LineIndex>1309</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1309</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objData</d1p1:Content>
                            <d1p1:LineIndex>1310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Units</d1p1:Content>
                            <d1p1:LineIndex>1310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1310</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                            <d1p1:LineIndex>1311</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1311</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>1312</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1312</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objRenderSettings</d1p1:Content>
                            <d1p1:LineIndex>1313</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1313</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>RenderMaximumUnitsAvailable</d1p1:Content>
                            <d1p1:LineIndex>1313</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BlankLine" />
                    </d1p1:Statements>
                  </d1p1:IfBlock.IfBlockConditionSegment>
                </d1p1:ConditionalClauses>
                <d1p1:OptionalElseClause>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingUI_TicketsSummary</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objAvailEntry</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objRenderSettings</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingRequirement</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>VisitDate</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>1316</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:OptionalElseClause>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Close "staySelection" div and form</d1p1:Content>
          <d1p1:LineIndex>1320</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1321</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1321</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1321</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1321</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1322</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1322</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1322</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/form&gt;</d1p1:Content>
              <d1p1:LineIndex>1322</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ==========================================================================================================</d1p1:Content>
      <d1p1:LineIndex>1326</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> These functions are all about assigning unit selections when the booking process is hooked into from an</d1p1:Content>
      <d1p1:LineIndex>1327</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> external site (eg. VisitBritain).</d1p1:Content>
      <d1p1:LineIndex>1328</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>1329</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> The other site will have requested availability data through the webservice and the order in which</d1p1:Content>
      <d1p1:LineIndex>1330</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> the options appear there may vary from the order that they're returned from the availability object's</d1p1:Content>
      <d1p1:LineIndex>1331</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> queries.</d1p1:Content>
      <d1p1:LineIndex>1332</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>1333</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> These functions are intended to pick up on selections in the querystring and match them back up to</d1p1:Content>
      <d1p1:LineIndex>1334</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> the ReqNo entries.</d1p1:Content>
      <d1p1:LineIndex>1335</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content></d1p1:Content>
      <d1p1:LineIndex>1336</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> Selections passed in are given as parameters of the form</d1p1:Content>
      <d1p1:LineIndex>1337</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  URslt1=12345,1,1</d1p1:Content>
      <d1p1:LineIndex>1338</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> where the comma-separated values are UnitKey, number of adults, number of children.</d1p1:Content>
      <d1p1:LineIndex>1339</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> The "1" in "URslt1" is expected to match up with ReqNo 1 when passed through, but the problem is that</d1p1:Content>
      <d1p1:LineIndex>1340</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> this often isn't the case.</d1p1:Content>
      <d1p1:LineIndex>1341</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ==========================================================================================================</d1p1:Content>
      <d1p1:LineIndex>1342</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: prepare a list of UnitKey selections for each ReqNo is availability recordset</d1p1:Content>
      <d1p1:LineIndex>1344</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [rsAvail]: ADO unit recordset from availability object</d1p1:Content>
      <d1p1:LineIndex>1345</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: clsList with as many values as there are ReqNo entries, containing the UnitKey for each one</d1p1:Content>
      <d1p1:LineIndex>1346</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_UnitSel_GetOptionsRemoteSelected</d1p1:Content>
        <d1p1:LineIndex>1347</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvailEntry</d1p1:Content>
            <d1p1:LineIndex>1347</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndex</d1p1:Content>
                <d1p1:LineIndex>1348</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>1348</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                <d1p1:LineIndex>1349</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                <d1p1:LineIndex>1350</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intUnitSel</d1p1:Content>
                <d1p1:LineIndex>1351</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsUnitKeys</d1p1:Content>
                <d1p1:LineIndex>1352</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Build up a list of unit options:</d1p1:Content>
          <d1p1:LineIndex>1354</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Will get a list of objects where each object has properties:</d1p1:Content>
          <d1p1:LineIndex>1355</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; ReqNo (integer)</d1p1:Content>
          <d1p1:LineIndex>1356</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; NumPeople (integer)</d1p1:Content>
          <d1p1:LineIndex>1357</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; Units (list of integers)</d1p1:Content>
          <d1p1:LineIndex>1358</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - We're going to loop through the availability recordset, so must remember</d1p1:Content>
          <d1p1:LineIndex>1359</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   to return it back to the beginning when we're done</d1p1:Content>
          <d1p1:LineIndex>1360</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                <d1p1:LineIndex>1361</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Units</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1362</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>1362</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Units</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>GetItem</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndex</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Set</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objUnit</d1p1:Content>
                    <d1p1:LineIndex>1363</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:Statement">
              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
              <d1p1:Tokens>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>BookingUI_UnitSel_AddReqUnitOption</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objUnit</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>ReqNo</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objUnit</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>ReqSize</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objUnit</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>UnitKey</d1p1:Content>
                  <d1p1:LineIndex>1364</d1p1:LineIndex>
                </d2p1:anyType>
              </d1p1:Tokens>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content>BookingUI_UnitSel_AddReqUnitOption arrReqUnitOptions, objUnit.ReqNo, objUnit.UnitCount, objUnit.UnitKey</d1p1:Content>
              <d1p1:LineIndex>1365</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Build up a list of unit selections passed in from external site (eg. VisitBritain):</d1p1:Content>
          <d1p1:LineIndex>1368</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Will get a list of objects where each object has properties:</d1p1:Content>
          <d1p1:LineIndex>1369</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; NumPeople (integer)</d1p1:Content>
          <d1p1:LineIndex>1370</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; UnitKey (integer)</d1p1:Content>
          <d1p1:LineIndex>1371</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; PossReqNos (list of integers)</d1p1:Content>
          <d1p1:LineIndex>1372</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>       = list of ReqNo values that this may be</d1p1:Content>
          <d1p1:LineIndex>1373</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>         a user selection for</d1p1:Content>
          <d1p1:LineIndex>1374</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1375</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intUnitSel</d1p1:Content>
                <d1p1:LineIndex>1375</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                <d1p1:LineIndex>1376</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DoBlock">
          <d1p1:ConditionIfAny i:nil="true" />
          <d1p1:IsDoWhileCondition>true</d1p1:IsDoWhileCondition>
          <d1p1:IsPreCondition>false</d1p1:IsPreCondition>
          <d1p1:LineIndexOfStartOfConstruct>1377</d1p1:LineIndexOfStartOfConstruct>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intUnitSel</d1p1:Content>
                    <d1p1:LineIndex>1378</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>+</d1p1:Content>
                    <d1p1:LineIndex>1378</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>1378</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intUnitSel</d1p1:Content>
                    <d1p1:LineIndex>1378</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Len</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Request</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>URslt</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intUnitSel</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&gt;</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1379</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingUI_UnitSel_AddReqUnitSelection</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Request</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>URslt</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>intUnitSel</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                          <d1p1:LineIndex>1380</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause>
                <d1p1:Statements>
                  <d2p1:anyType i:type="d1p1:ExitStatement">
                    <d1p1:LineIndex>1382</d1p1:LineIndex>
                    <d1p1:StatementType>Do</d1p1:StatementType>
                  </d2p1:anyType>
                </d1p1:Statements>
              </d1p1:OptionalElseClause>
            </d2p1:anyType>
          </d1p1:Statements>
          <d1p1:SupportsExit>true</d1p1:SupportsExit>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If there were no selections passed in like this, return Nothing</d1p1:Content>
          <d1p1:LineIndex>1386</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1387</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:DimStatement">
                  <d1p1:Variables>
                    <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                      <d1p1:Dimensions i:nil="true" />
                      <d1p1:Name>
                        <d1p1:Content>BookingUI_UnitSel_GetOptionSelected</d1p1:Content>
                        <d1p1:LineIndex>1388</d1p1:LineIndex>
                      </d1p1:Name>
                    </d1p1:DimVariable>
                  </d1p1:Variables>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>Nothing</d1p1:Content>
                        <d1p1:LineIndex>1389</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_UnitSel_GetOptionSelected</d1p1:Content>
                        <d1p1:LineIndex>1389</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Now try to return matched unit options / selections</d1p1:Content>
          <d1p1:LineIndex>1392</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Get back a list of unit keys, one key per requirement</d1p1:Content>
          <d1p1:LineIndex>1393</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   (If failed to get a perfect match, some of these values may be zero)</d1p1:Content>
          <d1p1:LineIndex>1394</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_UnitSel_GetMatchedReqUnitSelection</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_UnitSel_GetOptionsRemoteSelected</d1p1:Content>
                <d1p1:LineIndex>1395</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_UnitSel_AddReqUnitOption</d1p1:Content>
        <d1p1:LineIndex>1399</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>arrReqUnitOptions</d1p1:Content>
            <d1p1:LineIndex>1399</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intReqNo</d1p1:Content>
            <d1p1:LineIndex>1399</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intNumPeople</d1p1:Content>
            <d1p1:LineIndex>1399</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intUnitKey</d1p1:Content>
            <d1p1:LineIndex>1399</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1400</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objEntryPrev</d1p1:Content>
                <d1p1:LineIndex>1400</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Input list SHOULD be initialised as an empty list, but just in case..</d1p1:Content>
          <d1p1:LineIndex>1402</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsEmpty</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1403</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Functions</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetNewObject</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>clsList</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                        <d1p1:LineIndex>1404</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If we've already got list items, check whether we're still working on the same</d1p1:Content>
          <d1p1:LineIndex>1407</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> ReqNo as the previous entry. If so, add to that entry's unit list.</d1p1:Content>
          <d1p1:LineIndex>1408</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1409</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Count</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>-</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objEntryPrev</d1p1:Content>
                        <d1p1:LineIndex>1410</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objEntryPrev</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>ReqNo</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intReqNo</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1411</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>objEntryPrev</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>Units</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Add</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>intUnitKey</d1p1:Content>
                              <d1p1:LineIndex>1412</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ExitStatement">
                          <d1p1:LineIndex>1413</d1p1:LineIndex>
                          <d1p1:StatementType>Function</d1p1:StatementType>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Need to create a new entry</d1p1:Content>
          <d1p1:LineIndex>1417</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsValueBag</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1418</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intReqNo</d1p1:Content>
                <d1p1:LineIndex>1419</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1419</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1419</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>ReqNo</d1p1:Content>
                <d1p1:LineIndex>1419</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1419</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intNumPeople</d1p1:Content>
                <d1p1:LineIndex>1420</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1420</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1420</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>NumPeople</d1p1:Content>
                <d1p1:LineIndex>1420</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1420</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>Units</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1421</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objEntry</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>Units</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Add</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>intUnitKey</d1p1:Content>
              <d1p1:LineIndex>1422</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>arrReqUnitOptions</d1p1:Content>
              <d1p1:LineIndex>1423</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1423</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Add</d1p1:Content>
              <d1p1:LineIndex>1423</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objEntry</d1p1:Content>
              <d1p1:LineIndex>1423</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_UnitSel_AddReqUnitSelection</d1p1:Content>
        <d1p1:LineIndex>1427</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>arrReqUnitSelections</d1p1:Content>
            <d1p1:LineIndex>1427</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strUnitSelInfo</d1p1:Content>
            <d1p1:LineIndex>1427</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>arrReqUnitOptions</d1p1:Content>
            <d1p1:LineIndex>1427</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>arrSegments</d1p1:Content>
                <d1p1:LineIndex>1428</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intNumAdults</d1p1:Content>
                <d1p1:LineIndex>1429</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intNumChildren</d1p1:Content>
                <d1p1:LineIndex>1430</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intUnitKey</d1p1:Content>
                <d1p1:LineIndex>1431</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndex</d1p1:Content>
                <d1p1:LineIndex>1432</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1433</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objUnitList</d1p1:Content>
                <d1p1:LineIndex>1434</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Input list SHOULD be initialised as an empty list, but just in case..</d1p1:Content>
          <d1p1:LineIndex>1436</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsEmpty</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1437</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Functions</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetNewObject</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>clsList</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                        <d1p1:LineIndex>1438</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> strUnitSelInfo should be of the form "UnitKey,NumAdults,NumChildren"</d1p1:Content>
          <d1p1:LineIndex>1441</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Exit if not</d1p1:Content>
          <d1p1:LineIndex>1442</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Split</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strUnitSelInfo</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrSegments</d1p1:Content>
                <d1p1:LineIndex>1443</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>UBound</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrSegments</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>2</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1444</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1445</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Ensure entries in string are numeric (exit if not)</d1p1:Content>
          <d1p1:LineIndex>1448</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:OnErrorResumeNext">
          <d1p1:LineIndex>1449</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>CLng</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrSegments</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intUnitKey</d1p1:Content>
                <d1p1:LineIndex>1450</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1451</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Err</d1p1:Content>
                    <d1p1:LineIndex>1451</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1451</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1452</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>CLng</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrSegments</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intNumAdults</d1p1:Content>
                <d1p1:LineIndex>1454</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1455</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Err</d1p1:Content>
                    <d1p1:LineIndex>1455</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1455</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1456</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>CLng</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrSegments</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>2</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intNumChildren</d1p1:Content>
                <d1p1:LineIndex>1458</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1459</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Err</d1p1:Content>
                    <d1p1:LineIndex>1459</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1459</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1460</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:OnErrorGoto0">
          <d1p1:LineIndex>1462</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Ensure values look reasonable</d1p1:Content>
          <d1p1:LineIndex>1464</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intUnitKey</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1465</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intNumAdults</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intNumChildren</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1466</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intNumAdults</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>+</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intNumChildren</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1467</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1468</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Preparer new entry</d1p1:Content>
          <d1p1:LineIndex>1471</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsValueBag</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1472</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intNumAdults</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>+</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intNumChildren</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>NumPeople</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1473</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intUnitKey</d1p1:Content>
                <d1p1:LineIndex>1474</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1474</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1474</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>UnitKey</d1p1:Content>
                <d1p1:LineIndex>1474</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1474</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objEntry</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>PossReqNos</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1475</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Look through the unit options and look for possible requirement matches</d1p1:Content>
          <d1p1:LineIndex>1477</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - We've got a set of requirement / room options from the DMS and we've (possibly) got a</d1p1:Content>
          <d1p1:LineIndex>1478</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   set of unit selections from VisitBritain (or whoever), but these may not currently be</d1p1:Content>
          <d1p1:LineIndex>1479</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   aligned, so we want to determine the possible ways they MIGHT go together, and we'll</d1p1:Content>
          <d1p1:LineIndex>1480</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   try to get the best configuration (which will hopefully match the original choice)</d1p1:Content>
          <d1p1:LineIndex>1481</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   later on.</d1p1:Content>
          <d1p1:LineIndex>1482</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1483</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ForBlock">
                  <d1p1:LoopFrom>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>1484</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopFrom>
                  <d1p1:LoopStep i:nil="true" />
                  <d1p1:LoopTo>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                        <d1p1:LineIndex>1484</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1484</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Count</d1p1:Content>
                        <d1p1:LineIndex>1484</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>-</d1p1:Content>
                        <d1p1:LineIndex>1484</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>1484</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopTo>
                  <d1p1:LoopVar>
                    <d1p1:Content>intIndex</d1p1:Content>
                    <d1p1:LineIndex>1484</d1p1:LineIndex>
                  </d1p1:LoopVar>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> If requirement option matches the selection's NumPeople and contains the</d1p1:Content>
                      <d1p1:LineIndex>1485</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> UnitKey, then we've got a possible match</d1p1:Content>
                      <d1p1:LineIndex>1486</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>intIndex</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>NumPeople</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>=</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objEntry</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>NumPeople</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1487</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                                <d1p1:Content>And</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>intIndex</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>Units</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Contains</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objEntry</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>UnitKey</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1488</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:Statement">
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>objEntry</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OpenBrace">
                                  <d1p1:Content>(</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:StringToken">
                                  <d1p1:Content>PossReqNos</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:CloseBrace">
                                  <d1p1:Content>)</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                  <d1p1:Content>.</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>Add</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OpenBrace">
                                  <d1p1:Content>(</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>intIndex</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:CloseBrace">
                                  <d1p1:Content>)</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:OpenBrace">
                                  <d1p1:Content>(</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:StringToken">
                                  <d1p1:Content>ReqNo</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:CloseBrace">
                                  <d1p1:Content>)</d1p1:Content>
                                  <d1p1:LineIndex>1489</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If there is at least one possible requirement match, add entry to list</d1p1:Content>
          <d1p1:LineIndex>1494</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> (Otherwise, we can't do anything with the selection so don't bother with it)</d1p1:Content>
          <d1p1:LineIndex>1495</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objEntry</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>PossReqNos</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1496</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                      <d1p1:LineIndex>1497</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1497</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Add</d1p1:Content>
                      <d1p1:LineIndex>1497</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objEntry</d1p1:Content>
                      <d1p1:LineIndex>1497</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_UnitSel_GetMatchedReqUnitSelection</d1p1:Content>
        <d1p1:LineIndex>1502</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>arrReqUnitOptions</d1p1:Content>
            <d1p1:LineIndex>1502</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>arrReqUnitSelections</d1p1:Content>
            <d1p1:LineIndex>1502</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Given list of requirement option objects and unit selection objects, try to match them up.</d1p1:Content>
          <d1p1:LineIndex>1503</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsPermutations</d1p1:Content>
                <d1p1:LineIndex>1505</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsTemp</d1p1:Content>
                <d1p1:LineIndex>1506</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsPossReqNos</d1p1:Content>
                <d1p1:LineIndex>1507</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndex</d1p1:Content>
                <d1p1:LineIndex>1508</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexSel</d1p1:Content>
                <d1p1:LineIndex>1509</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexPoss</d1p1:Content>
                <d1p1:LineIndex>1509</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexPerm</d1p1:Content>
                <d1p1:LineIndex>1509</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexOption</d1p1:Content>
                <d1p1:LineIndex>1510</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intScore</d1p1:Content>
                <d1p1:LineIndex>1512</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intBestScore</d1p1:Content>
                <d1p1:LineIndex>1512</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strBestPermutation</d1p1:Content>
                <d1p1:LineIndex>1512</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>arrMatches</d1p1:Content>
                <d1p1:LineIndex>1514</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intUnitKey</d1p1:Content>
                <d1p1:LineIndex>1515</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsUnitKeys</d1p1:Content>
                <d1p1:LineIndex>1516</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>GetMatchedReqUnitSelection</d1p1:Content>
                <d1p1:LineIndex>1518</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Ensure we've got values for both lists</d1p1:Content>
          <d1p1:LineIndex>1520</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1521</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>Nothing</d1p1:Content>
                        <d1p1:LineIndex>1522</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetMatchedReqUnitSelection</d1p1:Content>
                        <d1p1:LineIndex>1522</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1524</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>Nothing</d1p1:Content>
                        <d1p1:LineIndex>1525</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetMatchedReqUnitSelection</d1p1:Content>
                        <d1p1:LineIndex>1525</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> First, create a list of ways in which the unit selections could be applied to the unit</d1p1:Content>
          <d1p1:LineIndex>1528</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> options. We'll get out a list of strings which are comma-separated lists; the values</d1p1:Content>
          <d1p1:LineIndex>1529</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> will relate the arrReqUnitSelections list indices to arrReqUnitOptions entries.</d1p1:Content>
          <d1p1:LineIndex>1530</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>  eg. string "2,3,1"</d1p1:Content>
          <d1p1:LineIndex>1531</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>      maps Selection 1 -&gt; Option 2</d1p1:Content>
          <d1p1:LineIndex>1532</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>           Selection 2 -&gt; Option 3</d1p1:Content>
          <d1p1:LineIndex>1533</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>           Selection 3 -&gt; Option 1</d1p1:Content>
          <d1p1:LineIndex>1534</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>lsPermutations</d1p1:Content>
                <d1p1:LineIndex>1535</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1536</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndexSel</d1p1:Content>
            <d1p1:LineIndex>1536</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexSel</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>PossReqNos</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Set</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>lsPossReqNos</d1p1:Content>
                    <d1p1:LineIndex>1537</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>lsPermutations</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Count</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1538</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> This is the first pass, so initialise the permutations list with</d1p1:Content>
                      <d1p1:LineIndex>1539</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> the possible matches from this first ReqUnitSelection</d1p1:Content>
                      <d1p1:LineIndex>1540</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ForBlock">
                      <d1p1:LoopFrom>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:LoopFrom>
                      <d1p1:LoopStep i:nil="true" />
                      <d1p1:LoopTo>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsPossReqNos</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Count</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>-</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>1</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1541</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:LoopTo>
                      <d1p1:LoopVar>
                        <d1p1:Content>intIndexPoss</d1p1:Content>
                        <d1p1:LineIndex>1541</d1p1:LineIndex>
                      </d1p1:LoopVar>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>lsPermutations</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Add</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>lsPossReqNos</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>intIndexPoss</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1542</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause>
                <d1p1:Statements>
                  <d2p1:anyType i:type="d1p1:CommentStatement">
                    <d1p1:Content> We want to take our whatever permutation strings we have so far and expand</d1p1:Content>
                    <d1p1:LineIndex>1545</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CommentStatement">
                    <d1p1:Content> them to include the possibilities for this ReqUnitSelection</d1p1:Content>
                    <d1p1:LineIndex>1546</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CommentStatement">
                    <d1p1:Content> - Make a copy of lsPermutations thus far</d1p1:Content>
                    <d1p1:LineIndex>1547</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                    <d1p1:Expression>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Page</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Functions</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>GetNewObject</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>clsList</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Expression>
                    <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                    <d1p1:ValueToSet>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>lsTemp</d1p1:Content>
                          <d1p1:LineIndex>1548</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:ValueToSet>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ForBlock">
                    <d1p1:LoopFrom>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>0</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:LoopFrom>
                    <d1p1:LoopStep i:nil="true" />
                    <d1p1:LoopTo>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>lsPermutations</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Count</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>-</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>1</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1549</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:LoopTo>
                    <d1p1:LoopVar>
                      <d1p1:Content>intIndexPerm</d1p1:Content>
                      <d1p1:LineIndex>1549</d1p1:LineIndex>
                    </d1p1:LoopVar>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsTemp</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Add</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsPermutations</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intIndexPerm</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1550</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CommentStatement">
                    <d1p1:Content> - Clear out permutation list</d1p1:Content>
                    <d1p1:LineIndex>1552</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:Statement">
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>lsPermutations</d1p1:Content>
                        <d1p1:LineIndex>1553</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1553</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Clear</d1p1:Content>
                        <d1p1:LineIndex>1553</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CommentStatement">
                    <d1p1:Content> - Re-create new list using previous values with new combinations</d1p1:Content>
                    <d1p1:LineIndex>1554</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ForBlock">
                    <d1p1:LoopFrom>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>0</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:LoopFrom>
                    <d1p1:LoopStep i:nil="true" />
                    <d1p1:LoopTo>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>lsPossReqNos</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Count</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>-</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>1</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1555</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:LoopTo>
                    <d1p1:LoopVar>
                      <d1p1:Content>intIndexPoss</d1p1:Content>
                      <d1p1:LineIndex>1555</d1p1:LineIndex>
                    </d1p1:LoopVar>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:ForBlock">
                        <d1p1:LoopFrom>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>0</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopFrom>
                        <d1p1:LoopStep i:nil="true" />
                        <d1p1:LoopTo>
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>lsTemp</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Count</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>-</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NumericValueToken">
                              <d1p1:Content>1</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1556</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d1p1:LoopTo>
                        <d1p1:LoopVar>
                          <d1p1:Content>intIndexPerm</d1p1:Content>
                          <d1p1:LineIndex>1556</d1p1:LineIndex>
                        </d1p1:LoopVar>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:Statement">
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>lsPermutations</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Add</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>lsTemp</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>intIndexPerm</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>lsPossReqNos</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>intIndexPoss</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1557</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d2p1:anyType>
                </d1p1:Statements>
              </d1p1:OptionalElseClause>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Now determine which arrangement matches the most selection / options pairs</d1p1:Content>
          <d1p1:LineIndex>1563</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1564</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1564</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intBestScore</d1p1:Content>
                <d1p1:LineIndex>1564</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>lsPermutations</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1565</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>1565</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingUI_UnitSel_ScoreUnitSelPermutation</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>lsPermutations</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndex</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intScore</d1p1:Content>
                    <d1p1:LineIndex>1566</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1567</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intScore</d1p1:Content>
                        <d1p1:LineIndex>1567</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&gt;</d1p1:Content>
                        <d1p1:LineIndex>1567</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intBestScore</d1p1:Content>
                        <d1p1:LineIndex>1567</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1567</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intScore</d1p1:Content>
                            <d1p1:LineIndex>1568</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intBestScore</d1p1:Content>
                            <d1p1:LineIndex>1568</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsPermutations</d1p1:Content>
                            <d1p1:LineIndex>1569</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1569</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intIndex</d1p1:Content>
                            <d1p1:LineIndex>1569</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1569</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strBestPermutation</d1p1:Content>
                            <d1p1:LineIndex>1569</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Finally, translate these matches into UnitKey values (or zero for unit</d1p1:Content>
          <d1p1:LineIndex>1573</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> option which don't have a selection matched to them)</d1p1:Content>
          <d1p1:LineIndex>1574</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Start off with a full-size list (matching size of arrReqUnitOptions) with</d1p1:Content>
          <d1p1:LineIndex>1575</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   with all zero values</d1p1:Content>
          <d1p1:LineIndex>1576</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>lsUnitKeys</d1p1:Content>
                <d1p1:LineIndex>1577</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrReqUnitOptions</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1578</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>1578</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:Statement">
              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
              <d1p1:Tokens>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>lsUnitKeys</d1p1:Content>
                  <d1p1:LineIndex>1579</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>1579</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>Add</d1p1:Content>
                  <d1p1:LineIndex>1579</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NumericValueToken">
                  <d1p1:Content>0</d1p1:Content>
                  <d1p1:LineIndex>1579</d1p1:LineIndex>
                </d2p1:anyType>
              </d1p1:Tokens>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Now push in the selection matches we have</d1p1:Content>
          <d1p1:LineIndex>1582</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; Split best permutation back into integer values in arrMatches</d1p1:Content>
          <d1p1:LineIndex>1583</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; The index of arrMatches will matches the index of arrReqUnitSelections</d1p1:Content>
          <d1p1:LineIndex>1584</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>    &gt; The value of arrMatches(n) will be the ReqNo it matches, which is the index</d1p1:Content>
          <d1p1:LineIndex>1585</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>      of arrReqUnitOptions + 1 (andso also the index of lsUnitKeys + 1 since these</d1p1:Content>
          <d1p1:LineIndex>1586</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>      two lists overlay)</d1p1:Content>
          <d1p1:LineIndex>1587</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Split</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strBestPermutation</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrMatches</d1p1:Content>
                <d1p1:LineIndex>1588</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1589</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>UBound</d1p1:Content>
                <d1p1:LineIndex>1589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrMatches</d1p1:Content>
                <d1p1:LineIndex>1589</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1589</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndexSel</d1p1:Content>
            <d1p1:LineIndex>1589</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrMatches</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexSel</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>-</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexOption</d1p1:Content>
                    <d1p1:LineIndex>1590</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>arrReqUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexSel</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>UnitKey</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intUnitKey</d1p1:Content>
                    <d1p1:LineIndex>1591</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intUnitKey</d1p1:Content>
                    <d1p1:LineIndex>1592</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>lsUnitKeys</d1p1:Content>
                    <d1p1:LineIndex>1592</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1592</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexOption</d1p1:Content>
                    <d1p1:LineIndex>1592</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1592</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Return matches!</d1p1:Content>
          <d1p1:LineIndex>1595</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> There are the same number of values in lsUnitKeys as in arrReqUnitSelections, and</d1p1:Content>
          <d1p1:LineIndex>1596</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> each lsUnitKeys(n) is the UnitKey for arrReqUnitSelections(n)</d1p1:Content>
          <d1p1:LineIndex>1597</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>lsUnitKeys</d1p1:Content>
                <d1p1:LineIndex>1598</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_UnitSel_GetMatchedReqUnitSelection</d1p1:Content>
                <d1p1:LineIndex>1598</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_UnitSel_ScoreUnitSelPermutation</d1p1:Content>
        <d1p1:LineIndex>1602</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strPermutation</d1p1:Content>
            <d1p1:LineIndex>1602</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Determine a score for the Unit Selection / Option permutations calculated above.</d1p1:Content>
          <d1p1:LineIndex>1603</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Basically, give a score of one for each non-duplicated match.</d1p1:Content>
          <d1p1:LineIndex>1604</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndex</d1p1:Content>
                <d1p1:LineIndex>1606</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intScore</d1p1:Content>
                <d1p1:LineIndex>1607</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>arrValues</d1p1:Content>
                <d1p1:LineIndex>1608</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>lsReqNos</d1p1:Content>
                <d1p1:LineIndex>1609</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>clsList</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>lsReqNos</d1p1:Content>
                <d1p1:LineIndex>1611</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Split</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPermutation</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrValues</d1p1:Content>
                <d1p1:LineIndex>1612</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1613</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intScore</d1p1:Content>
                <d1p1:LineIndex>1613</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1614</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>UBound</d1p1:Content>
                <d1p1:LineIndex>1614</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1614</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>arrValues</d1p1:Content>
                <d1p1:LineIndex>1614</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1614</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>1614</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>lsReqNos</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Contains</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>arrValues</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intIndex</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1615</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intScore</d1p1:Content>
                            <d1p1:LineIndex>1616</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>+</d1p1:Content>
                            <d1p1:LineIndex>1616</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>1</d1p1:Content>
                            <d1p1:LineIndex>1616</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intScore</d1p1:Content>
                            <d1p1:LineIndex>1616</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>lsReqNos</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Add</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>arrValues</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>intIndex</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1617</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>intScore</d1p1:Content>
                <d1p1:LineIndex>1621</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_UnitSel_ScoreUnitSelPermutation</d1p1:Content>
                <d1p1:LineIndex>1621</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>1626</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Render options for accommodation products (only used with non-precise fuzzy stays)</d1p1:Content>
      <d1p1:LineIndex>1627</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>1628</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: summarise STAYS for this product which match booking criteria</d1p1:Content>
      <d1p1:LineIndex>1629</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [arsAvail]: ADO unit recordset from availability object</d1p1:Content>
      <d1p1:LineIndex>1630</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtStartNight]: date of first night of stay</d1p1:Content>
      <d1p1:LineIndex>1631</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiReqNumNights]: integer requested num nights</d1p1:Content>
      <d1p1:LineIndex>1632</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StaySummary</d1p1:Content>
        <d1p1:LineIndex>1633</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>dtReqFirstNight</d1p1:Content>
            <d1p1:LineIndex>1634</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iReqNights</d1p1:Content>
            <d1p1:LineIndex>1635</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>dtStayFirstNight</d1p1:Content>
            <d1p1:LineIndex>1636</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iStayNights</d1p1:Content>
            <d1p1:LineIndex>1637</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>1638</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Render each stay result with link to further details</d1p1:Content>
          <d1p1:LineIndex>1640</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - 2009-08-10 DWR: Why do we not render this if "_stay" is in the querystring???</d1p1:Content>
          <d1p1:LineIndex>1641</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Request</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>_stay</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1642</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1643</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1646</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1646</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1646</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="StayCandidateList"&gt;</d1p1:Content>
              <d1p1:LineIndex>1646</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1647</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1647</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1647</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="StayCandidatesTtl"&gt;</d1p1:Content>
              <d1p1:LineIndex>1647</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;p&gt;</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/unitselection/flexiblesearchresults</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>Flexible Search Results</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/p&gt;</d1p1:Content>
              <d1p1:LineIndex>1648</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1649</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1649</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1649</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1649</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dtStayFirstNight</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>dtReqFirstNight</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iReqnights</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iStayNights</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1650</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1651</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1651</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1651</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="cell"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1651</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1652</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1652</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1652</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="pnStayTtl"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1652</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_StayTtl</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>dtStayFirstNight</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iStayNights</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1653</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1654</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1654</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1654</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>1654</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_StayDiff</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>dtReqFirstNight</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>dtStayFirstNight</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iReqNights</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iStayNights</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1655</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1656</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1656</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1656</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>1656</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1658</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1658</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1658</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1658</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: Render details for a single stay, including UNIT booking UI</d1p1:Content>
      <d1p1:LineIndex>1662</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [objAvailEntry]: A single supplier's availability data for a single stay (AvailabilityStayResultsWrapped)</d1p1:Content>
      <d1p1:LineIndex>1663</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [iStayNum]: Only applies when displaying multiple fuzzy results</d1p1:Content>
      <d1p1:LineIndex>1664</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtStartNight]: date of first night of stay</d1p1:Content>
      <d1p1:LineIndex>1665</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiReqNights]: integer requested num nights</d1p1:Content>
      <d1p1:LineIndex>1666</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [bTeleBooking]: does the current product only support telephone booking (ie. is on tele booking channel)?</d1p1:Content>
      <d1p1:LineIndex>1667</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [strProductBookingWebIfAny]: the Booking Website for the the current product, if there is one (so may be empty, null, blank, whatever)</d1p1:Content>
      <d1p1:LineIndex>1668</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [strEviivoIdIfAny]: the Eviivo Id for the the current product, if there is one (so may be empty, null, blank, whatever)</d1p1:Content>
      <d1p1:LineIndex>1669</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [intProductKey]</d1p1:Content>
      <d1p1:LineIndex>1670</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [strChannel]</d1p1:Content>
      <d1p1:LineIndex>1671</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [bIndicative]: does the specified stay have any indicative units?</d1p1:Content>
      <d1p1:LineIndex>1672</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [bIndicativeValid]: are we within the timeout period for indicative bookings?</d1p1:Content>
      <d1p1:LineIndex>1673</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [lsRemoteUnitSelections]: data regarding unit pre-selections (see VB Deep Linking)</d1p1:Content>
      <d1p1:LineIndex>1674</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayDetails</d1p1:Content>
        <d1p1:LineIndex>1675</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvailEntry</d1p1:Content>
            <d1p1:LineIndex>1676</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iStayNum</d1p1:Content>
            <d1p1:LineIndex>1677</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>adtStartNight</d1p1:Content>
            <d1p1:LineIndex>1678</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiReqNights</d1p1:Content>
            <d1p1:LineIndex>1679</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bTeleBooking</d1p1:Content>
            <d1p1:LineIndex>1680</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
            <d1p1:LineIndex>1681</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strEviivoIdIfAny</d1p1:Content>
            <d1p1:LineIndex>1682</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>intProductKey</d1p1:Content>
            <d1p1:LineIndex>1683</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strChannel</d1p1:Content>
            <d1p1:LineIndex>1684</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bIndicative</d1p1:Content>
            <d1p1:LineIndex>1685</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bIndicativeValid</d1p1:Content>
            <d1p1:LineIndex>1686</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAllUnits</d1p1:Content>
            <d1p1:LineIndex>1687</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
            <d1p1:LineIndex>1688</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>1689</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bRenderMaximumUnitsAvailable</d1p1:Content>
            <d1p1:LineIndex>1690</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexUnit</d1p1:Content>
                <d1p1:LineIndex>1692</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>1692</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iLastReqmnt</d1p1:Content>
                <d1p1:LineIndex>1693</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iThisReqmnt</d1p1:Content>
                <d1p1:LineIndex>1693</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bGotOpenReqContainer</d1p1:Content>
                <d1p1:LineIndex>1694</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sClassName</d1p1:Content>
                <d1p1:LineIndex>1695</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bPrecise</d1p1:Content>
                <d1p1:LineIndex>1695</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iUnitKey</d1p1:Content>
                <d1p1:LineIndex>1695</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iMaxRq</d1p1:Content>
                <d1p1:LineIndex>1696</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iRemoteUnitKey</d1p1:Content>
                <d1p1:LineIndex>1696</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bSelected</d1p1:Content>
                <d1p1:LineIndex>1697</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strNonBookableUnits</d1p1:Content>
                <d1p1:LineIndex>1698</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bHasBookableUnits</d1p1:Content>
                <d1p1:LineIndex>1698</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bHasNonBookableUnits</d1p1:Content>
                <d1p1:LineIndex>1698</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Ensure we've actually got some availability (we should if we've got here!)</d1p1:Content>
          <d1p1:LineIndex>1700</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Units</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1701</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1702</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1702</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                      <d1p1:LineIndex>1702</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>BookingUI_StayDetails: No units in objAvailEntry</d1p1:Content>
                      <d1p1:LineIndex>1702</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1703</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> This method opens a new div - we'll need to close it later</d1p1:Content>
          <d1p1:LineIndex>1706</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_RenderNewStay</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objAvailEntry</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>iStayNum</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>adtStartNight</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiReqNights</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1707</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1709</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iMaxRq</d1p1:Content>
                <d1p1:LineIndex>1709</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1710</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iLastReqmnt</d1p1:Content>
                <d1p1:LineIndex>1710</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1711</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iRemoteUnitKey</d1p1:Content>
                <d1p1:LineIndex>1711</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>1712</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bGotOpenReqContainer</d1p1:Content>
                <d1p1:LineIndex>1712</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>1713</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bHasBookableUnits</d1p1:Content>
                <d1p1:LineIndex>1713</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>False</d1p1:Content>
                <d1p1:LineIndex>1714</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bHasNonBookableUnits</d1p1:Content>
                <d1p1:LineIndex>1714</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Units</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>1715</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndexUnit</d1p1:Content>
            <d1p1:LineIndex>1715</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Units</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>GetItem</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>intIndexUnit</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Set</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objUnit</d1p1:Content>
                    <d1p1:LineIndex>1716</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objUnit</d1p1:Content>
                    <d1p1:LineIndex>1718</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1718</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>ReqNo</d1p1:Content>
                    <d1p1:LineIndex>1718</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iThisReqmnt</d1p1:Content>
                    <d1p1:LineIndex>1718</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iThisReqmnt</d1p1:Content>
                        <d1p1:LineIndex>1719</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&gt;</d1p1:Content>
                        <d1p1:LineIndex>1719</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iMaxRq</d1p1:Content>
                        <d1p1:LineIndex>1719</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> Moved on to next requirement, get key of pre-selected unit - iRemoteUnitKey</d1p1:Content>
                      <d1p1:LineIndex>1720</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> will be zero if no selection has been passed in (applies to deep-linking)</d1p1:Content>
                      <d1p1:LineIndex>1721</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iThisReqmnt</d1p1:Content>
                            <d1p1:LineIndex>1722</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iMaxRq</d1p1:Content>
                            <d1p1:LineIndex>1722</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>BookingUI_GetPreSelectedUnitKey</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iThisReqmnt</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iRemoteUnitKey</d1p1:Content>
                            <d1p1:LineIndex>1723</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> Check whether we're moving into a new requirement (if so, default to having</d1p1:Content>
              <d1p1:LineIndex>1726</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> the first unit appear selected) and render the "Room 1 - for 1 Guest"</d1p1:Content>
              <d1p1:LineIndex>1727</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> content</d1p1:Content>
              <d1p1:LineIndex>1728</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iThisReqmnt</d1p1:Content>
                        <d1p1:LineIndex>1729</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&lt;</d1p1:Content>
                        <d1p1:LineIndex>1729</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&gt;</d1p1:Content>
                        <d1p1:LineIndex>1729</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iLastReqmnt</d1p1:Content>
                        <d1p1:LineIndex>1729</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content> If we've already got one of these containers open, close its tags</d1p1:Content>
                      <d1p1:LineIndex>1731</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1732</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>bGotOpenReqContainer</d1p1:Content>
                                <d1p1:LineIndex>1732</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1732</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:Statement">
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>pO</d1p1:Content>
                                  <d1p1:LineIndex>1733</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                  <d1p1:Content>.</d1p1:Content>
                                  <d1p1:LineIndex>1733</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>Write</d1p1:Content>
                                  <d1p1:LineIndex>1733</d1p1:LineIndex>
                                </d2p1:anyType>
                                <d2p1:anyType i:type="d1p1:StringToken">
                                  <d1p1:Content>&lt;/div&gt;&lt;/div&gt;</d1p1:Content>
                                  <d1p1:LineIndex>1733</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>BookingUI_RenderNewReq</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iStayNum</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iThisReqmnt</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                          <d1p1:Content>Not</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objAvailEntry</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>IsLocal</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>1735</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>1736</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bGotOpenReqContainer</d1p1:Content>
                            <d1p1:LineIndex>1736</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>1738</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bSelected</d1p1:Content>
                            <d1p1:LineIndex>1738</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iThisReqmnt</d1p1:Content>
                            <d1p1:LineIndex>1739</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iLastReqmnt</d1p1:Content>
                            <d1p1:LineIndex>1739</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause>
                <d1p1:Statements>
                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                    <d1p1:Expression>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                          <d1p1:Content>False</d1p1:Content>
                          <d1p1:LineIndex>1741</d1p1:LineIndex>
                          <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Expression>
                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                    <d1p1:ValueToSet>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>bSelected</d1p1:Content>
                          <d1p1:LineIndex>1741</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:ValueToSet>
                  </d2p1:anyType>
                </d1p1:Statements>
              </d1p1:OptionalElseClause>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> .. however, if there was a pre-selected unit key passed in, this should override which</d1p1:Content>
              <d1p1:LineIndex>1744</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> unit appears selected (this only applies when iRemoteUnitKey is not zero, meaning that</d1p1:Content>
              <d1p1:LineIndex>1745</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> a unit selection exists - note: eviivo units always appear with unit key zero)</d1p1:Content>
              <d1p1:LineIndex>1746</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objUnit</d1p1:Content>
                    <d1p1:LineIndex>1747</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1747</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>UnitKey</d1p1:Content>
                    <d1p1:LineIndex>1747</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iUnitKey</d1p1:Content>
                    <d1p1:LineIndex>1747</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1748</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iRemoteUnitKey</d1p1:Content>
                        <d1p1:LineIndex>1748</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&lt;</d1p1:Content>
                        <d1p1:LineIndex>1748</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>&gt;</d1p1:Content>
                        <d1p1:LineIndex>1748</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>1748</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1748</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1749</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitKey</d1p1:Content>
                            <d1p1:LineIndex>1749</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1749</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iRemoteUnitKey</d1p1:Content>
                            <d1p1:LineIndex>1749</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1749</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bSelected</d1p1:Content>
                            <d1p1:LineIndex>1749</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> build up a list of invalid indicative or telephone booking</d1p1:Content>
              <d1p1:LineIndex>1752</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> units, this is used later by javascript when we have a mixture of allocated and indicative</d1p1:Content>
              <d1p1:LineIndex>1753</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> availability</d1p1:Content>
              <d1p1:LineIndex>1754</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objUnit</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Indicative</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>And</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Not</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bIndicativeValid</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                        <d1p1:Content>Or</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bTeleBooking</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1755</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                            <d1p1:Content>True</d1p1:Content>
                            <d1p1:LineIndex>1756</d1p1:LineIndex>
                            <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bHasNonBookableUnits</d1p1:Content>
                            <d1p1:LineIndex>1756</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                <d1p1:Content>Len</d1p1:Content>
                                <d1p1:LineIndex>1757</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1757</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strNonBookableUnits</d1p1:Content>
                                <d1p1:LineIndex>1757</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1757</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                <d1p1:Content>&gt;</d1p1:Content>
                                <d1p1:LineIndex>1757</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>0</d1p1:Content>
                                <d1p1:LineIndex>1757</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strNonBookableUnits</d1p1:Content>
                                    <d1p1:LineIndex>1758</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:OperatorToken">
                                    <d1p1:Content>&amp;</d1p1:Content>
                                    <d1p1:LineIndex>1758</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>,</d1p1:Content>
                                    <d1p1:LineIndex>1758</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strNonBookableUnits</d1p1:Content>
                                    <d1p1:LineIndex>1758</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause i:nil="true" />
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content>MJ - 	the stay num is no longer part of this data, it is part of each array's name</d1p1:Content>
                      <d1p1:LineIndex>1761</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CommentStatement">
                      <d1p1:Content>		look at TB's other changes to see the reasoning behind this</d1p1:Content>
                      <d1p1:LineIndex>1762</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strNonBookableUnits</d1p1:Content>
                            <d1p1:LineIndex>1763</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>1763</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iUnitKey</d1p1:Content>
                            <d1p1:LineIndex>1763</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strNonBookableUnits</d1p1:Content>
                            <d1p1:LineIndex>1763</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Page</d1p1:Content>
                          <d1p1:LineIndex>1764</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>1764</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>PrintTrace</d1p1:Content>
                          <d1p1:LineIndex>1764</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>strNonBookableUnits</d1p1:Content>
                          <d1p1:LineIndex>1764</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>1764</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strNonBookableUnits</d1p1:Content>
                          <d1p1:LineIndex>1764</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause>
                <d1p1:Statements>
                  <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                    <d1p1:Expression>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                          <d1p1:Content>True</d1p1:Content>
                          <d1p1:LineIndex>1766</d1p1:LineIndex>
                          <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:Expression>
                    <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                    <d1p1:ValueToSet>
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>bHasBookableUnits</d1p1:Content>
                          <d1p1:LineIndex>1766</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d1p1:ValueToSet>
                  </d2p1:anyType>
                </d1p1:Statements>
              </d1p1:OptionalElseClause>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> 2009-09-30 DWR: The AvailClassName was previously generated by considering the indicative</d1p1:Content>
              <d1p1:LineIndex>1769</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> state of the whole stay - this was causing all units to be rendered as indicative if any</d1p1:Content>
              <d1p1:LineIndex>1770</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> one of them was, now we take the indicative state from each unit (but keep the indicative</d1p1:Content>
              <d1p1:LineIndex>1771</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> "validity" from the whole stay, where required)</d1p1:Content>
              <d1p1:LineIndex>1772</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:Statement">
              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
              <d1p1:Tokens>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>BookingUI_RenderUnit</d1p1:Content>
                  <d1p1:LineIndex>1773</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>iStayNum</d1p1:Content>
                  <d1p1:LineIndex>1774</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1774</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>iThisReqmnt</d1p1:Content>
                  <d1p1:LineIndex>1774</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1774</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>bSelected</d1p1:Content>
                  <d1p1:LineIndex>1775</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1775</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objAvailEntry</d1p1:Content>
                  <d1p1:LineIndex>1776</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1776</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objUnit</d1p1:Content>
                  <d1p1:LineIndex>1777</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1777</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objAllUnits</d1p1:Content>
                  <d1p1:LineIndex>1778</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1778</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>BookingUI_AvailClassName</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:OpenBrace">
                  <d1p1:Content>(</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>objUnit</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                  <d1p1:Content>.</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>Indicative</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>bIndicativeValid</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>bTeleBooking</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CloseBrace">
                  <d1p1:Content>)</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1779</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>pO</d1p1:Content>
                  <d1p1:LineIndex>1780</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                  <d1p1:Content>,</d1p1:Content>
                  <d1p1:LineIndex>1780</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:NameToken">
                  <d1p1:Content>bRenderMaximumUnitsAvailable</d1p1:Content>
                  <d1p1:LineIndex>1781</d1p1:LineIndex>
                </d2p1:anyType>
              </d1p1:Tokens>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BlankLine" />
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Ensure any open req container (eg. "Room 1 - for 1 Guest" section) is closed</d1p1:Content>
          <d1p1:LineIndex>1785</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1786</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bGotOpenReqContainer</d1p1:Content>
                    <d1p1:LineIndex>1786</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1786</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1787</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1787</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1787</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>1787</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>False</d1p1:Content>
                        <d1p1:LineIndex>1788</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bGotOpenReqContainer</d1p1:Content>
                        <d1p1:LineIndex>1788</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Close the BookingUI_RenderNewStay containing div</d1p1:Content>
          <d1p1:LineIndex>1791</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1792</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1792</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1792</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1792</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Wrap these hidden inputs in a div for html validity</d1p1:Content>
          <d1p1:LineIndex>1794</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1795</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1795</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1795</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div&gt;</d1p1:Content>
              <d1p1:LineIndex>1795</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="_nStays" value="</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>iStayNum</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>1796</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="_nReqs" value="</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>iMaxRq</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>1797</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>1798</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1798</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>1798</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1798</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsLocal</d1p1:Content>
                    <d1p1:LineIndex>1798</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1798</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1799</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1799</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1799</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="IsEviivoBooking" value="yes" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>1799</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>IsExternalBooking</d1p1:Content>
                            <d1p1:LineIndex>1800</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;input type="hidden" name="eviivoconf" value="</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                              <d1p1:Content>CLng</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>0</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Site</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Params</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>Integration_Eviivo_ConfigSet</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>" /&gt;</d1p1:Content>
                              <d1p1:LineIndex>1801</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1804</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1804</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1804</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1804</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2014-06-25 DWR: For sites that use the legacy "eviivo external" booking integration (meaning sites where VB Polling is not enabled - the new implementation</d1p1:Content>
          <d1p1:LineIndex>1806</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> results in Eviivo results being reported as Polling results and the user being sent through the Polling Exit with a fully-populated deep link), the Book</d1p1:Content>
          <d1p1:LineIndex>1807</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> button should not be shown here. The Unit Selection should never be shown in this case, to be honest, since Book buttons should go straight to the Product's</d1p1:Content>
          <d1p1:LineIndex>1808</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Booking Website and not enter the site's availability process. However, if there are sites that show inline Unit Selection (inline with the Product List)</d1p1:Content>
          <d1p1:LineIndex>1809</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> then the Unit data may be useful. If we were wanted to render Book buttons here (to the external site) then logic would have to be duplicated from the</d1p1:Content>
          <d1p1:LineIndex>1810</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Product List or Detail Control, which would be better avoided. A much better solution is to enable VB Polling and avoid this legacy mechanism entirely.</d1p1:Content>
          <d1p1:LineIndex>1811</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Note: We could potentially render the button for Local Avail and not for Eviivo but I think that that's more confusing than helpful, particularly since</d1p1:Content>
          <d1p1:LineIndex>1812</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> it's inconsistent with the Product List / Detail implementation (which bases its decision upon whether the Product has an Eviivo Id).</d1p1:Content>
          <d1p1:LineIndex>1813</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_EnablePolling</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Trim</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strEviivoIdIfAny</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Integration_Eviivo_ExtBooking_Enable</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1814</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1815</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1815</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                      <d1p1:LineIndex>1815</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Not rendering any Book buttons for Unit Selection since the legacy Eviivo External Booking configuration is enabled (the recommended alternative is to use the deep-link-supporting Eviivo External Booking configuration, this may be done by enabling VB Polling)</d1p1:Content>
                      <d1p1:LineIndex>1815</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1816</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2014-03-14 DWR: New functionality "Availability Searches with offsite Booking Web Booking" allows for Products to be on the Telephone Booking Channel</d1p1:Content>
          <d1p1:LineIndex>1819</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> and have their availability queried but to show a Booking button that goes to the Product's Booking Website (if one is specified), rather than</d1p1:Content>
          <d1p1:LineIndex>1820</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> showing a "this can not be booked online, please call.." message (this means that the avail criteria have to be re-entered on the target</d1p1:Content>
          <d1p1:LineIndex>1821</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> website, but that is understood and how it works - see FogBugz 10367). I've tried to make the markup for this button reminiscent of</d1p1:Content>
          <d1p1:LineIndex>1822</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> that in Product List and Detail to try to make any additional styling requirements as low as possible.</d1p1:Content>
          <d1p1:LineIndex>1823</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Trim</d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content></d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
                <d1p1:LineIndex>1824</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bTeleBooking</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_EnableByPhone</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_AllowOffSiteTelephoneBookings</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1825</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1826</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1826</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTrace</d1p1:Content>
                      <d1p1:LineIndex>1826</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Since this is a Telephone Booking Product with a Booking Website and the 'Allow Offsite Booking Web Booking for Telephone Bookings' parameter is enabled, a button to the Booking Website is being rendered</d1p1:Content>
                      <d1p1:LineIndex>1826</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1827</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1827</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1827</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="pnStayButtons"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1827</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1828</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1828</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1828</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;p class="bookonline"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1828</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1829</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1829</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1829</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;a href="</d1p1:Content>
                      <d1p1:LineIndex>1829</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Server</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>HtmlEncode</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strProductBookingWebIfAny</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1830</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1831</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1831</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1831</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>"</d1p1:Content>
                      <d1p1:LineIndex>1831</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>IsPartialRender</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                            <d1p1:Content>Or</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>PartialRenderType</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>html</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1832</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> If in Partial Render then set target="_blank" instead of rel="external" (we only do the latter for strict adherence to standards and then</d1p1:Content>
                          <d1p1:LineIndex>1833</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> use javascript to transform after rendering - when requesting additional content through javascript this transformation won't be performed</d1p1:Content>
                          <d1p1:LineIndex>1834</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> so we'll need to generate it direct)</d1p1:Content>
                          <d1p1:LineIndex>1835</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> 2014-06-12 DWR: The partial render requests for this data are commonly made as "html" meaning that Page.IsPartialRender will be false</d1p1:Content>
                          <d1p1:LineIndex>1836</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> (the logic being that Controls should render entirely as standard when in html partial render mode) so I've added an additional check</d1p1:Content>
                          <d1p1:LineIndex>1837</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CommentStatement">
                          <d1p1:Content> for the a "PartialRenderType" value of "html" to ensure that the new-window logic is maintained correctly.</d1p1:Content>
                          <d1p1:LineIndex>1838</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>1839</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1839</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>1839</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content> target="_blank"</d1p1:Content>
                              <d1p1:LineIndex>1839</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>1841</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1841</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>1841</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> rel="external"</d1p1:Content>
                            <d1p1:LineIndex>1841</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1843</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1843</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1843</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> class="ProvClickCustom" name="PROBWEBREF|</d1p1:Content>
                      <d1p1:LineIndex>1843</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> This is the "Provider Booking Website Referral" statistic, as required by the SharePoint document for FogBugz 10367</d1p1:Content>
                  <d1p1:LineIndex>1843</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Server</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>HtmlEncode</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strChannel</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1844</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1845</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1845</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1845</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>|</d1p1:Content>
                      <d1p1:LineIndex>1845</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1846</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1846</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1846</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>intProductKey</d1p1:Content>
                      <d1p1:LineIndex>1846</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1847</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1847</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1847</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>"</d1p1:Content>
                      <d1p1:LineIndex>1847</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1848</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1848</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1848</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&gt;</d1p1:Content>
                      <d1p1:LineIndex>1848</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1849</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1849</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1849</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;img src="</d1p1:Content>
                      <d1p1:LineIndex>1849</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ImageResource</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/btn/book</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Context</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ImageDir</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>booking/book.gif</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1850</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1851</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1851</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1851</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" alt="</d1p1:Content>
                      <d1p1:LineIndex>1851</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/btn/book</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Book</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1852</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1853</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1853</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1853</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> (</d1p1:Content>
                      <d1p1:LineIndex>1853</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>productdetail/bookonline/opensinanewwindow</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>opens in a new window</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>1854</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1855</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1855</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1855</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>)" </d1p1:Content>
                      <d1p1:LineIndex>1855</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1856</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1856</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1856</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>/&gt;</d1p1:Content>
                      <d1p1:LineIndex>1856</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1857</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1857</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1857</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/a&gt;</d1p1:Content>
                      <d1p1:LineIndex>1857</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1858</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1858</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1858</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/p&gt;</d1p1:Content>
                      <d1p1:LineIndex>1858</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1859</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1859</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1859</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>1859</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1859</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbCrLf</d1p1:Content>
                      <d1p1:LineIndex>1859</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>1860</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2014-03-13 DWR: If there is at least one bookable unit then display the Book button and rely on JavaScript to show/hide it if selections are made that</d1p1:Content>
          <d1p1:LineIndex>1863</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> can not be completed online. But if there are NO bookable units (eg. a Telephone Booking Product or all of the Units are Indicative where the timeout</d1p1:Content>
          <d1p1:LineIndex>1864</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> period has passed) then there's no point even rendering the button.</d1p1:Content>
          <d1p1:LineIndex>1865</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1866</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bHasBookableUnits</d1p1:Content>
                    <d1p1:LineIndex>1866</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1866</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_RenderButtons</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iStayNum</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objAvailEntry</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>IsExternal</d1p1:Content>
                      <d1p1:LineIndex>1867</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> if we have an invalid indicative unit or telephone unit then</d1p1:Content>
          <d1p1:LineIndex>1870</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> render this message - let the js do the rest</d1p1:Content>
          <d1p1:LineIndex>1871</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bHasNonBookableUnits</d1p1:Content>
                    <d1p1:LineIndex>1872</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2010-07-09 PW: RIP Gary</d1p1:Content>
                  <d1p1:LineIndex>1874</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> This is the array formerly known as garyTeleBookUnitKeys</d1p1:Content>
                  <d1p1:LineIndex>1875</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> it is used for switching between the online book button if the unit is bookable</d1p1:Content>
                  <d1p1:LineIndex>1876</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> or rendering the relevant warning message if it isn't</d1p1:Content>
                  <d1p1:LineIndex>1877</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> 2010-10-21 TB: augmenting Gary with stay key. This is to allow for multiple stays</d1p1:Content>
                  <d1p1:LineIndex>1878</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> in which this JS is executed on a per stay basis via a partial render.</d1p1:Content>
                  <d1p1:LineIndex>1879</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1880</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1880</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1880</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;script type="text/javascript"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1880</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1880</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbCrLf</d1p1:Content>
                      <d1p1:LineIndex>1880</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> var aryNonBookableUnits_</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iStayNum</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> = [</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strNonBookableUnits</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>]; </d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbCrLf</d1p1:Content>
                      <d1p1:LineIndex>1881</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> var iTotalNonBookableUnits = </d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>;</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbCrLf</d1p1:Content>
                      <d1p1:LineIndex>1882</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1883</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1883</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1883</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/</d1p1:Content>
                      <d1p1:LineIndex>1883</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1883</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>script&gt;</d1p1:Content>
                      <d1p1:LineIndex>1883</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Render relevant offline booking message</d1p1:Content>
                  <d1p1:LineIndex>1885</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1886</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1886</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1886</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div id="pnTeleBook_PromptCall"&gt;</d1p1:Content>
                      <d1p1:LineIndex>1886</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Site</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Params</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>Booking_EnableByPhone</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1887</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;p&gt;</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                              <d1p1:Content>Replace</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/telebook/prompt</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>One or more of the units you have selected must be booked via telephone. Please ring #bookingtelephone# to continue this booking.</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>#bookingtelephone#</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Site</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Params</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>Booking_TelephoneNumber</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;/p&gt;</d1p1:Content>
                              <d1p1:LineIndex>1888</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;p&gt;</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>Replace</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Resource</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>bookonline/unitselection/indtelebook/prompt</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>Although available, some of the units you have selected cannot be booked online. Alternatively, select different units with online booking only.</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>#bookingtelephone#</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Site</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Params</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>Booking_TelephoneNumber</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>&lt;/p&gt;</d1p1:Content>
                            <d1p1:LineIndex>1890</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1892</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1892</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1892</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>1892</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_GetPreSelectedUnitKey</d1p1:Content>
        <d1p1:LineIndex>1898</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
            <d1p1:LineIndex>1898</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>iReqNo</d1p1:Content>
            <d1p1:LineIndex>1898</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> remote referrals (eg. VB integration) will include a UNIT_KEY choice and CHILD_COUNT.</d1p1:Content>
          <d1p1:LineIndex>1899</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> eg. Request vars formatted as 'URslt[REQ_NUMBER]=[UNIT_KEY]-[NUM_ADULT]-[NUM-CHILD]'</d1p1:Content>
          <d1p1:LineIndex>1900</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If not got here from a remote referral (eg. VB integration), the lsRemoveUnitSelections will be Nothing</d1p1:Content>
          <d1p1:LineIndex>1902</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>1903</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1903</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                    <d1p1:LineIndex>1903</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>is</d1p1:Content>
                    <d1p1:LineIndex>1903</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Nothing</d1p1:Content>
                    <d1p1:LineIndex>1903</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1903</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Get unit selection passed in (may be zero if invalid request was made)</d1p1:Content>
                  <d1p1:LineIndex>1904</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Note: lsRemoteUnitSelections has zero-based index, iReqNo is one-based</d1p1:Content>
                  <d1p1:LineIndex>1905</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iReqNo</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>&gt;</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>1</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                            <d1p1:Content>And</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iReqNo</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>&lt;</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Count</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1906</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>lsRemoteUnitSelections</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iReqNo</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>-</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>1</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>BookingUI_GetPreSelectedUnitKey</d1p1:Content>
                                <d1p1:LineIndex>1907</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ExitStatement">
                          <d1p1:LineIndex>1908</d1p1:LineIndex>
                          <d1p1:StatementType>Function</d1p1:StatementType>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>1912</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_GetPreSelectedUnitKey</d1p1:Content>
                <d1p1:LineIndex>1912</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: for VB Polling - we want to render a supplier name and icon above each set of unit options</d1p1:Content>
      <d1p1:LineIndex>1915</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayDetails_PollingHeader</d1p1:Content>
        <d1p1:LineIndex>1916</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvailEntry</d1p1:Content>
            <d1p1:LineIndex>1916</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>1916</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierLogo</d1p1:Content>
            <d1p1:LineIndex>1916</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strSupplierName</d1p1:Content>
            <d1p1:LineIndex>1916</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Render header content (icon, if specified) and supplier name</d1p1:Content>
          <d1p1:LineIndex>1918</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2008-12-18 DWR: Add a style to indicate whether supplier is Local, FrontDesk or External (this will</d1p1:Content>
          <d1p1:LineIndex>1919</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> allow a custom logo to be used for Local or FrontDesk, for example)</d1p1:Content>
          <d1p1:LineIndex>1920</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1921</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1921</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1921</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="StayCandidateItemHeader </d1p1:Content>
              <d1p1:LineIndex>1921</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1922</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>1922</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1922</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsLocal</d1p1:Content>
                    <d1p1:LineIndex>1922</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1922</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1923</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1923</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1923</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> AvailLocal</d1p1:Content>
                      <d1p1:LineIndex>1923</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1924</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>1924</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1924</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsRemote</d1p1:Content>
                    <d1p1:LineIndex>1924</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1924</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1925</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1925</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1925</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> AvailFrontDesk</d1p1:Content>
                      <d1p1:LineIndex>1925</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>pO</d1p1:Content>
                    <d1p1:LineIndex>1927</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>1927</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Write</d1p1:Content>
                    <d1p1:LineIndex>1927</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content> AvailExternal</d1p1:Content>
                    <d1p1:LineIndex>1927</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1929</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1929</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1929</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>"&gt;</d1p1:Content>
              <d1p1:LineIndex>1929</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1930</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strSupplierLogo</d1p1:Content>
                    <d1p1:LineIndex>1930</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>1930</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1930</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>1930</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1930</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;img src="</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierLogo</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" alt="</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strSupplierName</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>1931</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;h2&gt;</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strSupplierName</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/h2&gt;</d1p1:Content>
              <d1p1:LineIndex>1933</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>1934</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>1934</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>1934</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>1934</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>1934</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>1934</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>tries to get a supplier logo for us</d1p1:Content>
      <d1p1:LineIndex>1937</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>GetSupplierLogo</d1p1:Content>
        <d1p1:LineIndex>1938</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>strProductEstateID</d1p1:Content>
            <d1p1:LineIndex>1938</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strSupplierLogo</d1p1:Content>
                <d1p1:LineIndex>1939</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content></d1p1:Content>
                <d1p1:LineIndex>1939</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strSupplierLogo</d1p1:Content>
                <d1p1:LineIndex>1939</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsExternalBooking</d1p1:Content>
                    <d1p1:LineIndex>1940</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>ImageResource</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>bookonline/unitselection/polling/localsupplier/estate_</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strProductEstateID</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>/logo</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content></d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strSupplierLogo</d1p1:Content>
                        <d1p1:LineIndex>1941</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1942</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strSupplierLogo</d1p1:Content>
                            <d1p1:LineIndex>1942</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1942</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content></d1p1:Content>
                            <d1p1:LineIndex>1942</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1942</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Page</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Resource</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>bookonline/unitselection/polling/localsupplier/estate_</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strProductEstateID</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>/logo</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content></d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strSupplierLogo</d1p1:Content>
                                <d1p1:LineIndex>1943</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:IfBlock">
                          <d1p1:ConditionalClauses>
                            <d1p1:IfBlock.IfBlockConditionSegment>
                              <d1p1:Condition>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierLogo</d1p1:Content>
                                    <d1p1:LineIndex>1944</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                    <d1p1:Content>&lt;</d1p1:Content>
                                    <d1p1:LineIndex>1944</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                    <d1p1:Content>&gt;</d1p1:Content>
                                    <d1p1:LineIndex>1944</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content></d1p1:Content>
                                    <d1p1:LineIndex>1944</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Condition>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:Statement">
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>Page</d1p1:Content>
                                      <d1p1:LineIndex>1945</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>1945</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                                      <d1p1:LineIndex>1945</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>Loaded estate scoped supplier logo from a deprecated location - please move it to the image resources language file</d1p1:Content>
                                      <d1p1:LineIndex>1945</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d1p1:IfBlock.IfBlockConditionSegment>
                          </d1p1:ConditionalClauses>
                          <d1p1:OptionalElseClause i:nil="true" />
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1949</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strSupplierLogo</d1p1:Content>
                    <d1p1:LineIndex>1949</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>1949</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>1949</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1949</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>ImageResource</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>bookonline/unitselection/polling/localsupplier/logo</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content></d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strSupplierLogo</d1p1:Content>
                        <d1p1:LineIndex>1950</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>1951</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strSupplierLogo</d1p1:Content>
                            <d1p1:LineIndex>1951</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>1951</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content></d1p1:Content>
                            <d1p1:LineIndex>1951</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>1951</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Page</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>Resource</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content>bookonline/unitselection/polling/localsupplier/logo</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:StringToken">
                                <d1p1:Content></d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strSupplierLogo</d1p1:Content>
                                <d1p1:LineIndex>1952</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:IfBlock">
                          <d1p1:ConditionalClauses>
                            <d1p1:IfBlock.IfBlockConditionSegment>
                              <d1p1:Condition>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strSupplierLogo</d1p1:Content>
                                    <d1p1:LineIndex>1953</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                    <d1p1:Content>&lt;</d1p1:Content>
                                    <d1p1:LineIndex>1953</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                                    <d1p1:Content>&gt;</d1p1:Content>
                                    <d1p1:LineIndex>1953</d1p1:LineIndex>
                                  </d2p1:anyType>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content></d1p1:Content>
                                    <d1p1:LineIndex>1953</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Condition>
                              <d1p1:Statements>
                                <d2p1:anyType i:type="d1p1:Statement">
                                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                  <d1p1:Tokens>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>Page</d1p1:Content>
                                      <d1p1:LineIndex>1954</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                      <d1p1:Content>.</d1p1:Content>
                                      <d1p1:LineIndex>1954</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:NameToken">
                                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                                      <d1p1:LineIndex>1954</d1p1:LineIndex>
                                    </d2p1:anyType>
                                    <d2p1:anyType i:type="d1p1:StringToken">
                                      <d1p1:Content>Loaded estate scoped supplier logo from a deprecated location - please move it to the image resources language file</d1p1:Content>
                                      <d1p1:LineIndex>1954</d1p1:LineIndex>
                                    </d2p1:anyType>
                                  </d1p1:Tokens>
                                </d2p1:anyType>
                              </d1p1:Statements>
                            </d1p1:IfBlock.IfBlockConditionSegment>
                          </d1p1:ConditionalClauses>
                          <d1p1:OptionalElseClause i:nil="true" />
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strSupplierLogo</d1p1:Content>
                <d1p1:LineIndex>1958</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetSupplierLogo</d1p1:Content>
                <d1p1:LineIndex>1958</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: return URL which browsers without Javascript can use to navigate stay candidates page</d1p1:Content>
      <d1p1:LineIndex>1961</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiStay]: integer stay number. 1 = 1st stay, 2 = 2nd stay. Zero produces back URL to stay candidates page</d1p1:Content>
      <d1p1:LineIndex>1962</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: string URL for hyperlink</d1p1:Content>
      <d1p1:LineIndex>1963</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayDetailsUrl</d1p1:Content>
        <d1p1:LineIndex>1964</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiStay</d1p1:Content>
            <d1p1:LineIndex>1964</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sUrl</d1p1:Content>
                <d1p1:LineIndex>1965</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sStay</d1p1:Content>
                <d1p1:LineIndex>1965</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iPos</d1p1:Content>
                <d1p1:LineIndex>1965</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sRight</d1p1:Content>
                <d1p1:LineIndex>1965</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> get current URL. Prepare [stay] variable to be appended to URL</d1p1:Content>
          <d1p1:LineIndex>1967</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Request</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ServerVariables</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>HTTP_X_REWRITE_URL</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sUrl</d1p1:Content>
                <d1p1:LineIndex>1968</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>aiStay</d1p1:Content>
                    <d1p1:LineIndex>1969</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1969</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1969</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>&amp;_stay=</d1p1:Content>
                        <d1p1:LineIndex>1970</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>1970</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aiStay</d1p1:Content>
                        <d1p1:LineIndex>1970</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sStay</d1p1:Content>
                        <d1p1:LineIndex>1970</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content></d1p1:Content>
                      <d1p1:LineIndex>1972</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>sStay</d1p1:Content>
                      <d1p1:LineIndex>1972</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> does URL already have stay variable? if so, remove it and return new URL</d1p1:Content>
          <d1p1:LineIndex>1975</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Instr</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sUrl</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>&amp;_stay=</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iPos</d1p1:Content>
                <d1p1:LineIndex>1976</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iPos</d1p1:Content>
                    <d1p1:LineIndex>1977</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>1977</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>1977</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Mid</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sUrl</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iPos</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>+</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>7</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sRight</d1p1:Content>
                        <d1p1:LineIndex>1978</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Instr</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sRight</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iRight</d1p1:Content>
                        <d1p1:LineIndex>1979</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Left</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sUrl</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iPos</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>-</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sUrl</d1p1:Content>
                        <d1p1:LineIndex>1980</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iRight</d1p1:Content>
                            <d1p1:LineIndex>1981</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>&gt;</d1p1:Content>
                            <d1p1:LineIndex>1981</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>0</d1p1:Content>
                            <d1p1:LineIndex>1981</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>sUrl</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>&amp;</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                <d1p1:Content>Mid</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>sRight</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>iRight</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>sUrl</d1p1:Content>
                                <d1p1:LineIndex>1981</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sUrl</d1p1:Content>
                <d1p1:LineIndex>1983</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>1983</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sStay</d1p1:Content>
                <d1p1:LineIndex>1983</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_StayDetailsUrl</d1p1:Content>
                <d1p1:LineIndex>1983</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: render new stay UI - WARNING: this doesn't close all of the elements it opens!</d1p1:Content>
      <d1p1:LineIndex>1986</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [objAvailEntry]: avail data for a single stay</d1p1:Content>
      <d1p1:LineIndex>1987</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiStayNum]: integer stay index (1-based)</d1p1:Content>
      <d1p1:LineIndex>1988</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtStartNight]: date requested start night</d1p1:Content>
      <d1p1:LineIndex>1989</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiReqNights]: integer requested num nights</d1p1:Content>
      <d1p1:LineIndex>1990</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderNewStay</d1p1:Content>
        <d1p1:LineIndex>1991</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvailEntry</d1p1:Content>
            <d1p1:LineIndex>1991</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiStayNum</d1p1:Content>
            <d1p1:LineIndex>1991</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>adtStartNight</d1p1:Content>
            <d1p1:LineIndex>1991</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiReqNights</d1p1:Content>
            <d1p1:LineIndex>1991</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>1991</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sPostfix</d1p1:Content>
                <d1p1:LineIndex>1992</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bPrecise</d1p1:Content>
                <d1p1:LineIndex>1992</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Render slightly differently if got a precise match</d1p1:Content>
          <d1p1:LineIndex>1994</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - Also render differently when VB Polling enabled, since we have to render</d1p1:Content>
          <d1p1:LineIndex>1995</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>   more of these sections than otherwise</d1p1:Content>
          <d1p1:LineIndex>1996</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bExactMatch</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>StartDate</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                <d1p1:Content>=</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>adtStartNight</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                <d1p1:Content>And</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                <d1p1:Content>=</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiReqNights</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bExactMatch</d1p1:Content>
                <d1p1:LineIndex>1997</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bExactMatch</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>1998</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>True</d1p1:Content>
                        <d1p1:LineIndex>1999</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>bPrecise</d1p1:Content>
                        <d1p1:LineIndex>1999</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>2000</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sPostfix</d1p1:Content>
                        <d1p1:LineIndex>2000</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>CLng</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Request</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>_stay</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>aiStayNum</d1p1:Content>
                    <d1p1:LineIndex>2001</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>2002</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>sPostfix</d1p1:Content>
                        <d1p1:LineIndex>2002</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content></d1p1:Content>
                      <d1p1:LineIndex>2004</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>sPostfix</d1p1:Content>
                      <d1p1:LineIndex>2004</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If not exact match then render a warning as well as the date difference later</d1p1:Content>
          <d1p1:LineIndex>2007</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>2008</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bExactMatch</d1p1:Content>
                    <d1p1:LineIndex>2008</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>RenderNotRequiredDateWarning</d1p1:Content>
                      <d1p1:LineIndex>2009</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2009</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="StayCandidateItem</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>sPostfix</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>"&gt;</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2012</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>2014</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bExactMatch</d1p1:Content>
                    <d1p1:LineIndex>2014</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2015</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2015</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2015</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="pnStayTtl"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2015</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2016</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2016</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2016</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;p&gt;</d1p1:Content>
                      <d1p1:LineIndex>2016</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_StayTtl</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objAvailEntry</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>StartDate</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objAvailEntry</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Nights</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2017</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2018</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2018</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2018</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/p&gt;</d1p1:Content>
                      <d1p1:LineIndex>2018</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2019</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2019</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2019</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>2019</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2019</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>vbCrLf</d1p1:Content>
                      <d1p1:LineIndex>2019</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                            <d1p1:Content>Not</d1p1:Content>
                            <d1p1:LineIndex>2020</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bRenderAsCalendar</d1p1:Content>
                            <d1p1:LineIndex>2020</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>BookingUI_StayDiff</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>adtStartNight</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>objAvailEntry</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>StartDate</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>aiReqNights</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>objAvailEntry</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Nights</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>2021</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: return title for this stay candidate</d1p1:Content>
      <d1p1:LineIndex>2026</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiNights]: integer number nights for this stay</d1p1:Content>
      <d1p1:LineIndex>2027</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtFirstNight]: date of first night</d1p1:Content>
      <d1p1:LineIndex>2028</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtLastNight]: date of last night</d1p1:Content>
      <d1p1:LineIndex>2029</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: string stay title</d1p1:Content>
      <d1p1:LineIndex>2030</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayTtl</d1p1:Content>
        <d1p1:LineIndex>2031</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>adtFirstNight</d1p1:Content>
            <d1p1:LineIndex>2031</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiNights</d1p1:Content>
            <d1p1:LineIndex>2031</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>aiNights</d1p1:Content>
                    <d1p1:LineIndex>2032</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>2032</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>2032</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aiNights</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Resource</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>bookonline/unitselection/nightstart</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content> night, start </d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>2034</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Page</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Functions</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Dates</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>ShortDate</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>adtFirstNight</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2035</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_StayTtl</d1p1:Content>
                        <d1p1:LineIndex>2033</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>2036</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiNights</d1p1:Content>
                <d1p1:LineIndex>2040</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2040</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/nightsfrom</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content> nights, from </d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2041</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ShortDate</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>adtFirstNight</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2042</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/to</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content> to </d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2043</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Dates</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Shortdate</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>DateAdd</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>d</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiNights</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>adtFirstNight</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2044</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_StayTtl</d1p1:Content>
                <d1p1:LineIndex>2039</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: describe difference between THIS DATE and REQUESTED stay date</d1p1:Content>
      <d1p1:LineIndex>2047</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtReqDate]: date of REQUESTED first night of stay</d1p1:Content>
      <d1p1:LineIndex>2048</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [adtThisDate]: date of RESULTANT first night of stay</d1p1:Content>
      <d1p1:LineIndex>2049</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiReqNights]: integer requested num nights</d1p1:Content>
      <d1p1:LineIndex>2050</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiNights]: integer result num nights</d1p1:Content>
      <d1p1:LineIndex>2051</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_StayDiff</d1p1:Content>
        <d1p1:LineIndex>2052</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>adtReqDate</d1p1:Content>
            <d1p1:LineIndex>2052</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>adtThisDate</d1p1:Content>
            <d1p1:LineIndex>2052</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiReqNights</d1p1:Content>
            <d1p1:LineIndex>2052</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiResultNights</d1p1:Content>
            <d1p1:LineIndex>2052</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iDateDiff</d1p1:Content>
                <d1p1:LineIndex>2053</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iDurDiff</d1p1:Content>
                <d1p1:LineIndex>2053</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>DateDiff</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>d</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>adtReqDate</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>adtThisDate</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iDateDiff</d1p1:Content>
                <d1p1:LineIndex>2055</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiResultNights</d1p1:Content>
                <d1p1:LineIndex>2056</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>2056</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiReqNights</d1p1:Content>
                <d1p1:LineIndex>2056</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iDurDiff</d1p1:Content>
                <d1p1:LineIndex>2056</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>&lt;div class="pnStayDiff"&gt;</d1p1:Content>
                <d1p1:LineIndex>2058</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2058</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Booking</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Booking_MatchQual</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iDateDiff</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iDurDiff</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiReqNights</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>2</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2059</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                <d1p1:LineIndex>2060</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2060</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>vbCrLf</d1p1:Content>
                <d1p1:LineIndex>2060</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_StayDiff</d1p1:Content>
                <d1p1:LineIndex>2057</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: render new requirement UI - WARNING: this doesn't close all of the elements it opens!</d1p1:Content>
      <d1p1:LineIndex>2063</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [arsAvail]: ADO unit recordset from availability object</d1p1:Content>
      <d1p1:LineIndex>2064</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiStayNum]: integer stay index</d1p1:Content>
      <d1p1:LineIndex>2065</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiThisReqmnt]: integer requirement number (from recordset)</d1p1:Content>
      <d1p1:LineIndex>2066</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderNewReq</d1p1:Content>
        <d1p1:LineIndex>2067</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objUnit</d1p1:Content>
            <d1p1:LineIndex>2067</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiStayNum</d1p1:Content>
            <d1p1:LineIndex>2067</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiThisReqmnt</d1p1:Content>
            <d1p1:LineIndex>2067</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>abRemote</d1p1:Content>
            <d1p1:LineIndex>2067</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>2067</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iSz</d1p1:Content>
                <d1p1:LineIndex>2069</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sReqmntSet</d1p1:Content>
                <d1p1:LineIndex>2069</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sRemoteRqmnt</d1p1:Content>
                <d1p1:LineIndex>2069</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iChild</d1p1:Content>
                <d1p1:LineIndex>2070</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iRemoteNumChild</d1p1:Content>
                <d1p1:LineIndex>2070</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sSelected</d1p1:Content>
                <d1p1:LineIndex>2070</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2074</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2074</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ReqSize</d1p1:Content>
                <d1p1:LineIndex>2074</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iSz</d1p1:Content>
                <d1p1:LineIndex>2074</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2076</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2076</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2076</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnStayReqmnt"&gt;</d1p1:Content>
              <d1p1:LineIndex>2076</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2076</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2076</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2077</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2077</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2077</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnStayReqmntTtl"&gt;</d1p1:Content>
              <d1p1:LineIndex>2077</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/unitselection/room</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>Room</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2078</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2079</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2079</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2079</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> </d1p1:Content>
              <d1p1:LineIndex>2079</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2080</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2080</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2080</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiThisReqmnt</d1p1:Content>
              <d1p1:LineIndex>2080</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2081</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2081</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2081</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> - </d1p1:Content>
              <d1p1:LineIndex>2081</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/unitselection/for</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>for</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2082</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2083</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2083</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2083</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> </d1p1:Content>
              <d1p1:LineIndex>2083</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2084</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2084</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2084</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>iSz</d1p1:Content>
              <d1p1:LineIndex>2084</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2085</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2085</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2085</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> </d1p1:Content>
              <d1p1:LineIndex>2085</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/unitselection/guest(s)</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>guest(s)</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2086</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>#MJ -	We can only render our room requirement data based upon the recieved dat, not the requirement we passed in, as it may have been fulfilled in a different order</d1p1:Content>
          <d1p1:LineIndex>2088</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>2012-03-29 NP: Here we render the requirements that are linked to the unit stay details in the response from the Avail Component</d1p1:Content>
          <d1p1:LineIndex>2089</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> we do NOT want to render the original request against each unit that is rendered because they may not order up</d1p1:Content>
          <d1p1:LineIndex>2090</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Example: Request roomReq_1 = 2; roomReq_2 = 1; Response may come back in a different order</d1p1:Content>
          <d1p1:LineIndex>2091</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> i.e. unit_1 with ReqSize = 1, unit_2 with ReqSize = 2 so roomReq_1 = 1, roomReq= 2; they end up swapped around</d1p1:Content>
          <d1p1:LineIndex>2092</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="hidden" name="roomReq_</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiThisReqmnt</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" value="</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>iSz</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>2093</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>#MJ - need to check with Rich if we want to indicate who's going into what room</d1p1:Content>
          <d1p1:LineIndex>2095</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_ChildPricing</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objUnit</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>ChildrenRequirement</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>2096</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2097</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2097</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2097</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> - (</d1p1:Content>
                      <d1p1:LineIndex>2097</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2098</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2098</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2098</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;span class="ReqmntDetails"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2098</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>adults</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Adults</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2099</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2100</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2100</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2100</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>: </d1p1:Content>
                      <d1p1:LineIndex>2100</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2101</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2101</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2101</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2101</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2101</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>AdultsRequirement</d1p1:Content>
                      <d1p1:LineIndex>2101</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2102</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2102</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2102</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> </d1p1:Content>
                      <d1p1:LineIndex>2102</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>children</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Children</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2103</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2104</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2104</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2104</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>: </d1p1:Content>
                      <d1p1:LineIndex>2104</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2105</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2105</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2105</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2105</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2105</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ChildrenRequirement</d1p1:Content>
                      <d1p1:LineIndex>2105</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2106</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2106</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2106</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>) </d1p1:Content>
                      <d1p1:LineIndex>2106</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2107</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2107</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2107</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                      <d1p1:LineIndex>2107</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> NP 2012-03-01: Child pricing requirements were not previously being posted to the checkout</d1p1:Content>
                  <d1p1:LineIndex>2108</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Adult &amp; Child Requirement amount is needed by the RequirementSummary control and the child ages are</d1p1:Content>
                  <d1p1:LineIndex>2109</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> needed by the checkout for creating the correct requirement record with the relevant discount values</d1p1:Content>
                  <d1p1:LineIndex>2110</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="roomReq_</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>_adults" value="</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>AdultsRequirement</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>2111</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" name="roomReq_</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>_children" value="</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ChildrenRequirement</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>2112</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> ChildrenAges is a comma separated list of ages or "", Split will give an empty array if this property is ever Empty</d1p1:Content>
                  <d1p1:LineIndex>2114</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:DimStatement">
                  <d1p1:Variables>
                    <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                      <d1p1:Dimensions i:nil="true" />
                      <d1p1:Name>
                        <d1p1:Content>aryChildAges</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d1p1:Name>
                    </d1p1:DimVariable>
                  </d1p1:Variables>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Split</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objUnit</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>ChildrenAges</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>,</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aryChildAges</d1p1:Content>
                        <d1p1:LineIndex>2115</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:DimStatement">
                  <d1p1:Variables>
                    <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
                      <d1p1:Dimensions i:nil="true" />
                      <d1p1:Name>
                        <d1p1:Content>iChildAgeIndex</d1p1:Content>
                        <d1p1:LineIndex>2116</d1p1:LineIndex>
                      </d1p1:Name>
                    </d1p1:DimVariable>
                  </d1p1:Variables>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ForBlock">
                  <d1p1:LoopFrom>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>2116</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopFrom>
                  <d1p1:LoopStep i:nil="true" />
                  <d1p1:LoopTo>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>UBound</d1p1:Content>
                        <d1p1:LineIndex>2116</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2116</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aryChildAges</d1p1:Content>
                        <d1p1:LineIndex>2116</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2116</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopTo>
                  <d1p1:LoopVar>
                    <d1p1:Content>iChildAgeIndex</d1p1:Content>
                    <d1p1:LineIndex>2116</d1p1:LineIndex>
                  </d1p1:LoopVar>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;input type="hidden" name="roomReq_</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>aiThisReqmnt</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>_children_childage</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iChildAgeIndex</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>" value="</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>aryChildAges</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iChildAgeIndex</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>" /&gt;</d1p1:Content>
                          <d1p1:LineIndex>2117</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2122</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2122</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2122</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>2122</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2122</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2122</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2123</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2123</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2123</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnStayReqmntRslts"&gt;</d1p1:Content>
              <d1p1:LineIndex>2123</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2123</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2123</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: render unit option HTML</d1p1:Content>
      <d1p1:LineIndex>2127</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiStayNum]: integer stay index</d1p1:Content>
      <d1p1:LineIndex>2128</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiThisReqmnt]: integer requirement index</d1p1:Content>
      <d1p1:LineIndex>2129</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiUnitKey]: integer unit key</d1p1:Content>
      <d1p1:LineIndex>2130</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [bSelected]: should the current unit appear selected</d1p1:Content>
      <d1p1:LineIndex>2131</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [arsAvail]: ADO availability recordset</d1p1:Content>
      <d1p1:LineIndex>2132</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [asAvailClassName]: string avail class name</d1p1:Content>
      <d1p1:LineIndex>2133</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderUnit</d1p1:Content>
        <d1p1:LineIndex>2134</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiStayNum</d1p1:Content>
            <d1p1:LineIndex>2135</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiThisReqmnt</d1p1:Content>
            <d1p1:LineIndex>2136</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bSelected</d1p1:Content>
            <d1p1:LineIndex>2137</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvailEntry</d1p1:Content>
            <d1p1:LineIndex>2138</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objUnit</d1p1:Content>
            <d1p1:LineIndex>2139</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAllUnits</d1p1:Content>
            <d1p1:LineIndex>2140</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>asAvailClassName</d1p1:Content>
            <d1p1:LineIndex>2141</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>2142</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bRenderMaximumUnitsAvailable</d1p1:Content>
            <d1p1:LineIndex>2143</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>mUnitStayTotal</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iNumNights</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>mUnitPerNight</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iNumPeople</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iDaysBreakfast</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bPerPerson</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>mPersonPerNight</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strIptId</d1p1:Content>
                <d1p1:LineIndex>2145</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>mUnitStayTotalPayableBasedOnGuidePrice</d1p1:Content>
                <d1p1:LineIndex>2146</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>bDiscountApplied</d1p1:Content>
                <d1p1:LineIndex>2146</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iAdults</d1p1:Content>
                <d1p1:LineIndex>2147</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iChildren</d1p1:Content>
                <d1p1:LineIndex>2147</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2150</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2150</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>StayTotalPayable</d1p1:Content>
                <d1p1:LineIndex>2150</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>mUnitStayTotal</d1p1:Content>
                <d1p1:LineIndex>2150</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2151</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2151</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>StayTotalPayableBasedOnGuidePrice</d1p1:Content>
                <d1p1:LineIndex>2151</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>mUnitStayTotalPayableBasedOnGuidePrice</d1p1:Content>
                <d1p1:LineIndex>2151</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAvailEntry</d1p1:Content>
                <d1p1:LineIndex>2152</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2152</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Nights</d1p1:Content>
                <d1p1:LineIndex>2152</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNumNights</d1p1:Content>
                <d1p1:LineIndex>2152</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>mUnitStayTotal</d1p1:Content>
                <d1p1:LineIndex>2153</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>/</d1p1:Content>
                <d1p1:LineIndex>2153</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNumNights</d1p1:Content>
                <d1p1:LineIndex>2153</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>mUnitPerNight</d1p1:Content>
                <d1p1:LineIndex>2153</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2154</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2154</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Perperson</d1p1:Content>
                <d1p1:LineIndex>2154</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bPerPerson</d1p1:Content>
                <d1p1:LineIndex>2154</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2155</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2155</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ReqSize</d1p1:Content>
                <d1p1:LineIndex>2155</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iNumPeople</d1p1:Content>
                <d1p1:LineIndex>2155</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2157</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2157</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>DaysBreakfast</d1p1:Content>
                <d1p1:LineIndex>2157</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iDaysBreakfast</d1p1:Content>
                <d1p1:LineIndex>2157</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2158</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2158</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>IncludesChildDiscount</d1p1:Content>
                <d1p1:LineIndex>2158</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>bDiscountApplied</d1p1:Content>
                <d1p1:LineIndex>2158</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iMaxUnitsAvailable</d1p1:Content>
                <d1p1:LineIndex>2160</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2160</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2160</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>MaximumQuantityAvailable</d1p1:Content>
                <d1p1:LineIndex>2160</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>iMaxUnitsAvailable</d1p1:Content>
                <d1p1:LineIndex>2160</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> We need an id so we can set the label's "for" attribute, but if VB Polling is enabled,</d1p1:Content>
          <d1p1:LineIndex>2162</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> we might end up with id duplication - so in that case we append a random suffix</d1p1:Content>
          <d1p1:LineIndex>2163</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>unit_</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiStayNum</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>_</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aiThisReqmnt</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>_</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>UnitKey</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strIptId</d1p1:Content>
                <d1p1:LineIndex>2164</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2165</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                    <d1p1:LineIndex>2165</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2165</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strIptId</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>_</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Int</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Rnd</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>*</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>100000</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strIptId</d1p1:Content>
                        <d1p1:LineIndex>2166</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2169</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2169</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2169</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnUnitOption"&gt;</d1p1:Content>
              <d1p1:LineIndex>2169</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input type="radio" name="unit_</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiStayNum</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>_</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiThisReqmnt</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>id="</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strIptId</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2170</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>2171</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2171</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                    <d1p1:LineIndex>2171</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2171</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:CommentStatement">
                  <d1p1:Content> Not sure this onclick is even required without VB Polling.. (?)</d1p1:Content>
                  <d1p1:LineIndex>2172</d1p1:LineIndex>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2173</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2173</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2173</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>onclick="BookingUI_UnitSelect(this);" </d1p1:Content>
                      <d1p1:LineIndex>2173</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>value="</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objUnit</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>UnitKey</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2175</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2176</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bSelected</d1p1:Content>
                    <d1p1:LineIndex>2176</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2176</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2177</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2177</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2177</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>checked="checked" </d1p1:Content>
                      <d1p1:LineIndex>2177</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2179</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2179</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2179</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>/&gt;</d1p1:Content>
              <d1p1:LineIndex>2179</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;label for="</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strIptId</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>"&gt; </d1p1:Content>
              <d1p1:LineIndex>2180</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objUnit</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>UnitName</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> - </d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_NicePrice</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>mUnitStayTotal</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content> </d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>asAvailClassName</d1p1:Content>
              <d1p1:LineIndex>2181</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>if we have child pricing discount applied show the icon</d1p1:Content>
          <d1p1:LineIndex>2183</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bDiscountApplied</d1p1:Content>
                    <d1p1:LineIndex>2184</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>DISCOUNT</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2185</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2188</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2188</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2188</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/label&gt;</d1p1:Content>
              <d1p1:LineIndex>2188</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2189</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2189</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2189</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>2189</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2189</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2189</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2190</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2190</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2190</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnPriceBase"&gt;</d1p1:Content>
              <d1p1:LineIndex>2190</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2190</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2190</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>#MJ 29/04/2010 -	decision made not to show the price basis as the per person figure was always a guestimate, child pricing messes with the price so per person doesn't apply</d1p1:Content>
          <d1p1:LineIndex>2192</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>					also we now always deal with total stay prices</d1p1:Content>
          <d1p1:LineIndex>2193</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>				If bPerPerson Then</d1p1:Content>
          <d1p1:LineIndex>2194</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>					mPersonPerNight = mUnitPerNight/iNumPeople</d1p1:Content>
          <d1p1:LineIndex>2195</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>					pO.Write BookingUI_NicePrice(mPersonPerNight) &amp; " " &amp; Page.Resource("bookonline/unitselection/perpersonpernight", "per person per night") &amp; ". "</d1p1:Content>
          <d1p1:LineIndex>2196</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>				Else</d1p1:Content>
          <d1p1:LineIndex>2197</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>					pO.Write BookingUI_NicePrice(mUnitPerNight) &amp; " " &amp; Page.Resource("bookonline/unitselection/perroomunitpernight", "per room/unit per night") &amp; ". "</d1p1:Content>
          <d1p1:LineIndex>2198</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>				End If</d1p1:Content>
          <d1p1:LineIndex>2199</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iDaysBreakfast</d1p1:Content>
                    <d1p1:LineIndex>2201</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>2201</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iNumNights</d1p1:Content>
                    <d1p1:LineIndex>2201</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/breakfastincluded</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Breakfast included</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>. </d1p1:Content>
                      <d1p1:LineIndex>2202</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2203</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iDaysBreakfast</d1p1:Content>
                    <d1p1:LineIndex>2203</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2203</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>2203</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2203</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/breakfastincludedon</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Breakfast included on </d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iDaysBreakfast</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> </d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/day(s)</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>day(s)</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>. </d1p1:Content>
                      <d1p1:LineIndex>2204</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>iNumPeople</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objUnit</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>MinOcc</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2207</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>bPerPerson</d1p1:Content>
                            <d1p1:LineIndex>2208</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>2209</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2209</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>2209</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>&lt;br /&gt;</d1p1:Content>
                              <d1p1:LineIndex>2209</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/priceperpersonincludes</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>Price Per Person includes</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content> </d1p1:Content>
                              <d1p1:LineIndex>2210</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>BookingUI_NicePrice</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>mPersonPerNight</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>-</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>UnitCostPerPerson</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>/</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>iNumNights</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>2211</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:Statement">
                          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                          <d1p1:Tokens>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>pO</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Write</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Page</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                              <d1p1:Content>.</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:NameToken">
                              <d1p1:Content>Resource</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OpenBrace">
                              <d1p1:Content>(</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>bookonline/unitselection/minimumoccupancysupplement</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                              <d1p1:Content>,</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content> minimum occupancy supplement</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:CloseBrace">
                              <d1p1:Content>)</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:OperatorToken">
                              <d1p1:Content>&amp;</d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                            <d2p1:anyType i:type="d1p1:StringToken">
                              <d1p1:Content>. </d1p1:Content>
                              <d1p1:LineIndex>2212</d1p1:LineIndex>
                            </d2p1:anyType>
                          </d1p1:Tokens>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause>
                    <d1p1:Statements>
                      <d2p1:anyType i:type="d1p1:Statement">
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>pO</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Write</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Page</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Resource</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>bookonline/unitselection/minoccupancyof</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>Min. occupancy of</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content> </d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objUnit</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>MinOcc</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>. </d1p1:Content>
                            <d1p1:LineIndex>2214</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d2p1:anyType>
                    </d1p1:Statements>
                  </d1p1:OptionalElseClause>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnLinkedUnit"&gt;</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>BookingUI_LinkedUnitDesc</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objUnit</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>objAllUnits</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>2217</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2219</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2219</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2219</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>2219</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2219</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2219</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>2221</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2221</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>2221</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2221</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsLocal</d1p1:Content>
                    <d1p1:LineIndex>2221</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2221</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2222</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2222</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2222</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="hidden" </d1p1:Content>
                      <d1p1:LineIndex>2222</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>name="uxml_</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiStayNum</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>_</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiThisReqmnt</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>_</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>UnitKey</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" </d1p1:Content>
                      <d1p1:LineIndex>2223</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>value="</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Server</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>HtmlEncode</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>EviivoMetaData</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" /&gt;</d1p1:Content>
                      <d1p1:LineIndex>2224</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bRenderMaximumUnitsAvailable</d1p1:Content>
                    <d1p1:LineIndex>2227</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2228</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2228</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2228</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div class="maxAvailUnits"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2228</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2229</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2229</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2229</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;p&gt;</d1p1:Content>
                      <d1p1:LineIndex>2229</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;span class="maxAvailUnitsLabelPrefix"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/maxiumunitsavailableprefix</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Only </d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                      <d1p1:LineIndex>2230</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;span class="maxAvailUnitsValue"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>MaximumQuantityAvailable</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                      <d1p1:LineIndex>2231</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;span class="maxAvailUnitsLabelSuffix"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/maxiumunitsavailablesuffix</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content> Rooms Remaining</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/span&gt;</d1p1:Content>
                      <d1p1:LineIndex>2232</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2233</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2233</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2233</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/p&gt;</d1p1:Content>
                      <d1p1:LineIndex>2233</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2234</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2234</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2234</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>2234</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2239</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Generate markup for booking buttons (only used by Acco, not Ticketing)</d1p1:Content>
      <d1p1:LineIndex>2240</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2241</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: render BOOK and BACK buttons</d1p1:Content>
      <d1p1:LineIndex>2242</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [aiStayNum]: integer stay number [1-based]</d1p1:Content>
      <d1p1:LineIndex>2243</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [abPrecise]: boolean precise match (ie. hide BACK button)</d1p1:Content>
      <d1p1:LineIndex>2244</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: string output</d1p1:Content>
      <d1p1:LineIndex>2245</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_RenderButtons</d1p1:Content>
        <d1p1:LineIndex>2246</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>aiStayNum</d1p1:Content>
            <d1p1:LineIndex>2246</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>2246</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>bExternal</d1p1:Content>
            <d1p1:LineIndex>2246</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strClass</d1p1:Content>
                <d1p1:LineIndex>2247</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>btnBookStay</d1p1:Content>
                <d1p1:LineIndex>2247</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strClass</d1p1:Content>
                <d1p1:LineIndex>2247</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>bExternal</d1p1:Content>
                    <d1p1:LineIndex>2249</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strClass</d1p1:Content>
                        <d1p1:LineIndex>2250</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>&amp;</d1p1:Content>
                        <d1p1:LineIndex>2250</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content> redirect</d1p1:Content>
                        <d1p1:LineIndex>2250</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strClass</d1p1:Content>
                        <d1p1:LineIndex>2250</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2253</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2253</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2253</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;div class="pnStayButtons"&gt;</d1p1:Content>
              <d1p1:LineIndex>2253</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2254</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2254</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2254</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;input </d1p1:Content>
              <d1p1:LineIndex>2254</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2255</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2255</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2255</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>type="image" </d1p1:Content>
              <d1p1:LineIndex>2255</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>class="</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>strClass</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2256</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>name="bookstay_</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>aiStayNum</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2257</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Not using ids with VB Polling layout</d1p1:Content>
          <d1p1:LineIndex>2259</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>2260</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2260</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsVBPollingEnabled</d1p1:Content>
                    <d1p1:LineIndex>2260</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2260</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>id="bookstay_</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>aiStayNum</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" </d1p1:Content>
                      <d1p1:LineIndex>2261</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>value="</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/btn/book</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>Book</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2264</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>src="</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>ImageResource</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/btn/book</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Context</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>ImageDir</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>booking/book.gif</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" </d1p1:Content>
              <d1p1:LineIndex>2265</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>alt="</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Page</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Resource</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OpenBrace">
              <d1p1:Content>(</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>bookonline/btn/book</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
              <d1p1:Content>,</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>Book</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CloseBrace">
              <d1p1:Content>)</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>" /&gt;</d1p1:Content>
              <d1p1:LineIndex>2266</d1p1:LineIndex>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:Statement">
          <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
          <d1p1:Tokens>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>pO</d1p1:Content>
              <d1p1:LineIndex>2268</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
              <d1p1:Content>.</d1p1:Content>
              <d1p1:LineIndex>2268</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:NameToken">
              <d1p1:Content>Write</d1p1:Content>
              <d1p1:LineIndex>2268</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:StringToken">
              <d1p1:Content>&lt;/div&gt;</d1p1:Content>
              <d1p1:LineIndex>2268</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:OperatorToken">
              <d1p1:Content>&amp;</d1p1:Content>
              <d1p1:LineIndex>2268</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:BuiltInValueToken">
              <d1p1:Content>vbCrLf</d1p1:Content>
              <d1p1:LineIndex>2268</d1p1:LineIndex>
              <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
            </d2p1:anyType>
          </d1p1:Tokens>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2272</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Translate availability options -&gt; action description string</d1p1:Content>
      <d1p1:LineIndex>2273</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  eg. Telephone Booking       -&gt; "Submit a Booking Enquiry"</d1p1:Content>
      <d1p1:LineIndex>2274</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>      Indicative Availability -&gt; "Confirm availability"</d1p1:Content>
      <d1p1:LineIndex>2275</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2276</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: describe the significant availability type (eg. Indicative, etc)</d1p1:Content>
      <d1p1:LineIndex>2277</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [abIndicative]: boolean indicates whether there is INDICATIVE availability</d1p1:Content>
      <d1p1:LineIndex>2278</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [abIndicValid]: boolean is INDICATIVE availability valid in this case</d1p1:Content>
      <d1p1:LineIndex>2279</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [abTeleBook]: boolean on telebook channel</d1p1:Content>
      <d1p1:LineIndex>2280</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>true</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_AvailClassName</d1p1:Content>
        <d1p1:LineIndex>2281</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>abIndicative</d1p1:Content>
            <d1p1:LineIndex>2281</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>abIndicValid</d1p1:Content>
            <d1p1:LineIndex>2281</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>abTeleBook</d1p1:Content>
            <d1p1:LineIndex>2281</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If telephone booking, there's only one option</d1p1:Content>
          <d1p1:LineIndex>2282</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>abTeleBook</d1p1:Content>
                    <d1p1:LineIndex>2283</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
                        <d1p1:LineIndex>2284</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2284</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>TELE</d1p1:Content>
                        <d1p1:LineIndex>2284</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2284</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_AvailClassName</d1p1:Content>
                        <d1p1:LineIndex>2284</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>2285</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If not telephone and not indicative, must be allocated</d1p1:Content>
          <d1p1:LineIndex>2288</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Not</d1p1:Content>
                    <d1p1:LineIndex>2289</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>abIndicative</d1p1:Content>
                    <d1p1:LineIndex>2289</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
                        <d1p1:LineIndex>2290</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2290</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>ALLOC</d1p1:Content>
                        <d1p1:LineIndex>2290</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2290</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_AvailClassName</d1p1:Content>
                        <d1p1:LineIndex>2290</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>2291</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Otherwise, get appropriate indicative option</d1p1:Content>
          <d1p1:LineIndex>2294</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>abIndicValid</d1p1:Content>
                    <d1p1:LineIndex>2295</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
                        <d1p1:LineIndex>2296</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2296</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>INDIC</d1p1:Content>
                        <d1p1:LineIndex>2296</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2296</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_AvailClassName</d1p1:Content>
                        <d1p1:LineIndex>2296</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
                      <d1p1:LineIndex>2298</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2298</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>TELE</d1p1:Content>
                      <d1p1:LineIndex>2298</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2298</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>BookingUI_AvailClassName</d1p1:Content>
                      <d1p1:LineIndex>2298</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2302</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER:Translate avail class ID -&gt; action description string</d1p1:Content>
      <d1p1:LineIndex>2303</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>  eg. "ALLOC" -&gt; "Book Online"</d1p1:Content>
      <d1p1:LineIndex>2304</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content>      "INDIC" -&gt; "Confirm Availability"</d1p1:Content>
      <d1p1:LineIndex>2305</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2306</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: get HTML for rendering the icon describing the availability class</d1p1:Content>
      <d1p1:LineIndex>2307</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [asAvailClassId]: string availability class ID (ie. ALLOC, INDIC or TELE)</d1p1:Content>
      <d1p1:LineIndex>2308</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: string image describing availClass</d1p1:Content>
      <d1p1:LineIndex>2309</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
        <d1p1:LineIndex>2310</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>asAvailClassId</d1p1:Content>
            <d1p1:LineIndex>2310</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sIcon</d1p1:Content>
                <d1p1:LineIndex>2311</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sTxt</d1p1:Content>
                <d1p1:LineIndex>2311</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sImg</d1p1:Content>
                <d1p1:LineIndex>2311</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>Select Case asAvailClassId</d1p1:Content>
          <d1p1:LineIndex>2313</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>	Case "ALLOC"</d1p1:Content>
          <d1p1:LineIndex>2314</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sIcon="icon_availClass_alloc"</d1p1:Content>
          <d1p1:LineIndex>2315</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sTxt=Page.Resource("bookonline/btn/bookonline","Book Online")</d1p1:Content>
          <d1p1:LineIndex>2316</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>	Case "INDIC"</d1p1:Content>
          <d1p1:LineIndex>2317</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sIcon="icon_availClass_indic"</d1p1:Content>
          <d1p1:LineIndex>2318</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sTxt=Page.Resource("bookonline/btn/confirmavailability","Confirm Availability")</d1p1:Content>
          <d1p1:LineIndex>2319</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>	Case "DISCOUNT"</d1p1:Content>
          <d1p1:LineIndex>2320</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sIcon="icon_availClass_discount"</d1p1:Content>
          <d1p1:LineIndex>2321</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sTxt=Page.Resource("bookonline/btn/discountapplied","Child Pricing Discount Applied")</d1p1:Content>
          <d1p1:LineIndex>2322</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>	Case Else</d1p1:Content>
          <d1p1:LineIndex>2323</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sIcon="icon_availClass_tele"</d1p1:Content>
          <d1p1:LineIndex>2324</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>		sTxt=Page.Resource("bookonline/btn/submitbookingenquiry","Submit a Booking Enquiry")</d1p1:Content>
          <d1p1:LineIndex>2325</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>End Select</d1p1:Content>
          <d1p1:LineIndex>2326</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ImageResource</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/icons/</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sIcon</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Context</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>ImageDir</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>booking/</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sIcon</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>.gif</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sImg</d1p1:Content>
                <d1p1:LineIndex>2328</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>&lt;img src="</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sImg</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>" style="vertical-align:middle;" alt="</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sTxt</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>" /&gt;</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_AvailClassIcon</d1p1:Content>
                <d1p1:LineIndex>2329</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2332</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Format currency value</d1p1:Content>
      <d1p1:LineIndex>2333</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2334</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: save space - only display price with pennies digits when fractional pounds</d1p1:Content>
      <d1p1:LineIndex>2335</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> [amPrice]: money price to render</d1p1:Content>
      <d1p1:LineIndex>2336</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> &lt;retval&gt;: string price</d1p1:Content>
      <d1p1:LineIndex>2337</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_NicePrice</d1p1:Content>
        <d1p1:LineIndex>2338</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>amPrice</d1p1:Content>
            <d1p1:LineIndex>2338</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Get price:</d1p1:Content>
          <d1p1:LineIndex>2339</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - MakePrice will also handle any currency conversion)</d1p1:Content>
          <d1p1:LineIndex>2340</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> - MakePrice will apply an appropriate currency symbol</d1p1:Content>
          <d1p1:LineIndex>2341</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strPrice</d1p1:Content>
                <d1p1:LineIndex>2342</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Money</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>MakePrice</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>amPrice</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPrice</d1p1:Content>
                <d1p1:LineIndex>2343</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If there's a trailing ".00" then trim it off</d1p1:Content>
          <d1p1:LineIndex>2345</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> NB: Pretty sure we'll never get a price of the form "?.00" - it should always</d1p1:Content>
          <d1p1:LineIndex>2346</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content>     be "?0.00", but just in case check that we've got a suitable long string</d1p1:Content>
          <d1p1:LineIndex>2347</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Len</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPrice</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>4</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2348</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:IfBlock">
                  <d1p1:ConditionalClauses>
                    <d1p1:IfBlock.IfBlockConditionSegment>
                      <d1p1:Condition>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>Right</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strPrice</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                            <d1p1:Content>,</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>3</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                            <d1p1:Content>=</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>.00</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2349</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Condition>
                      <d1p1:Statements>
                        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                          <d1p1:Expression>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                <d1p1:Content>Left</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strPrice</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                                <d1p1:Content>,</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                                <d1p1:Content>Len</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OpenBrace">
                                <d1p1:Content>(</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strPrice</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:OperatorToken">
                                <d1p1:Content>-</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NumericValueToken">
                                <d1p1:Content>3</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:CloseBrace">
                                <d1p1:Content>)</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Expression>
                          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                          <d1p1:ValueToSet>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>strPrice</d1p1:Content>
                                <d1p1:LineIndex>2350</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:ValueToSet>
                        </d2p1:anyType>
                      </d1p1:Statements>
                    </d1p1:IfBlock.IfBlockConditionSegment>
                  </d1p1:ConditionalClauses>
                  <d1p1:OptionalElseClause i:nil="true" />
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> Return string ready for display</d1p1:Content>
          <d1p1:LineIndex>2354</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Server</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>HTMLEncode</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>strPrice</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_NicePrice</d1p1:Content>
                <d1p1:LineIndex>2355</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2358</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: Pull description of linked unit (includes name of linked unit, name of source unit and</d1p1:Content>
      <d1p1:LineIndex>2359</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> size of linked unit)</d1p1:Content>
      <d1p1:LineIndex>2360</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2361</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> SUMMARY: get description of linked unit - this is the PHYSICAL unit description</d1p1:Content>
      <d1p1:LineIndex>2362</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_LinkedUnitDesc</d1p1:Content>
        <d1p1:LineIndex>2363</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objUnit</d1p1:Content>
            <d1p1:LineIndex>2363</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAllUnits</d1p1:Content>
            <d1p1:LineIndex>2363</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> If either UnitName of LinkedUnitName absent, return blank</d1p1:Content>
          <d1p1:LineIndex>2365</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sUnitName</d1p1:Content>
                <d1p1:LineIndex>2366</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2366</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2366</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>UnitName</d1p1:Content>
                <d1p1:LineIndex>2366</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sUnitName</d1p1:Content>
                <d1p1:LineIndex>2366</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>sLinkedUnitName</d1p1:Content>
                <d1p1:LineIndex>2367</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2367</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2367</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>LinkUnitName</d1p1:Content>
                <d1p1:LineIndex>2367</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sLinkedUnitName</d1p1:Content>
                <d1p1:LineIndex>2367</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sUnitName</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sUnitName</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>IsNull</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sLinkedUnitName</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>Or</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>sLinkedUnitName</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>=</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2368</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content></d1p1:Content>
                        <d1p1:LineIndex>2369</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_LinkedUnitDesc</d1p1:Content>
                        <d1p1:LineIndex>2369</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>2370</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2014-08-26 DWR: We need to retrieve the capacity of the unit that this linked unit is linked to. This data is not available in the avail</d1p1:Content>
          <d1p1:LineIndex>2373</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> data from TOv2 since it is not included in the data from the Availability Component. It is why the "all units" data must be passed into</d1p1:Content>
          <d1p1:LineIndex>2374</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> this method. This change addresses FogBugz 12998.</d1p1:Content>
          <d1p1:LineIndex>2375</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objParentUnit</d1p1:Content>
                <d1p1:LineIndex>2376</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>Nothing</d1p1:Content>
                <d1p1:LineIndex>2376</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objParentUnit</d1p1:Content>
                <d1p1:LineIndex>2376</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndex</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep i:nil="true" />
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objAllUnits</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Count</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2377</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>intIndex</d1p1:Content>
            <d1p1:LineIndex>2377</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objAllUnits</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>getItem</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>intIndex</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Key</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objUnit</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>LinkUnitKey</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2378</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objAllUnits</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>getItem</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intIndex</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objParentUnit</d1p1:Content>
                            <d1p1:LineIndex>2379</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ExitStatement">
                      <d1p1:LineIndex>2380</d1p1:LineIndex>
                      <d1p1:StatementType>For</d1p1:StatementType>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2383</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objParentUnit</d1p1:Content>
                    <d1p1:LineIndex>2383</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>is</d1p1:Content>
                    <d1p1:LineIndex>2383</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Nothing</d1p1:Content>
                    <d1p1:LineIndex>2383</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2383</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTraceWarning</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Unable to locate parent unit (</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>LinkUnitKey</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>) for linked unit </d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>objUnit</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>UnitKey</d1p1:Content>
                      <d1p1:LineIndex>2384</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content></d1p1:Content>
                        <d1p1:LineIndex>2385</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>BookingUI_LinkedUnitDesc</d1p1:Content>
                        <d1p1:LineIndex>2385</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ExitStatement">
                  <d1p1:LineIndex>2386</d1p1:LineIndex>
                  <d1p1:StatementType>Function</d1p1:StatementType>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Replace</d1p1:Content>
                <d1p1:LineIndex>2390</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2390</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Replace</d1p1:Content>
                <d1p1:LineIndex>2391</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2391</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Replace</d1p1:Content>
                <d1p1:LineIndex>2392</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2392</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2393</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2393</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Resource</d1p1:Content>
                <d1p1:LineIndex>2393</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2393</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>bookonline/unitselection/alsosoldaswithpersoncapacity</d1p1:Content>
                <d1p1:LineIndex>2394</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2394</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>(&lt;i&gt;#linkedunitname#&lt;/i&gt; sold as #unitname# with #linkunitsize# person capacity)</d1p1:Content>
                <d1p1:LineIndex>2395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2395</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>#linkedunitname#</d1p1:Content>
                <d1p1:LineIndex>2396</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2396</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sLinkedUnitName</d1p1:Content>
                <d1p1:LineIndex>2397</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2397</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2397</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>#unitname#</d1p1:Content>
                <d1p1:LineIndex>2398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2398</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>sUnitName</d1p1:Content>
                <d1p1:LineIndex>2399</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2399</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2399</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>#linkunitsize#</d1p1:Content>
                <d1p1:LineIndex>2400</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2400</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objParentUnit</d1p1:Content>
                <d1p1:LineIndex>2401</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2401</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Capacity</d1p1:Content>
                <d1p1:LineIndex>2401</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2401</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>BookingUI_LinkedUnitDesc</d1p1:Content>
                <d1p1:LineIndex>2389</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2405</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: This handles all of the rendering for ticketing - none of the StaySummary, StayDetails,</d1p1:Content>
      <d1p1:LineIndex>2406</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RenderButtons malarkey is required</d1p1:Content>
      <d1p1:LineIndex>2407</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2408</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>BookingUI_TicketsSummary</d1p1:Content>
        <d1p1:LineIndex>2409</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objAvailEntry</d1p1:Content>
            <d1p1:LineIndex>2409</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>adtStartNight</d1p1:Content>
            <d1p1:LineIndex>2409</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>pO</d1p1:Content>
            <d1p1:LineIndex>2409</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iTotal</d1p1:Content>
                <d1p1:LineIndex>2410</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iSubTotal</d1p1:Content>
                <d1p1:LineIndex>2410</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>iSelectedQty</d1p1:Content>
                <d1p1:LineIndex>2410</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>intIndexUnit</d1p1:Content>
                <d1p1:LineIndex>2410</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objUnit</d1p1:Content>
                <d1p1:LineIndex>2410</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strPriceBasis</d1p1:Content>
                <d1p1:LineIndex>2410</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objAvailEntry</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Units</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Count</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>0</d1p1:Content>
                    <d1p1:LineIndex>2412</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2413</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2413</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2413</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;div id="availabilityCalendarTableWrapper"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2413</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;h3&gt;</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/ticketsavailable</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Tickets Available:</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/h3&gt;</d1p1:Content>
                      <d1p1:LineIndex>2414</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;table id="availabilityCalendarTable" summary="</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/ticketsavailable</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Tickets Available</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" border="1"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2415</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2416</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2416</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2416</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;thead&gt;</d1p1:Content>
                      <d1p1:LineIndex>2416</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2417</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2417</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2417</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;tr class="heading"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2417</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="unit"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/tickets</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Tickets</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2418</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="select"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/selection</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Selection</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2419</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="date"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/date</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Date</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2420</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="total"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/total</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Total</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2421</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2422</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2422</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2422</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
                      <d1p1:LineIndex>2422</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2423</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2423</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2423</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;tr&gt;</d1p1:Content>
                      <d1p1:LineIndex>2423</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2424</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2424</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2424</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th&gt;&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2424</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="number"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/nooftickets</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>No.Tickets</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2425</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="staydate"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Functions</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Dates</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>NiceDateGuts</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>adtStartNight</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>True</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>True</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2426</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2427</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2427</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2427</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th class="total"&gt;&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2427</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2428</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2428</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2428</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
                      <d1p1:LineIndex>2428</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2429</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2429</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2429</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/thead&gt;</d1p1:Content>
                      <d1p1:LineIndex>2429</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2430</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2430</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2430</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;tbody&gt;</d1p1:Content>
                      <d1p1:LineIndex>2430</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>2431</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iTotal</d1p1:Content>
                        <d1p1:LineIndex>2431</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:ForBlock">
                  <d1p1:LoopFrom>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>0</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopFrom>
                  <d1p1:LoopStep i:nil="true" />
                  <d1p1:LoopTo>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>objAvailEntry</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Units</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                        <d1p1:Content>.</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>Count</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>-</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NumericValueToken">
                        <d1p1:Content>1</d1p1:Content>
                        <d1p1:LineIndex>2433</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:LoopTo>
                  <d1p1:LoopVar>
                    <d1p1:Content>intIndexUnit</d1p1:Content>
                    <d1p1:LineIndex>2433</d1p1:LineIndex>
                  </d1p1:LoopVar>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objAvailEntry</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Units</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>GetItem</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>intIndexUnit</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Set</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objUnit</d1p1:Content>
                            <d1p1:LineIndex>2434</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                            <d1p1:Content>CLng</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Request</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>Form</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:StringToken">
                            <d1p1:Content>unit_</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>&amp;</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objUnit</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>UnitKey</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iSelectedQty</d1p1:Content>
                            <d1p1:LineIndex>2436</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:IfBlock">
                      <d1p1:ConditionalClauses>
                        <d1p1:IfBlock.IfBlockConditionSegment>
                          <d1p1:Condition>
                            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                            <d1p1:Tokens>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>objUnit</d1p1:Content>
                                <d1p1:LineIndex>2438</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                                <d1p1:Content>.</d1p1:Content>
                                <d1p1:LineIndex>2438</d1p1:LineIndex>
                              </d2p1:anyType>
                              <d2p1:anyType i:type="d1p1:NameToken">
                                <d1p1:Content>PerPerson</d1p1:Content>
                                <d1p1:LineIndex>2438</d1p1:LineIndex>
                              </d2p1:anyType>
                            </d1p1:Tokens>
                          </d1p1:Condition>
                          <d1p1:Statements>
                            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                              <d1p1:Expression>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:StringToken">
                                    <d1p1:Content>per per</d1p1:Content>
                                    <d1p1:LineIndex>2439</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:Expression>
                              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                              <d1p1:ValueToSet>
                                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                                <d1p1:Tokens>
                                  <d2p1:anyType i:type="d1p1:NameToken">
                                    <d1p1:Content>strPriceBasis</d1p1:Content>
                                    <d1p1:LineIndex>2439</d1p1:LineIndex>
                                  </d2p1:anyType>
                                </d1p1:Tokens>
                              </d1p1:ValueToSet>
                            </d2p1:anyType>
                          </d1p1:Statements>
                        </d1p1:IfBlock.IfBlockConditionSegment>
                      </d1p1:ConditionalClauses>
                      <d1p1:OptionalElseClause>
                        <d1p1:Statements>
                          <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                            <d1p1:Expression>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:StringToken">
                                  <d1p1:Content>per tic</d1p1:Content>
                                  <d1p1:LineIndex>2441</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:Expression>
                            <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                            <d1p1:ValueToSet>
                              <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                              <d1p1:Tokens>
                                <d2p1:anyType i:type="d1p1:NameToken">
                                  <d1p1:Content>strPriceBasis</d1p1:Content>
                                  <d1p1:LineIndex>2441</d1p1:LineIndex>
                                </d2p1:anyType>
                              </d1p1:Tokens>
                            </d1p1:ValueToSet>
                          </d2p1:anyType>
                        </d1p1:Statements>
                      </d1p1:OptionalElseClause>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;tr id="row_</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitKey</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>"&gt;</d1p1:Content>
                          <d1p1:LineIndex>2444</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;td class="unit"&gt;</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitName</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/td&gt;</d1p1:Content>
                          <d1p1:LineIndex>2445</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;td class="select"&gt;</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Page</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Functions</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Booking</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>DrawSelectRange</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>unit_</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitKey</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NumericValueToken">
                          <d1p1:Content>0</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitCount</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iSelectedQty</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/td&gt;</d1p1:Content>
                          <d1p1:LineIndex>2446</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;td class="price"&gt;</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Server</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>HTMLEncode</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Page</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Functions</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Money</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>MakePrice</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>StayTotalPayable</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/td&gt;</d1p1:Content>
                          <d1p1:LineIndex>2447</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2448</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2448</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2448</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;td class="total"&gt;</d1p1:Content>
                          <d1p1:LineIndex>2449</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2449</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;input type="hidden" name="data_</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitKey</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>" id="data_</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitKey</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>" value="</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitCount</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>MinOcc</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>UnitSize</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>strPriceBasis</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>,</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>StayTotalPayable</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>"&gt;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2450</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Server</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>HTMLEncode</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Page</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Functions</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Money</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>MakePrice</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OpenBrace">
                          <d1p1:Content>(</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>objUnit</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>StayTotalPayable</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>*</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>iSelectedQty</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:CloseBrace">
                          <d1p1:Content>)</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:OperatorToken">
                          <d1p1:Content>&amp;</d1p1:Content>
                          <d1p1:LineIndex>2451</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/td&gt;</d1p1:Content>
                          <d1p1:LineIndex>2452</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:Statement">
                      <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                      <d1p1:Tokens>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>pO</d1p1:Content>
                          <d1p1:LineIndex>2453</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                          <d1p1:Content>.</d1p1:Content>
                          <d1p1:LineIndex>2453</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:NameToken">
                          <d1p1:Content>Write</d1p1:Content>
                          <d1p1:LineIndex>2453</d1p1:LineIndex>
                        </d2p1:anyType>
                        <d2p1:anyType i:type="d1p1:StringToken">
                          <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
                          <d1p1:LineIndex>2453</d1p1:LineIndex>
                        </d2p1:anyType>
                      </d1p1:Tokens>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iTotal</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>+</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>objUnit</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                            <d1p1:Content>.</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>StayTotalPayable</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>*</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iSelectedQty</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>iTotal</d1p1:Content>
                            <d1p1:LineIndex>2454</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:BlankLine" />
                  </d1p1:Statements>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iSubTotal</d1p1:Content>
                        <d1p1:LineIndex>2457</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OperatorToken">
                        <d1p1:Content>+</d1p1:Content>
                        <d1p1:LineIndex>2457</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iTotal</d1p1:Content>
                        <d1p1:LineIndex>2457</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>iSubTotal</d1p1:Content>
                        <d1p1:LineIndex>2457</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:BlankLine" />
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2459</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2459</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2459</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/tbody&gt;</d1p1:Content>
                      <d1p1:LineIndex>2459</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2460</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2460</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2460</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/table&gt;</d1p1:Content>
                      <d1p1:LineIndex>2460</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2461</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2461</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2461</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/div&gt;</d1p1:Content>
                      <d1p1:LineIndex>2461</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2462</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2462</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2462</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;table id="availabilityTotals" summary="Totals" border="1"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2462</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2463</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2463</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2463</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;tr&gt;</d1p1:Content>
                      <d1p1:LineIndex>2463</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/grandtotal</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Grand Total</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/th&gt;</d1p1:Content>
                      <d1p1:LineIndex>2464</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2465</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2465</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2465</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;noscript&gt;</d1p1:Content>
                      <d1p1:LineIndex>2465</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;td&gt;&lt;input type="image" src="</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ImageResource</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/unitselection/recalculate</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Context</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ImageDir</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>booking/bookrecalculate.gif</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" name="recalculate" value="recalculate" class="submit"/&gt;&lt;/td&gt;</d1p1:Content>
                      <d1p1:LineIndex>2466</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2467</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2467</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2467</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/noscript&gt;</d1p1:Content>
                      <d1p1:LineIndex>2467</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;td id="AvCalTotal"&gt;</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Server</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>HTMLEncode</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Functions</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Money</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>MakePrice</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>iSubTotal</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/td&gt;</d1p1:Content>
                      <d1p1:LineIndex>2468</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2469</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2469</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2469</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/tr&gt;</d1p1:Content>
                      <d1p1:LineIndex>2469</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2470</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2470</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2470</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;/table&gt;</d1p1:Content>
                      <d1p1:LineIndex>2470</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>pO</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Write</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>&lt;input type="image" src="</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ImageResource</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/btn/bookticketing</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Context</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>ImageDir</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>booking/bookticketing.gif</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" name="bookit" value="</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/btn/book</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Book</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" alt="</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Resource</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OpenBrace">
                      <d1p1:Content>(</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>bookonline/btn/book</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                      <d1p1:Content>,</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>Book</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:CloseBrace">
                      <d1p1:Content>)</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>" class="submit"/&gt;</d1p1:Content>
                      <d1p1:LineIndex>2471</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause i:nil="true" />
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2476</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> RENDER: If Site Param Booking_ForceExternal is set, then all  bookings are forced to external sites</d1p1:Content>
      <d1p1:LineIndex>2477</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> (the site depends upon the product's Estate) - this function gets the external destination</d1p1:Content>
      <d1p1:LineIndex>2478</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> 2009-02-19 DWR: This handles Local availability products, FrontDesk products will be treated like</d1p1:Content>
      <d1p1:LineIndex>2479</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> this as well if VB Polling is disabled, if it is ENabled then the FrontDesk products will act like</d1p1:Content>
      <d1p1:LineIndex>2480</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> any other external supplier and should deep-link into their site.</d1p1:Content>
      <d1p1:LineIndex>2481</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2482</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>GetExtBookUrlFromProductEstate</d1p1:Content>
        <d1p1:LineIndex>2483</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>true</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>asEstateID</d1p1:Content>
            <d1p1:LineIndex>2483</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strPostUrl_Ext</d1p1:Content>
                <d1p1:LineIndex>2484</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>strPostUrl_ExtDflt</d1p1:Content>
                <d1p1:LineIndex>2484</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>aryExtBookEstate</d1p1:Content>
                <d1p1:LineIndex>2484</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>i</d1p1:Content>
                <d1p1:LineIndex>2484</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> 2009-02-13 DWR: Can't remove spaces from content here because estate ids can have</d1p1:Content>
          <d1p1:LineIndex>2485</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:CommentStatement">
          <d1p1:Content> spaces in (eg. "Arun DC" in TSE)</d1p1:Content>
          <d1p1:LineIndex>2486</d1p1:LineIndex>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Split</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Replace</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>Trim</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content></d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>&amp;</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Site</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Params</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>Booking_ExtBookEstateMapping</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                <d1p1:Content>vbCrLf</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
                <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content></d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>,</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Let</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aryExtBookEstate</d1p1:Content>
                <d1p1:LineIndex>2487</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ForBlock">
          <d1p1:LoopFrom>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>0</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopFrom>
          <d1p1:LoopStep>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>2</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopStep>
          <d1p1:LoopTo>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                <d1p1:Content>UBound</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>aryExtBookEstate</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OperatorToken">
                <d1p1:Content>-</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NumericValueToken">
                <d1p1:Content>1</d1p1:Content>
                <d1p1:LineIndex>2488</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:LoopTo>
          <d1p1:LoopVar>
            <d1p1:Content>i</d1p1:Content>
            <d1p1:LineIndex>2488</d1p1:LineIndex>
          </d1p1:LoopVar>
          <d1p1:Statements>
            <d2p1:anyType i:type="d1p1:IfBlock">
              <d1p1:ConditionalClauses>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>UCase</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Trim</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aryExtBookEstate</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>i</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:StringToken">
                        <d1p1:Content>DEFAULT</d1p1:Content>
                        <d1p1:LineIndex>2489</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>aryExtBookEstate</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>i</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>+</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>1</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strPostUrl_ExtDflt</d1p1:Content>
                            <d1p1:LineIndex>2490</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
                <d1p1:IfBlock.IfBlockConditionSegment>
                  <d1p1:Condition>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>UCase</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Trim</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>aryExtBookEstate</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>i</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                        <d1p1:Content>=</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>UCase</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                        <d1p1:Content>Trim</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:OpenBrace">
                        <d1p1:Content>(</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>asEstateID</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                      <d2p1:anyType i:type="d1p1:CloseBrace">
                        <d1p1:Content>)</d1p1:Content>
                        <d1p1:LineIndex>2491</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Condition>
                  <d1p1:Statements>
                    <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                      <d1p1:Expression>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>aryExtBookEstate</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OpenBrace">
                            <d1p1:Content>(</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>i</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:OperatorToken">
                            <d1p1:Content>+</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:NumericValueToken">
                            <d1p1:Content>1</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                          <d2p1:anyType i:type="d1p1:CloseBrace">
                            <d1p1:Content>)</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:Expression>
                      <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                      <d1p1:ValueToSet>
                        <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                        <d1p1:Tokens>
                          <d2p1:anyType i:type="d1p1:NameToken">
                            <d1p1:Content>strPostUrl_Ext</d1p1:Content>
                            <d1p1:LineIndex>2492</d1p1:LineIndex>
                          </d2p1:anyType>
                        </d1p1:Tokens>
                      </d1p1:ValueToSet>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:ExitStatement">
                      <d1p1:LineIndex>2493</d1p1:LineIndex>
                      <d1p1:StatementType>For</d1p1:StatementType>
                    </d2p1:anyType>
                  </d1p1:Statements>
                </d1p1:IfBlock.IfBlockConditionSegment>
              </d1p1:ConditionalClauses>
              <d1p1:OptionalElseClause i:nil="true" />
            </d2p1:anyType>
          </d1p1:Statements>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl_Ext</d1p1:Content>
                    <d1p1:LineIndex>2497</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>2497</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2497</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>2497</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl_Ext</d1p1:Content>
                        <d1p1:LineIndex>2498</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetExtBookUrlFromProductEstate</d1p1:Content>
                        <d1p1:LineIndex>2498</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTrace</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>GetExtBookUrlFromProductEstate: Product Estate ID = </d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>asEstateID</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>, External Book Url = </d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strPostUrl_Ext</d1p1:Content>
                      <d1p1:LineIndex>2499</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>strPostUrl_ExtDflt</d1p1:Content>
                    <d1p1:LineIndex>2500</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>2500</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2500</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>2500</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>strPostUrl_ExtDflt</d1p1:Content>
                        <d1p1:LineIndex>2501</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>GetExtBookUrlFromProductEstate</d1p1:Content>
                        <d1p1:LineIndex>2501</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
                <d2p1:anyType i:type="d1p1:Statement">
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>Page</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                      <d1p1:Content>.</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>PrintTrace</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>GetExtBookUrlFromProductEstate: Product Estate ID = </d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>asEstateID</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:StringToken">
                      <d1p1:Content>, Using Default External Book Url = </d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:OperatorToken">
                      <d1p1:Content>&amp;</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>strPostUrl_ExtDflt</d1p1:Content>
                      <d1p1:LineIndex>2502</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:Statement">
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>Err</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Raise</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                    <d1p1:Content>vbObjectError</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                    <d1p1:IsAcceptableAsConstValue>false</d1p1:IsAcceptableAsConstValue>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>+</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NumericValueToken">
                    <d1p1:Content>1</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>ETWP.Booking_UnitSelection Control</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ArgumentSeparatorToken">
                    <d1p1:Content>,</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Failed to get External Booking Url [</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>asEstateID</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>]</d1p1:Content>
                    <d1p1:LineIndex>2504</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:BlankLine" />
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>InitExternalBookingSettings</d1p1:Content>
        <d1p1:LineIndex>2510</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters />
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:IfBlock">
          <d1p1:ConditionalClauses>
            <d1p1:IfBlock.IfBlockConditionSegment>
              <d1p1:Condition>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_ForceExternal</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:LogicalOperatorToken">
                    <d1p1:Content>And</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:BuiltInFunctionToken">
                    <d1p1:Content>Trim</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OperatorToken">
                    <d1p1:Content>&amp;</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Page</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Site</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Params</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:OpenBrace">
                    <d1p1:Content>(</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content>Booking_ExtBookEstateMapping</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:CloseBrace">
                    <d1p1:Content>)</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&lt;</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:ComparisonOperatorToken">
                    <d1p1:Content>&gt;</d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:StringToken">
                    <d1p1:Content></d1p1:Content>
                    <d1p1:LineIndex>2511</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Condition>
              <d1p1:Statements>
                <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                  <d1p1:Expression>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                        <d1p1:Content>True</d1p1:Content>
                        <d1p1:LineIndex>2512</d1p1:LineIndex>
                        <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:Expression>
                  <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                  <d1p1:ValueToSet>
                    <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                    <d1p1:Tokens>
                      <d2p1:anyType i:type="d1p1:NameToken">
                        <d1p1:Content>IsExternalBooking</d1p1:Content>
                        <d1p1:LineIndex>2512</d1p1:LineIndex>
                      </d2p1:anyType>
                    </d1p1:Tokens>
                  </d1p1:ValueToSet>
                </d2p1:anyType>
              </d1p1:Statements>
            </d1p1:IfBlock.IfBlockConditionSegment>
          </d1p1:ConditionalClauses>
          <d1p1:OptionalElseClause>
            <d1p1:Statements>
              <d2p1:anyType i:type="d1p1:ValueSettingStatement">
                <d1p1:Expression>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:BuiltInValueToken">
                      <d1p1:Content>False</d1p1:Content>
                      <d1p1:LineIndex>2514</d1p1:LineIndex>
                      <d1p1:IsAcceptableAsConstValue>true</d1p1:IsAcceptableAsConstValue>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:Expression>
                <d1p1:ValueSetType>Let</d1p1:ValueSetType>
                <d1p1:ValueToSet>
                  <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                  <d1p1:Tokens>
                    <d2p1:anyType i:type="d1p1:NameToken">
                      <d1p1:Content>IsExternalBooking</d1p1:Content>
                      <d1p1:LineIndex>2514</d1p1:LineIndex>
                    </d2p1:anyType>
                  </d1p1:Tokens>
                </d1p1:ValueToSet>
              </d2p1:anyType>
            </d1p1:Statements>
          </d1p1:OptionalElseClause>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:BlankLine" />
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2518</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> MISC: Since the RenderSettings.BookingRequirement references passed into here are usually read-only</d1p1:Content>
      <d1p1:LineIndex>2519</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> instances from the Page.Functions.GetSharedObject method, we'll need to make a local copy that we</d1p1:Content>
      <d1p1:LineIndex>2520</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> can manipulate (since in some cases we need to mess about with the values)</d1p1:Content>
      <d1p1:LineIndex>2521</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:CommentStatement">
      <d1p1:Content> ====================================================================================================</d1p1:Content>
      <d1p1:LineIndex>2522</d1p1:LineIndex>
    </d2p1:anyType>
    <d2p1:anyType i:type="d1p1:FunctionBlock">
      <d1p1:HasReturnValue>true</d1p1:HasReturnValue>
      <d1p1:IsDefault>false</d1p1:IsDefault>
      <d1p1:IsPublic>false</d1p1:IsPublic>
      <d1p1:Name>
        <d1p1:Content>GetEditableBookingRequirement</d1p1:Content>
        <d1p1:LineIndex>2523</d1p1:LineIndex>
      </d1p1:Name>
      <d1p1:Parameters>
        <d1p1:AbstractFunctionBlock.Parameter>
          <d1p1:ByRef>false</d1p1:ByRef>
          <d1p1:IsArray>false</d1p1:IsArray>
          <d1p1:Name>
            <d1p1:Content>objBookingRequirement</d1p1:Content>
            <d1p1:LineIndex>2523</d1p1:LineIndex>
          </d1p1:Name>
        </d1p1:AbstractFunctionBlock.Parameter>
      </d1p1:Parameters>
      <d1p1:Statements>
        <d2p1:anyType i:type="d1p1:BlankLine" />
        <d2p1:anyType i:type="d1p1:DimStatement">
          <d1p1:Variables>
            <d1p1:DimVariable i:type="d1p1:ConstantNonNegativeArrayDimensionDimVariable">
              <d1p1:Dimensions i:nil="true" />
              <d1p1:Name>
                <d1p1:Content>objBookingRequirementNew</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d1p1:Name>
            </d1p1:DimVariable>
          </d1p1:Variables>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Page</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>Functions</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                <d1p1:Content>.</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetNewObject</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:OpenBrace">
                <d1p1:Content>(</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:StringToken">
                <d1p1:Content>BookingRequirement</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
              <d2p1:anyType i:type="d1p1:CloseBrace">
                <d1p1:Content>)</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirementNew</d1p1:Content>
                <d1p1:LineIndex>2525</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:WithBlock">
          <d1p1:Content>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2527</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2527</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>VisitDate</d1p1:Content>
                    <d1p1:LineIndex>2527</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2527</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>VisitDate</d1p1:Content>
                    <d1p1:LineIndex>2527</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2528</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2528</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Nights</d1p1:Content>
                    <d1p1:LineIndex>2528</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2528</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Nights</d1p1:Content>
                    <d1p1:LineIndex>2528</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2529</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2529</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>FlexibleRange</d1p1:Content>
                    <d1p1:LineIndex>2529</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2529</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>FlexibleRange</d1p1:Content>
                    <d1p1:LineIndex>2529</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2530</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2530</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Adults</d1p1:Content>
                    <d1p1:LineIndex>2530</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2530</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Adults</d1p1:Content>
                    <d1p1:LineIndex>2530</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2531</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2531</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Children</d1p1:Content>
                    <d1p1:LineIndex>2531</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2531</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Children</d1p1:Content>
                    <d1p1:LineIndex>2531</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2532</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2532</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>ChildAges</d1p1:Content>
                    <d1p1:LineIndex>2532</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2532</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>ChildAges</d1p1:Content>
                    <d1p1:LineIndex>2532</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsEviivoBooking</d1p1:Content>
                    <d1p1:LineIndex>2533</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2533</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>IsEviivoBooking</d1p1:Content>
                    <d1p1:LineIndex>2533</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2534</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2534</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Consumer</d1p1:Content>
                    <d1p1:LineIndex>2534</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2534</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Consumer</d1p1:Content>
                    <d1p1:LineIndex>2534</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2535</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2535</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Offer</d1p1:Content>
                    <d1p1:LineIndex>2535</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2535</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Offer</d1p1:Content>
                    <d1p1:LineIndex>2535</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2536</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2536</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingPassword</d1p1:Content>
                    <d1p1:LineIndex>2536</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2536</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>BookingPassword</d1p1:Content>
                    <d1p1:LineIndex>2536</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Product</d1p1:Content>
                    <d1p1:LineIndex>2537</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2537</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Product</d1p1:Content>
                    <d1p1:LineIndex>2537</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2538</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2538</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Requirement</d1p1:Content>
                    <d1p1:LineIndex>2538</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2538</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>Requirement</d1p1:Content>
                    <d1p1:LineIndex>2538</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2539</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2539</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>RequirementRef</d1p1:Content>
                    <d1p1:LineIndex>2539</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2539</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>RequirementRef</d1p1:Content>
                    <d1p1:LineIndex>2539</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> NP 2012-03-12: RoomRequirements are needed</d1p1:Content>
              <d1p1:LineIndex>2540</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> See GenerateRequirementFormData and Page.Functions.Booking.GenerateRequirementKeyValueData</d1p1:Content>
              <d1p1:LineIndex>2541</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> the "NumRoomReq" value is part of the RoomRequirement, if it is not available then GenerateRequirementKeyValueData</d1p1:Content>
              <d1p1:LineIndex>2542</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> sets default values for the adult and number of room requirements both to 1.</d1p1:Content>
              <d1p1:LineIndex>2543</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> Requirements are not being passed to the RequirementSummary control correctly because the BookingRequestDictionary</d1p1:Content>
              <d1p1:LineIndex>2544</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:CommentStatement">
              <d1p1:Content> is being overwritten with these incorrect default values.</d1p1:Content>
              <d1p1:LineIndex>2545</d1p1:LineIndex>
            </d2p1:anyType>
            <d2p1:anyType i:type="d1p1:ValueSettingStatement">
              <d1p1:Expression>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>objBookingRequirement</d1p1:Content>
                    <d1p1:LineIndex>2546</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2546</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>RoomRequirements</d1p1:Content>
                    <d1p1:LineIndex>2546</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:Expression>
              <d1p1:ValueSetType>Let</d1p1:ValueSetType>
              <d1p1:ValueToSet>
                <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
                <d1p1:Tokens>
                  <d2p1:anyType i:type="d1p1:MemberAccessorOrDecimalPointToken">
                    <d1p1:Content>.</d1p1:Content>
                    <d1p1:LineIndex>2546</d1p1:LineIndex>
                  </d2p1:anyType>
                  <d2p1:anyType i:type="d1p1:NameToken">
                    <d1p1:Content>RoomRequirements</d1p1:Content>
                    <d1p1:LineIndex>2546</d1p1:LineIndex>
                  </d2p1:anyType>
                </d1p1:Tokens>
              </d1p1:ValueToSet>
            </d2p1:anyType>
          </d1p1:Content>
          <d1p1:Target>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirementNew</d1p1:Content>
                <d1p1:LineIndex>2526</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Target>
        </d2p1:anyType>
        <d2p1:anyType i:type="d1p1:ValueSettingStatement">
          <d1p1:Expression>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>objBookingRequirementNew</d1p1:Content>
                <d1p1:LineIndex>2548</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:Expression>
          <d1p1:ValueSetType>Set</d1p1:ValueSetType>
          <d1p1:ValueToSet>
            <d1p1:CallPrefix>Absent</d1p1:CallPrefix>
            <d1p1:Tokens>
              <d2p1:anyType i:type="d1p1:NameToken">
                <d1p1:Content>GetEditableBookingRequirement</d1p1:Content>
                <d1p1:LineIndex>2548</d1p1:LineIndex>
              </d2p1:anyType>
            </d1p1:Tokens>
          </d1p1:ValueToSet>
        </d2p1:anyType>
      </d1p1:Statements>
    </d2p1:anyType>
  </d1p1:AllExecutableBlocks>
  <d1p1:Name i:type="d1p1:DoNotRenameNameToken">
    <d1p1:Content>Root</d1p1:Content>
    <d1p1:LineIndex>0</d1p1:LineIndex>
  </d1p1:Name>
</z:anyType>